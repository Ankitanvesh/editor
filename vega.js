(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{112:function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"version",function(){return Mc}),r.d(t,"Dataflow",function(){return Kt}),r.d(t,"EventStream",function(){return st}),r.d(t,"Parameters",function(){return Ze}),r.d(t,"Pulse",function(){return Rt}),r.d(t,"MultiPulse",function(){return Nt}),r.d(t,"Operator",function(){return nt}),r.d(t,"Transform",function(){return er}),r.d(t,"changeset",function(){return Ke}),r.d(t,"ingest",function(){return Ge}),r.d(t,"isTuple",function(){return Ne}),r.d(t,"definition",function(){return nr}),r.d(t,"transform",function(){return ir}),r.d(t,"transforms",function(){return rr}),r.d(t,"tupleid",function(){return Ue}),r.d(t,"scale",function(){return lf}),r.d(t,"scheme",function(){return xf}),r.d(t,"interpolate",function(){return bf}),r.d(t,"interpolateColors",function(){return hf}),r.d(t,"interpolateRange",function(){return mf}),r.d(t,"timeInterval",function(){return of}),r.d(t,"quantizeInterpolator",function(){return gf}),r.d(t,"projection",function(){return hl}),r.d(t,"View",function(){return bh}),r.d(t,"expressionFunction",function(){return Um}),r.d(t,"parse",function(){return yv}),r.d(t,"runtime",function(){return rh}),r.d(t,"runtimeContext",function(){return ih}),r.d(t,"bin",function(){return pr}),r.d(t,"bootstrapCI",function(){return br}),r.d(t,"quartiles",function(){return vr}),r.d(t,"random",function(){return gr}),r.d(t,"setRandom",function(){return yr}),r.d(t,"randomInteger",function(){return Or}),r.d(t,"randomKDE",function(){return xr}),r.d(t,"randomMixture",function(){return kr}),r.d(t,"randomNormal",function(){return $r}),r.d(t,"randomUniform",function(){return _r}),r.d(t,"accessor",function(){return O}),r.d(t,"accessorName",function(){return $}),r.d(t,"accessorFields",function(){return x}),r.d(t,"id",function(){return S}),r.d(t,"identity",function(){return j}),r.d(t,"zero",function(){return M}),r.d(t,"one",function(){return q}),r.d(t,"truthy",function(){return B}),r.d(t,"falsy",function(){return P}),r.d(t,"logger",function(){return N}),r.d(t,"None",function(){return R}),r.d(t,"Error",function(){return T}),r.d(t,"Warn",function(){return I}),r.d(t,"Info",function(){return V}),r.d(t,"Debug",function(){return L}),r.d(t,"panLinear",function(){return Q}),r.d(t,"panLog",function(){return Z}),r.d(t,"panPow",function(){return ee}),r.d(t,"panSymlog",function(){return te}),r.d(t,"zoomLinear",function(){return ne}),r.d(t,"zoomLog",function(){return ie}),r.d(t,"zoomPow",function(){return ae}),r.d(t,"zoomSymlog",function(){return oe}),r.d(t,"quarter",function(){return se}),r.d(t,"utcquarter",function(){return ue}),r.d(t,"array",function(){return fe}),r.d(t,"clampRange",function(){return le}),r.d(t,"compare",function(){return de}),r.d(t,"constant",function(){return pe}),r.d(t,"debounce",function(){return me}),r.d(t,"error",function(){return k}),r.d(t,"extend",function(){return he}),r.d(t,"extent",function(){return ge}),r.d(t,"extentIndex",function(){return ye}),r.d(t,"fastmap",function(){return ve}),r.d(t,"field",function(){return C}),r.d(t,"flush",function(){return Oe}),r.d(t,"inherits",function(){return $e}),r.d(t,"inrange",function(){return xe}),r.d(t,"isArray",function(){return A}),r.d(t,"isBoolean",function(){return ke}),r.d(t,"isDate",function(){return _e}),r.d(t,"isFunction",function(){return ce}),r.d(t,"isNumber",function(){return Ae}),r.d(t,"isObject",function(){return w}),r.d(t,"isRegExp",function(){return we}),r.d(t,"isString",function(){return F}),r.d(t,"key",function(){return Fe}),r.d(t,"merge",function(){return De}),r.d(t,"pad",function(){return Ee}),r.d(t,"peek",function(){return U}),r.d(t,"repeat",function(){return Ce}),r.d(t,"span",function(){return Se}),r.d(t,"splitAccessPath",function(){return _}),r.d(t,"stringValue",function(){return D}),r.d(t,"toBoolean",function(){return je}),r.d(t,"toDate",function(){return qe}),r.d(t,"toNumber",function(){return W}),r.d(t,"toString",function(){return Be}),r.d(t,"toSet",function(){return Pe}),r.d(t,"truncate",function(){return ze}),r.d(t,"visitArray",function(){return Re}),r.d(t,"loader",function(){return jt}),r.d(t,"read",function(){return St}),r.d(t,"inferType",function(){return $t}),r.d(t,"inferTypes",function(){return xt}),r.d(t,"typeParsers",function(){return bt}),r.d(t,"format",function(){return Dt}),r.d(t,"formats",function(){return Ct}),r.d(t,"responseType",function(){return Et}),r.d(t,"Bounds",function(){return ki}),r.d(t,"Gradient",function(){return wi}),r.d(t,"GroupItem",function(){return Di}),r.d(t,"ResourceLoader",function(){return Si}),r.d(t,"Item",function(){return Fi}),r.d(t,"Scenegraph",function(){return No}),r.d(t,"Handler",function(){return Qo}),r.d(t,"Renderer",function(){return ts}),r.d(t,"CanvasHandler",function(){return is}),r.d(t,"CanvasRenderer",function(){return fs}),r.d(t,"SVGHandler",function(){return ps}),r.d(t,"SVGRenderer",function(){return xs}),r.d(t,"SVGStringRenderer",function(){return qs}),r.d(t,"RenderType",function(){return Is}),r.d(t,"renderModule",function(){return Ls}),r.d(t,"intersect",function(){return Ns}),r.d(t,"Marks",function(){return Po}),r.d(t,"boundClip",function(){return Xs}),r.d(t,"boundContext",function(){return ka}),r.d(t,"boundStroke",function(){return Oa}),r.d(t,"boundItem",function(){return zo}),r.d(t,"boundMark",function(){return To}),r.d(t,"pathCurves",function(){return Pi}),r.d(t,"pathSymbols",function(){return Zi}),r.d(t,"pathRectangle",function(){return oa}),r.d(t,"pathTrail",function(){return sa}),r.d(t,"pathParse",function(){return Ti}),r.d(t,"pathRender",function(){return Yi}),r.d(t,"point",function(){return Ko}),r.d(t,"domCreate",function(){return Go}),r.d(t,"domFind",function(){return Ho}),r.d(t,"domChild",function(){return Xo}),r.d(t,"domClear",function(){return Jo}),r.d(t,"openTag",function(){return gs}),r.d(t,"closeTag",function(){return ys}),r.d(t,"font",function(){return Eo}),r.d(t,"fontFamily",function(){return Co}),r.d(t,"fontSize",function(){return wo}),r.d(t,"textMetrics",function(){return $o}),r.d(t,"resetSVGClipId",function(){return eo}),r.d(t,"sceneEqual",function(){return Ys}),r.d(t,"pathEqual",function(){return Ks}),r.d(t,"sceneToJSON",function(){return Vo}),r.d(t,"sceneFromJSON",function(){return Lo}),r.d(t,"intersectPath",function(){return Da}),r.d(t,"intersectPoint",function(){return Ca}),r.d(t,"intersectRule",function(){return Sa}),r.d(t,"intersectBoxLine",function(){return ja}),r.d(t,"sceneZOrder",function(){return Ra}),r.d(t,"sceneVisit",function(){return Ta}),r.d(t,"scenePickVisit",function(){return Ia});var n=r(178),i=r(233),a=r(121);r.d(t,"timeFormatLocale",function(){return a.b});var o=r(60),s=r(76),u=r(118),f=r(32),l=r(70),c=r(142),d=r(89);r.d(t,"formatLocale",function(){return d.b});var p=r(231),m=r(13),h=r(161),g=r(107),y=r(270),b=r(73),v=r(214);function O(e,t,r){return e.fields=t||[],e.fname=r,e}function $(e){return null==e?null:e.fname}function x(e){return null==e?null:e.fields}function k(e){throw Error(e)}function _(e){var t,r,n,i=[],a=null,o=0,s=e.length,u="";function f(){i.push(u+e.substring(t,r)),u="",t=r+1}for(e+="",t=r=0;r<s;++r)if("\\"===(n=e[r]))u+=e.substring(t,r),t=++r;else if(n===a)f(),a=null,o=-1;else{if(a)continue;t===o&&'"'===n?(t=r+1,a=n):t===o&&"'"===n?(t=r+1,a=n):"."!==n||o?"["===n?(r>t&&f(),o=t=r+1):"]"===n&&(o||k("Access path missing open bracket: "+e),o>0&&f(),o=0,t=r+1):r>t?f():t=r+1}return o&&k("Access path missing closing bracket: "+e),a&&k("Access path missing closing quote: "+e),r>t&&(r++,f()),i}var A=Array.isArray;function w(e){return e===Object(e)}function F(e){return"string"==typeof e}function D(e){return A(e)?"["+e.map(D)+"]":w(e)||F(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function C(e,t){var r=_(e),n="return _["+r.map(D).join("][")+"];";return O(Function("_",n),[e=1===r.length?r[0]:e],t||e)}var E=[],S=C("id"),j=O(function(e){return e},E,"identity"),M=O(function(){return 0},E,"zero"),q=O(function(){return 1},E,"one"),B=O(function(){return!0},E,"true"),P=O(function(){return!1},E,"false");function z(e,t,r){var n=[t].concat([].slice.call(r));console[e].apply(console,n)}var R=0,T=1,I=2,V=3,L=4;function N(e){var t=e||R;return{level:function(e){return arguments.length?(t=+e,this):t},error:function(){return t>=T&&z("error","ERROR",arguments),this},warn:function(){return t>=I&&z("warn","WARN",arguments),this},info:function(){return t>=V&&z("log","INFO",arguments),this},debug:function(){return t>=L&&z("log","DEBUG",arguments),this}}}function U(e){return e[e.length-1]}function W(e){return null==e||""===e?null:+e}function G(e){return function(t){return e*Math.exp(t)}}function H(e){return function(t){return Math.log(e*t)}}function X(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function J(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Y(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function K(e,t,r,n){var i=r(e[0]),a=r(U(e)),o=(a-i)*t;return[n(i-o),n(a-o)]}function Q(e,t){return K(e,t,W,j)}function Z(e,t){var r=Math.sign(e[0]);return K(e,t,H(r),G(r))}function ee(e,t,r){return K(e,t,Y(r),Y(1/r))}function te(e,t,r){return K(e,t,X(r),J(r))}function re(e,t,r,n,i){var a=n(e[0]),o=n(U(e)),s=null!=t?n(t):(a+o)/2;return[i(s+(a-s)*r),i(s+(o-s)*r)]}function ne(e,t,r){return re(e,t,r,W,j)}function ie(e,t,r){var n=Math.sign(e[0]);return re(e,t,r,H(n),G(n))}function ae(e,t,r,n){return re(e,t,r,Y(n),Y(1/n))}function oe(e,t,r,n){return re(e,t,r,X(n),J(n))}function se(e){return 1+~~(new Date(e).getMonth()/3)}function ue(e){return 1+~~(new Date(e).getUTCMonth()/3)}function fe(e){return null!=e?A(e)?e:[e]:[]}function le(e,t,r){var n,i=e[0],a=e[1];return a<i&&(n=a,a=i,i=n),(n=a-i)>=r-t?[t,r]:[i=Math.min(Math.max(i,t),r-n),i+n]}function ce(e){return"function"==typeof e}function de(e,t){var r,n,i,a,o,s,u,f,l,c=[],d=(e=fe(e)).map(function(e,t){return null==e?null:(c.push(t),ce(e)?e:_(e).map(D).join("]["))}),p=c.length-1,m=fe(t),h="var u,v;return ";if(p<0)return null;for(n=0;n<=p;++n)ce(i=d[r=c[n]])?(a="(u=this."+(s="f"+r)+"(a))",o="(v=this."+s+"(b))",(u=u||{})[s]=i):(a="(u=a["+i+"])",o="(v=b["+i+"])"),s="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==m[r]?(l=1,f=-1):(l=-1,f=1),h+="("+a+"<"+o+"||u==null)&&v!=null?"+f+":(u>v||v==null)&&u!=null?"+l+":"+s+"!==u&&v===v?"+f+":v!==v&&u===u?"+l+(r<p?":":":0");return i=Function("a","b",h+";"),u&&(i=i.bind(u)),e=e.reduce(function(e,t){return ce(t)?(x(t)||[]).forEach(function(t){e[t]=1}):null!=t&&(e[t+""]=1),e},{}),O(i,Object.keys(e))}function pe(e){return ce(e)?e:function(){return e}}function me(e,t){var r,n;function i(){t(n),r=n=null}return function(t){n=t,r&&clearTimeout(r),r=setTimeout(i,e)}}function he(e){for(var t,r,n=1,i=arguments.length;n<i;++n)for(r in t=arguments[n])e[r]=t[r];return e}function ge(e,t){var r,n,i,a,o=0;if(e&&(r=e.length))if(null==t){for(n=e[o];null==n||n!=n;n=e[++o]);for(i=a=n;o<r;++o)null!=(n=e[o])&&(n<i&&(i=n),n>a&&(a=n))}else{for(n=t(e[o]);null==n||n!=n;n=t(e[++o]));for(i=a=n;o<r;++o)null!=(n=t(e[o]))&&(n<i&&(i=n),n>a&&(a=n))}return[i,a]}function ye(e,t){var r,n,i,a,o,s=-1,u=e.length;if(null==t){for(;++s<u;)if(null!=(n=e[s])&&n>=n){r=i=n;break}for(a=o=s;++s<u;)null!=(n=e[s])&&(r>n&&(r=n,a=s),i<n&&(i=n,o=s))}else{for(;++s<u;)if(null!=(n=t(e[s],s,e))&&n>=n){r=i=n;break}for(a=o=s;++s<u;)null!=(n=t(e[s],s,e))&&(r>n&&(r=n,a=s),i<n&&(i=n,o=s))}return[a,o]}var be={};function ve(e){var t,r,n={};function i(e){return n.hasOwnProperty(e)&&n[e]!==be}return t={size:0,empty:0,object:n,has:i,get:function(e){return i(e)?n[e]:void 0},set:function(e,r){return i(e)||(++t.size,n[e]===be&&--t.empty),n[e]=r,this},delete:function(e){return i(e)&&(--t.size,++t.empty,n[e]=be),this},clear:function(){t.size=t.empty=0,t.object=n={}},test:function(e){return arguments.length?(r=e,t):r},clean:function(){var e,i,a={},o=0;for(e in n)(i=n[e])===be||r&&r(i)||(a[e]=i,++o);t.size=o,t.empty=0,t.object=n=a}},e&&Object.keys(e).forEach(function(r){t.set(r,e[r])}),t}function Oe(e,t,r,n,i,a){if(!r&&0!==r)return a;var o,s,u=e[0],f=U(e),l=+r;return f<u&&(o=u,u=f,f=o),(o=Math.abs(t-u))<(s=Math.abs(f-t))&&o<=l?n:s<=l?i:a}function $e(e,t){var r=e.prototype=Object.create(t.prototype);return r.constructor=e,r}function xe(e,t,r,n){var i,a=t[0],o=t[t.length-1];return a>o&&(i=a,a=o,o=i),n=void 0===n||n,((r=void 0===r||r)?a<=e:a<e)&&(n?e<=o:e<o)}function ke(e){return"boolean"==typeof e}function _e(e){return"[object Date]"===Object.prototype.toString.call(e)}function Ae(e){return"number"==typeof e}function we(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Fe(e,t){return e&&(e=t?fe(e).map(function(e){return e.replace(/\\(.)/g,"$1")}):fe(e)),O(e&&e.length?Function("_","return ''+"+e.map(function(e){return"_["+(t?D(e):_(e).map(D).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},e,"key")}function De(e,t,r,n){var i=t.length,a=r.length;if(!a)return t;if(!i)return r;for(var o=n||new t.constructor(i+a),s=0,u=0,f=0;s<i&&u<a;++f)o[f]=e(t[s],r[u])>0?r[u++]:t[s++];for(;s<i;++s,++f)o[f]=t[s];for(;u<a;++u,++f)o[f]=r[u];return o}function Ce(e,t){for(var r="";--t>=0;)r+=e;return r}function Ee(e,t,r,n){var i=r||" ",a=e+"",o=t-a.length;return o<=0?a:"left"===n?Ce(i,o)+a:"center"===n?Ce(i,~~(o/2))+a+Ce(i,Math.ceil(o/2)):a+Ce(i,o)}function Se(e){return U(e)-e[0]||0}function je(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}function Me(e){return Ae(e)?e:_e(e)?e:Date.parse(e)}function qe(e,t){return t=t||Me,null==e||""===e?null:t(e)}function Be(e){return null==e||""===e?null:e+""}function Pe(e){for(var t={},r=0,n=e.length;r<n;++r)t[e[r]]=!0;return t}function ze(e,t,r,n){var i=null!=n?n:"…",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:"left"===r?i+a.slice(o-s):"center"===r?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i}function Re(e,t,r){if(e){var n,i=0,a=e.length;if(t)for(;i<a;++i)(n=t(e[i]))&&r(n,i,e);else e.forEach(r)}}function Te(e){var t=e||j,r=[],n={};return r.add=function(e){var i=t(e);return n[i]||(n[i]=1,r.push(e)),r},r.remove=function(e){var i,a=t(e);return n[a]&&(n[a]=0,(i=r.indexOf(e))>=0&&r.splice(i,1)),r},r}async function Ie(e,t){try{await t(e)}catch(t){e.error(t)}}var Ve=Symbol("vega_id"),Le=1;function Ne(e){return!(!e||!Ue(e))}function Ue(e){return e[Ve]}function We(e,t){return e[Ve]=t,e}function Ge(e){var t=e===Object(e)?e:{data:e};return Ue(t)?t:We(t,Le++)}function He(e){return Xe(e,Ge({}))}function Xe(e,t){for(var r in e)t[r]=e[r];return t}function Je(e,t){return We(t,Ue(e))}function Ye(e){return e&&e.constructor===Ke}function Ke(){var e=[],t=[],r=[],n=[],i=[],a=!1;return{constructor:Ke,insert:function(t){for(var r=fe(t),n=0,i=r.length;n<i;++n)e.push(r[n]);return this},remove:function(e){for(var r=ce(e)?n:t,i=fe(e),a=0,o=i.length;a<o;++a)r.push(i[a]);return this},modify:function(e,t,n){var a={field:t,value:pe(n)};return ce(e)?(a.filter=e,i.push(a)):(a.tuple=e,r.push(a)),this},encode:function(e,t){return ce(e)?i.push({filter:e,field:t}):r.push({tuple:e,field:t}),this},reflow:function(){return a=!0,this},pulse:function(o,s){var u,f,l,c,d,p,m={},h={};for(u=0,f=s.length;u<f;++u)m[Ue(s[u])]=1;for(u=0,f=t.length;u<f;++u)m[Ue(d=t[u])]=-1;for(u=0,f=n.length;u<f;++u)c=n[u],s.forEach(function(e){c(e)&&(m[Ue(e)]=-1)});for(u=0,f=e.length;u<f;++u)p=Ue(d=e[u]),m[p]?m[p]=1:o.add.push(Ge(e[u]));for(u=0,f=s.length;u<f;++u)d=s[u],m[Ue(d)]<0&&o.rem.push(d);function g(e,t,r){r?e[t]=r(e):o.encode=t,a||(h[Ue(e)]=e)}for(u=0,f=r.length;u<f;++u)d=(l=r[u]).tuple,c=l.field,(p=m[Ue(d)])>0&&(g(d,c,l.value),o.modifies(c));for(u=0,f=i.length;u<f;++u)l=i[u],c=l.filter,s.forEach(function(e){c(e)&&m[Ue(e)]>0&&g(e,l.field,l.value)}),o.modifies(l.field);if(a)o.mod=t.length||n.length?s.filter(function(e){return m[Ue(e)]>0}):s.slice();else for(p in h)o.mod.push(h[p]);return o}}}var Qe="_:mod:_";function Ze(){Object.defineProperty(this,Qe,{writable:!0,value:{}})}var et=Ze.prototype;et.set=function(e,t,r,n){var i=this,a=i[e],o=i[Qe];return null!=t&&t>=0?(a[t]!==r||n)&&(a[t]=r,o[t+":"+e]=-1,o[e]=-1):(a!==r||n)&&(i[e]=r,o[e]=A(r)?1+r.length:-1),i},et.modified=function(e,t){var r,n=this[Qe];if(!arguments.length){for(r in n)if(n[r])return!0;return!1}if(A(e)){for(r=0;r<e.length;++r)if(n[e[r]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},et.clear=function(){return this[Qe]={},this};var tt=0,rt=new Ze;function nt(e,t,r,n){this.id=++tt,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),r&&this.parameters(r,n)}var it=nt.prototype;function at(e){return function(t){var r=this.flags;return 0===arguments.length?!!(r&e):(this.flags=t?r|e:r&~e,this)}}it.targets=function(){return this._targets||(this._targets=Te(S))},it.set=function(e){return this.value!==e?(this.value=e,1):0},it.skip=at(1),it.modified=at(2),it.parameters=function(e,t,r){t=!1!==t;var n,i,a,o,s=this,u=s._argval=s._argval||new Ze,f=s._argops=s._argops||[],l=[];function c(e,r,n){n instanceof nt?(n!==s&&(t&&n.targets().add(s),l.push(n)),f.push({op:n,name:e,index:r})):u.set(e,r,n)}for(n in e)if(i=e[n],"pulse"===n)fe(i).forEach(function(e){e instanceof nt?e!==s&&(e.targets().add(s),l.push(e)):k("Pulse parameters must be operator instances.")}),s.source=i;else if(A(i))for(u.set(n,-1,Array(a=i.length)),o=0;o<a;++o)c(n,o,i[o]);else c(n,-1,i);return this.marshall().clear(),r&&(f.initonly=!0),l},it.marshall=function(e){var t,r,n,i,a,o=this._argval||rt,s=this._argops;if(s){for(r=0,n=s.length;r<n;++r)a=(i=(t=s[r]).op).modified()&&i.stamp===e,o.set(t.name,t.index,i.value,a);if(s.initonly){for(r=0;r<n;++r)(t=s[r]).op.targets().remove(this);this._argops=null,this._update=null}}return o},it.evaluate=function(e){var t=this._update;if(t){var r=this.marshall(e.stamp),n=t.call(this,r,e);if(r.clear(),n!==this.value)this.value=n;else if(!this.modified())return e.StopPropagation}},it.run=function(e){return e.stamp<=this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.stamp=e.stamp,this.pulse=t||e);var t};var ot=0;function st(e,t,r){this.id=++ot,this.value=null,r&&(this.receive=r),e&&(this._filter=e),t&&(this._apply=t)}function ut(e,t,r){return new st(e,t,r)}var ft=st.prototype;ft._filter=B,ft._apply=j,ft.targets=function(){return this._targets||(this._targets=Te(S))},ft.consume=function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},ft.receive=function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),r=this._targets,n=r?r.length:0,i=0;i<n;++i)r[i].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},ft.filter=function(e){var t=ut(e);return this.targets().add(t),t},ft.apply=function(e){var t=ut(null,e);return this.targets().add(t),t},ft.merge=function(){var e=ut();this.targets().add(e);for(var t=0,r=arguments.length;t<r;++t)arguments[t].targets().add(e);return e},ft.throttle=function(e){var t=-1;return this.filter(function(){var r=Date.now();return r-t>e?(t=r,1):0})},ft.debounce=function(e){var t=ut();return this.targets().add(ut(null,null,me(e,function(e){var r=e.dataflow;t.receive(e),r&&r.run&&r.run()}))),t},ft.between=function(e,t){var r=!1;return e.targets().add(ut(null,null,function(){r=!0})),t.targets().add(ut(null,null,function(){r=!1})),this.filter(function(){return r})};var lt=/^([A-Za-z]+:)?\/\//,ct="file://";async function dt(e,t){const r=await this.sanitize(e,t),n=r.href;return r.localFile?this.file(n):this.http(n,t)}async function pt(e,t){t=he({},this.options,t);const r=this.fileAccess,n={href:null};let i,a,o,s;return null!=e&&"string"==typeof e||k("Sanitize failure, invalid URI: "+D(e)),a=lt.test(e),(s=t.baseURL)&&!a&&(e.startsWith("/")||"/"===s[s.length-1]||(e="/"+e),e=s+e),o=(i=e.startsWith(ct))||"file"===t.mode||"http"!==t.mode&&!a&&r,i?e=e.slice(ct.length):e.startsWith("//")&&("file"===t.defaultProtocol?(e=e.slice(2),o=!0):e=(t.defaultProtocol||"http")+":"+e),Object.defineProperty(n,"localFile",{value:!!o}),n.href=e,t.target&&(n.target=t.target+""),t.rel&&(n.rel=t.rel+""),n}function mt(e){return e?function(t){return new Promise(function(r,n){e.readFile(t,function(e,t){e?n(e):r(t)})})}:ht}async function ht(){k("No file system access.")}function gt(e){return e?async function(t,r){const n=he({},this.options.http,r),i=r&&r.response,a=await e(t,n);return a.ok?ce(a[i])?a[i]():a.text():k(a.status+""+a.statusText)}:yt}async function yt(){k("No HTTP fetch method available.")}var bt={boolean:je,integer:W,number:W,date:qe,string:Be,unknown:j},vt=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return kt(e)&&(e=+e)==~~e},kt,function(e){return!isNaN(Date.parse(e))}],Ot=["boolean","integer","number","date"];function $t(e,t){if(!e||!e.length)return"unknown";var r,n,i,a,o=0,s=e.length,u=vt.length,f=vt.map(function(e,t){return t+1});for(n=0,s=e.length;n<s;++n)for(r=t?e[n][t]:e[n],i=0;i<u;++i)if(f[i]&&(null!=(a=r)&&a==a)&&!vt[i](r)&&(f[i]=0,++o===vt.length))return"string";return o=f.reduce(function(e,t){return 0===e?t:e},0)-1,Ot[o]}function xt(e,t){return t.reduce(function(t,r){return t[r]=$t(e,r),t},{})}function kt(e){return!(isNaN(+e)||e instanceof Date)}function _t(e){const t=function(t,r){const n={delimiter:e};return At(t,r?he(r,n):n)};return t.responseType="text",t}function At(e,t){return t.header&&(e=t.header.map(D).join(t.delimiter)+"\n"+e),Object(n.b)(t.delimiter).parse(e+"")}function wt(t,r){const n=r&&r.property?C(r.property):j;return!w(t)||(i=t,"function"==typeof e&&ce(e.isBuffer)&&e.isBuffer(i))?n(JSON.parse(t)):function(e,t){return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(n(t));var i}function Ft(e,t){var r,n,a;return e=wt(e,t),r=t&&(a=t.feature)?i.a:t&&(a=t.mesh)?i.b:k("Missing TopoJSON feature or mesh parameter."),(n=(n=e.objects[a])?r(e,n):k("Invalid TopoJSON object: "+a))&&n.features||[n]}At.responseType="text",wt.responseType="json",Ft.responseType="json";const Dt={dsv:At,csv:_t(","),tsv:_t("\t"),json:wt,topojson:Ft};function Ct(e,t){return arguments.length>1?(Dt[e]=t,this):Dt.hasOwnProperty(e)?Dt[e]:null}function Et(e){const t=Ct(e);return t&&t.responseType||"text"}function St(e,t,r){const n=Ct((t=t||{}).type||"json");return n||k("Unknown data format type: "+t.type),e=n(e,t),t.parse&&function(e,t,r){if(!e.length)return;r=r||a.c;var n,i,o,s,u,f,l,c=e.columns||Object.keys(e[0]);"auto"===t&&(t=xt(e,c));for(c=Object.keys(t),n=c.map(function(e){var n,i,o=t[e];if(o&&(0===o.indexOf("date:")||0===o.indexOf("utc:")))return("'"===(i=(n=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),"utc"===n[0]?Object(a.e)(i):r(i);if(!bt[o])throw Error("Illegal format pattern: "+e+":"+o);return bt[o]}),s=0,f=e.length,l=c.length;s<f;++s)for(i=e[s],u=0;u<l;++u)o=c[u],i[o]=n[u](i[o])}(e,t.parse,r),e.hasOwnProperty("columns")&&delete e.columns,e}var jt=function(e,t){return function(r){return{options:r||{},sanitize:pt,load:dt,fileAccess:!!t,file:mt(t),http:gt(e)}}}("undefined"!=typeof fetch&&fetch,null);const Mt=St;var qt={skip:!0};function Bt(e,t,r,n,i,a){var o,s,u=he({},a,qt);ce(r)||(r=pe(r)),void 0===n?o=function(t){e.touch(r(t))}:ce(n)?(s=new nt(null,n,i,!1),o=function(t){var n,i=r(t);s.evaluate(t),Ye(n=s.value)?e.pulse(i,n,a):e.update(i,n,u)}):o=function(t){e.update(r(t),n,u)},t.apply(o)}function Pt(e,t,r,n,i,a){var o,s;void 0===n?s=r:(o=ce(n)?n:pe(n),(s=new nt(null,n=r?function(e,t){var n=o(e,t);return r.skip()||(r.skip(n!==this.value).value=n),n}:o,i,!1)).modified(a&&a.force),s.rank=0,r&&(s.skip(!0),s.value=r.value,s.targets().add(r))),t.targets().add(s)}var zt={};function Rt(e,t,r){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=r||null}var Tt=Rt.prototype;function It(e,t){return e?function(r,n){return e(r,n)&&t(r,n)}:t}function Vt(e,t){var r=[];return Re(e,t,function(e){r.push(e)}),r}function Lt(e,t){var r={};return e.visit(t,function(e){r[Ue(e)]=1}),function(e){return r[Ue(e)]?null:e}}function Nt(e,t,r,n){var i,a,o,s,u,f=this,l=0;for(this.dataflow=e,this.stamp=t,this.fields=null,this.encode=n||null,this.pulses=r,o=0,s=r.length;o<s;++o)if((i=r[o]).stamp===t){if(i.fields)for(u in a=f.fields||(f.fields={}),i.fields)a[u]=1;i.changed(f.ADD)&&(l|=f.ADD),i.changed(f.REM)&&(l|=f.REM),i.changed(f.MOD)&&(l|=f.MOD)}this.changes=l}Tt.StopPropagation=zt,Tt.ADD=1,Tt.REM=2,Tt.MOD=4,Tt.ADD_REM=3,Tt.ADD_MOD=5,Tt.ALL=7,Tt.REFLOW=8,Tt.SOURCE=16,Tt.NO_SOURCE=32,Tt.NO_FIELDS=64,Tt.fork=function(e){return new Rt(this.dataflow).init(this,e)},Tt.clone=function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},Tt.addAll=function(){var e=this;return this.source&&this.source.length!==this.add.length?((e=new Rt(this.dataflow).init(this)).add=e.source,e):e},Tt.init=function(e,t){var r=this;return r.stamp=e.stamp,r.encode=e.encode,!e.fields||64&t||(r.fields=e.fields),1&t?(r.addF=e.addF,r.add=e.add):(r.addF=null,r.add=[]),2&t?(r.remF=e.remF,r.rem=e.rem):(r.remF=null,r.rem=[]),4&t?(r.modF=e.modF,r.mod=e.mod):(r.modF=null,r.mod=[]),32&t?(r.srcF=null,r.source=null):(r.srcF=e.srcF,r.source=e.source),r},Tt.runAfter=function(e){this.dataflow.runAfter(e)},Tt.changed=function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},Tt.reflow=function(e){if(e)return this.fork(7).reflow();var t=this.add.length,r=this.source&&this.source.length;return r&&r!==t&&(this.mod=this.source,t&&this.filter(4,Lt(this,1))),this},Tt.modifies=function(e){var t=fe(e),r=this.fields||(this.fields={});return t.forEach(function(e){r[e]=!0}),this},Tt.modified=function(e){var t=this.fields;return!(!this.mod.length||!t)&&(arguments.length?A(e)?e.some(function(e){return t[e]}):t[e]:!!t)},Tt.filter=function(e,t){var r=this;return 1&e&&(r.addF=It(r.addF,t)),2&e&&(r.remF=It(r.remF,t)),4&e&&(r.modF=It(r.modF,t)),16&e&&(r.srcF=It(r.srcF,t)),r},Tt.materialize=function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=Vt(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=Vt(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=Vt(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},Tt.visit=function(e,t){var r,n,i=this,a=t;return 16&e?(Re(i.source,i.srcF,a),i):(1&e&&Re(i.add,i.addF,a),2&e&&Re(i.rem,i.remF,a),4&e&&Re(i.mod,i.modF,a),8&e&&(r=i.source)&&((n=i.add.length+i.mod.length)===r.length||Re(r,n?Lt(i,5):i.srcF,a)),i)};var Ut=$e(Nt,Rt);function Wt(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}Ut.fork=function(e){var t=new Rt(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,function(e){return t.add.push(e)}),e&t.REM&&this.visit(t.REM,function(e){return t.rem.push(e)}),e&t.MOD&&this.visit(t.MOD,function(e){return t.mod.push(e)})),t},Ut.changed=function(e){return this.changes&e},Ut.modified=function(e){var t=this,r=t.fields;return r&&t.changes&t.MOD?A(e)?e.some(function(e){return r[e]}):r[e]:0},Ut.filter=function(){k("MultiPulse does not support filtering.")},Ut.materialize=function(){k("MultiPulse does not support materialization.")},Ut.visit=function(e,t){var r=this,n=r.pulses,i=n.length,a=0;if(e&r.SOURCE)for(;a<i;++a)n[a].visit(e,t);else for(;a<i;++a)n[a].stamp===r.stamp&&n[a].visit(e,t);return r};var Gt={skip:!1,force:!1};function Ht(e){this.cmp=e,this.nodes=[]}var Xt=Ht.prototype;function Jt(e,t,r,n){var i,a,o;for(i=e[r];r>t&&n(i,a=e[o=r-1>>1])<0;)e[r]=a,r=o;return e[r]=i}function Yt(e,t,r){for(var n,i=t,a=e.length,o=e[t],s=2*t+1;s<a;)(n=s+1)<a&&r(e[s],e[n])>=0&&(s=n),e[t]=e[s],s=2*(t=s)+1;return e[t]=o,Jt(e,i,t,r)}function Kt(){this._log=N(),this.logLevel(T),this._clock=0,this._rank=0;try{this._loader=jt()}catch(e){}this._touched=Te(S),this._pulses={},this._pulse=null,this._heap=new Ht(function(e,t){return e.qrank-t.qrank}),this._postrun=[]}Xt.size=function(){return this.nodes.length},Xt.clear=function(){return this.nodes=[],this},Xt.peek=function(){return this.nodes[0]},Xt.push=function(e){var t=this.nodes;return t.push(e),Jt(t,0,t.length-1,this.cmp)},Xt.pop=function(){var e,t=this.nodes,r=t.pop();return t.length?(e=t[0],t[0]=r,Yt(t,0,this.cmp)):e=r,e},Xt.replace=function(e){var t=this.nodes,r=t[0];return t[0]=e,Yt(t,0,this.cmp),r},Xt.pushpop=function(e){var t=this.nodes,r=t[0];return t.length&&this.cmp(r,e)<0&&(t[0]=e,e=r,Yt(t,0,this.cmp)),e};var Qt=Kt.prototype;function Zt(e){return function(){return this._log[e].apply(this,arguments)}}function er(e,t){nt.call(this,e,null,t)}Qt.stamp=function(){return this._clock},Qt.loader=function(e){return arguments.length?(this._loader=e,this):this._loader},Qt.cleanThreshold=1e4,Qt.add=function(e,t,r,n){var i,a=1;return e instanceof nt?i=e:e&&e.prototype instanceof nt?i=new e:ce(e)?i=new nt(null,e):(a=0,i=new nt(e,t)),this.rank(i),a&&(n=r,r=t),r&&this.connect(i,i.parameters(r,n)),this.touch(i),i},Qt.connect=function(e,t){var r,n,i=e.rank;for(r=0,n=t.length;r<n;++r)if(i<t[r].rank)return void this.rerank(e)},Qt.rank=function(e){e.rank=++this._rank},Qt.rerank=function(e){for(var t,r,n,i=[e];i.length;)if(this.rank(t=i.pop()),r=t._targets)for(n=r.length;--n>=0;)i.push(t=r[n]),t===e&&k("Cycle detected in dataflow graph.")},Qt.pulse=function(e,t,r){this.touch(e,r||Gt);var n=new Rt(this,this._clock+(this._pulse?0:1)),i=e.pulse&&e.pulse.source||[];return n.target=e,this._pulses[e.id]=t.pulse(n,i),this},Qt.touch=function(e,t){var r=t||Gt;return this._pulse?this._enqueue(e):this._touched.add(e),r.skip&&e.skip(!0),this},Qt.update=function(e,t,r){var n=r||Gt;return(e.set(t)||n.force)&&this.touch(e,n),this},Qt.changeset=Ke,Qt.ingest=function(e,t,r){return this.pulse(e,this.changeset().insert(Mt(t,r)))},Qt.parse=Mt,Qt.preload=async function(e,t,r){const n=this,i=n._pending||function(e){var t,r=new Promise(function(e){t=e});return r.requests=0,r.done=function(){0==--r.requests&&(e._pending=null,t(e))},e._pending=r}(n);i.requests+=1;const a=await n.request(t,r);return n.pulse(e,n.changeset().remove(B).insert(a.data||[])),i.done(),a},Qt.request=async function(e,t){const r=this;let n,i=0;try{n=await r.loader().load(e,{context:"dataflow",response:Et(t&&t.type)});try{n=Mt(n,t)}catch(t){i=-2,r.warn("Data ingestion failed",e,t)}}catch(t){i=-1,r.warn("Loading failed",e,t)}return{data:n,status:i}},Qt.events=function(e,t,r,n){for(var i,a=this,o=ut(r,n),s=function(e){e.dataflow=a;try{o.receive(e)}catch(e){a.error(e)}finally{a.run()}},u=0,f=(i="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):fe(e)).length;u<f;++u)i[u].addEventListener(t,s);return o},Qt.on=function(e,t,r,n,i){return(e instanceof nt?Pt:Bt)(this,e,t,r,n,i),this},Qt.evaluate=async function(e,t,r){const n=this,i=n.logLevel();if(n._pulse)return Wt(n);if(n._pending&&await n._pending,t&&await Ie(n,t),!n._touched.length)return n.info("Dataflow invoked, but nothing to do."),n;let a,o,s,u,f=++n._clock,l=0;n._pulse=new Rt(n,f,e),i>=V&&(s=Date.now(),n.debug("-- START PROPAGATION ("+f+") -----")),n._touched.forEach(function(e){n._enqueue(e,!0)}),n._touched=Te(S);try{for(;n._heap.size()>0;)(a=n._heap.pop()).rank===a.qrank?((o=a.run(n._getPulse(a,e))).then&&(o=await o),i>=L&&n.debug(a.id,o===zt?"STOP":o,a),o!==zt&&(n._pulse=o,a._targets&&a._targets.forEach(e=>n._enqueue(e))),++l):n._enqueue(a,!0)}catch(e){u=e}if(n._pulses={},n._pulse=null,i>=V&&(s=Date.now()-s,n.info("> Pulse "+f+": "+l+" operators; "+s+"ms")),u&&(n._postrun=[],n.error(u)),n._postrun.length){const e=n._postrun;n._postrun=[],e.sort((e,t)=>t.priority-e.priority).forEach(async function(e){await Ie(n,e.callback)})}return r&&await Ie(n,r),n},Qt.run=function(e,t,r){return this._pulse?Wt(this):(this.evaluate(e,t,r),this)},Qt.runAsync=async function(e,t,r){for(;this._running;)await this._running;const n=()=>this._running=null;return(this._running=this.evaluate(e,t,r)).then(n,n),this._running},Qt.runAfter=function(e,t,r){if(this._pulse||t)this._postrun.push({priority:r||0,callback:e});else try{e(this)}catch(e){this.error(e)}},Qt._enqueue=function(e,t){var r=!this._pulses[e.id];r&&(this._pulses[e.id]=this._pulse),(r||t)&&(e.qrank=e.rank,this._heap.push(e))},Qt._getPulse=function(e,t){var r,n=e.source,i=this._clock;return n&&A(n)?new Nt(this,i,r=n.map(function(e){return e.pulse}),t):(r=this._pulses[e.id],n&&((n=n.pulse)&&n!==zt?n.stamp===i&&r.target!==e?r=n:r.source=n.source:r.source=[]),r)},Qt.error=Zt("error"),Qt.warn=Zt("warn"),Qt.info=Zt("info"),Qt.debug=Zt("debug"),Qt.logLevel=Zt("level");var tr=$e(er,nt);tr.run=function(e){return e.stamp<=this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),t=t||e,this.stamp=e.stamp,t.then?t=t.then(e=>this.pulse=e):t!==e.StopPropagation&&(this.pulse=t),t);var t},tr.evaluate=function(e){var t=this.marshall(e.stamp),r=this.transform(t,e);return t.clear(),r},tr.transform=function(){};var rr={};function nr(e){var t=ir(e);return t&&t.Definition||null}function ir(e){return e=e&&e.toLowerCase(),rr.hasOwnProperty(e)?rr[e]:null}function ar(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var r=t.length,n=1,i=String(t[0](e));n<r;++n)i+="|"+t[n](e);return i}):function(){return""};var t}function or(e,t,r){return r||e+(t?"_"+t:"")}var sr={values:lr({name:"values",init:"cell.store = true;",set:"cell.data.values()",idx:-1}),count:lr({name:"count",set:"cell.num"}),__count__:lr({name:"count",set:"this.missing + this.valid"}),missing:lr({name:"missing",set:"this.missing"}),valid:lr({name:"valid",set:"this.valid"}),sum:lr({name:"sum",init:"this.sum = 0;",add:"this.sum += +v;",rem:"this.sum -= v;",set:"this.sum"}),mean:lr({name:"mean",init:"this.mean = 0;",add:"var d = v - this.mean; this.mean += d / this.valid;",rem:"var d = v - this.mean; this.mean -= this.valid ? d / this.valid : this.mean;",set:"this.valid ? this.mean : undefined"}),average:lr({name:"average",set:"this.valid ? this.mean : undefined",req:["mean"],idx:1}),variance:lr({name:"variance",init:"this.dev = 0;",add:"this.dev += d * (v - this.mean);",rem:"this.dev -= d * (v - this.mean);",set:"this.valid > 1 ? this.dev / (this.valid-1) : undefined",req:["mean"],idx:1}),variancep:lr({name:"variancep",set:"this.valid > 1 ? this.dev / this.valid : undefined",req:["variance"],idx:2}),stdev:lr({name:"stdev",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid-1)) : undefined",req:["variance"],idx:2}),stdevp:lr({name:"stdevp",set:"this.valid > 1 ? Math.sqrt(this.dev / this.valid) : undefined",req:["variance"],idx:2}),stderr:lr({name:"stderr",set:"this.valid > 1 ? Math.sqrt(this.dev / (this.valid * (this.valid-1))) : undefined",req:["variance"],idx:2}),distinct:lr({name:"distinct",set:"cell.data.distinct(this.get)",req:["values"],idx:3}),ci0:lr({name:"ci0",set:"cell.data.ci0(this.get)",req:["values"],idx:3}),ci1:lr({name:"ci1",set:"cell.data.ci1(this.get)",req:["values"],idx:3}),median:lr({name:"median",set:"cell.data.q2(this.get)",req:["values"],idx:3}),q1:lr({name:"q1",set:"cell.data.q1(this.get)",req:["values"],idx:3}),q3:lr({name:"q3",set:"cell.data.q3(this.get)",req:["values"],idx:3}),argmin:lr({name:"argmin",init:"this.argmin = undefined;",add:"if (v < this.min) this.argmin = t;",rem:"if (v <= this.min) this.argmin = undefined;",set:"this.argmin || cell.data.argmin(this.get)",req:["min"],str:["values"],idx:3}),argmax:lr({name:"argmax",init:"this.argmax = undefined;",add:"if (v > this.max) this.argmax = t;",rem:"if (v >= this.max) this.argmax = undefined;",set:"this.argmax || cell.data.argmax(this.get)",req:["max"],str:["values"],idx:3}),min:lr({name:"min",init:"this.min = undefined;",add:"if (v < this.min || this.min === undefined) this.min = v;",rem:"if (v <= this.min) this.min = NaN;",set:"this.min = (isNaN(this.min) ? cell.data.min(this.get) : this.min)",str:["values"],idx:4}),max:lr({name:"max",init:"this.max = undefined;",add:"if (v > this.max || this.max === undefined) this.max = v;",rem:"if (v >= this.max) this.max = NaN;",set:"this.max = (isNaN(this.max) ? cell.data.max(this.get) : this.max)",str:["values"],idx:4})},ur=Object.keys(sr);function fr(e,t){return sr[e](t)}function lr(e){return function(t){var r=he({init:"",add:"",rem:"",idx:0},e);return r.out=t||e.name,r}}function cr(e,t){return e.idx-t.idx}function dr(e,t){var r=t||j,n=function(e,t){var r,n=e.reduce(function e(r,n){function i(t){r[t]||e(r,r[t]=sr[t]())}return n.req&&n.req.forEach(i),t&&n.str&&n.str.forEach(i),r},e.reduce(function(e,t){return e[t.name]=t,e},{})),i=[];for(r in n)i.push(n[r]);return i.sort(cr)}(e,!0),i="var cell = this.cell; this.valid = 0; this.missing = 0;",a="this.cell = cell; this.init();",o="if(v==null){++this.missing; return;} if(v!==v) return; ++this.valid;",s="if(v==null){--this.missing; return;} if(v!==v) return; --this.valid;",u="var cell = this.cell;";return n.forEach(function(e){i+=e.init,o+=e.add,s+=e.rem}),e.slice().sort(cr).forEach(function(e){u+="t['"+e.out+"']="+e.set+";"}),u+="return t;",(a=Function("cell",a)).prototype.init=Function(i),a.prototype.add=Function("v","t",o),a.prototype.rem=Function("v","t",s),a.prototype.set=Function("t",u),a.prototype.get=r,a.fields=e.map(function(e){return e.out}),a}function pr(e){var t,r,n,i,a,o,s,u,f=e.maxbins||20,l=e.base||10,c=Math.log(l),d=e.divide||[5,2],p=e.extent[0],m=e.extent[1],h=m-p;if(e.step)t=e.step;else if(e.steps){for(a=h/f,o=0,s=e.steps.length;o<s&&e.steps[o]<a;++o);t=e.steps[Math.max(0,o-1)]}else{for(r=Math.ceil(Math.log(f)/c),n=e.minstep||0,t=Math.max(n,Math.pow(l,Math.round(Math.log(h)/c)-r));Math.ceil(h/t)>f;)t*=l;for(o=0,s=d.length;o<s;++o)(a=t/d[o])>=n&&h/a<=f&&(t=a)}return i=(a=Math.log(t))>=0?0:1+~~(-a/c),u=Math.pow(l,-i-1),(e.nice||void 0===e.nice)&&(p=p<(a=Math.floor(p/t+u)*t)?a-t:a,m=Math.ceil(m/t)*t),{start:p,stop:m,step:t}}function mr(e,t){var r,n=[],i=e.length,a=-1;if(null==t)for(;++a<i;)isNaN(r=hr(e[a]))||n.push(r);else for(;++a<i;)isNaN(r=hr(t(e[a],a,e)))||n.push(r);return n}function hr(e){return null===e?NaN:+e}var gr=Math.random;function yr(e){gr=e}function br(e,t,r,n){if(!e.length)return[void 0,void 0];var i,a,s,u,f=mr(e,n),l=f.length,c=t;for(s=0,u=Array(c);s<c;++s){for(i=0,a=0;a<l;++a)i+=f[~~(gr()*l)];u[s]=i/l}return[Object(o.l)(u.sort(o.a),r/2),Object(o.l)(u,1-r/2)]}function vr(e,t){var r=mr(e,t);return[Object(o.l)(r.sort(o.a),.25),Object(o.l)(r,.5),Object(o.l)(r,.75)]}function Or(e,t){null==t&&(t=e,e=0);var r,n,i,a={};return a.min=function(e){return arguments.length?(i=n-(r=e||0),a):r},a.max=function(e){return arguments.length?(i=(n=e||0)-r,a):n},a.sample=function(){return r+Math.floor(i*gr())},a.pdf=function(e){return e===Math.floor(e)&&e>=r&&e<n?1/i:0},a.cdf=function(e){var t=Math.floor(e);return t<r?0:t>=n?1:(t-r+1)/i},a.icdf=function(e){return e>=0&&e<=1?r-1+Math.floor(e*i):NaN},a.min(e).max(t)}function $r(e,t){var r,n,i=NaN,a={mean:function(e){return arguments.length?(r=e||0,i=NaN,a):r},stdev:function(e){return arguments.length?(n=null==e?1:e,i=NaN,a):n},sample:function(){var e,t,a=0,o=0;if(i==i)return a=i,i=NaN,a;do{e=(a=2*gr()-1)*a+(o=2*gr()-1)*o}while(0===e||e>1);return t=Math.sqrt(-2*Math.log(e)/e),i=r+o*t*n,r+a*t*n},pdf:function(e){var t=Math.exp(Math.pow(e-r,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*t},cdf:function(e){var t,i=(e-r)/n,a=Math.abs(i);if(a>37)t=0;else{var o=Math.exp(-a*a/2);a<7.07106781186547?(t=o*((((((.0352624965998911*a+.700383064443688)*a+6.37396220353165)*a+33.912866078383)*a+112.079291497871)*a+221.213596169931)*a+220.206867912376),t/=((((((.0883883476483184*a+1.75566716318264)*a+16.064177579207)*a+86.7807322029461)*a+296.564248779674)*a+637.333633378831)*a+793.826512519948)*a+440.413735824752):t=o/(a+1/(a+2/(a+3/(a+4/(a+.65)))))/2.506628274631}return i>0?1-t:t},icdf:function(e){if(e<=0||e>=1)return NaN;var t=2*e-1,i=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),a=2/(Math.PI*i)+Math.log(1-Math.pow(t,2))/2,o=Math.log(1-t*t)/i,s=(t>0?1:-1)*Math.sqrt(Math.sqrt(a*a-o)-a);return r+n*Math.SQRT2*s}};return a.mean(e).stdev(t)}function xr(e,t){var r=$r(),n={},i=0;return n.data=function(r){return arguments.length?(e=r,i=r?r.length:0,n.bandwidth(t)):e},n.bandwidth=function(r){return arguments.length?(!(t=r)&&e&&(a=(i=e).length,s=vr(i),u=(s[2]-s[0])/1.34,t=1.06*Math.min(Math.sqrt(Object(o.p)(i)),u)*Math.pow(a,-.2)),n):t;var i,a,s,u},n.sample=function(){return e[~~(gr()*i)]+t*r.sample()},n.pdf=function(n){for(var a=0,o=0;o<i;++o)a+=r.pdf((n-e[o])/t);return a/t/i},n.cdf=function(n){for(var a=0,o=0;o<i;++o)a+=r.cdf((n-e[o])/t);return a/i},n.icdf=function(){throw Error("KDE icdf not supported.")},n.data(e)}function kr(e,t){var r,n={},i=0;return n.weights=function(e){return arguments.length?(r=function(e){var t,r=[],n=0;for(t=0;t<i;++t)n+=r[t]=null==e[t]?1:+e[t];for(t=0;t<i;++t)r[t]/=n;return r}(t=e||[]),n):t},n.distributions=function(r){return arguments.length?(r?(i=r.length,e=r):(i=0,e=[]),n.weights(t)):e},n.sample=function(){for(var t=gr(),n=e[i-1],a=r[0],o=0;o<i-1;a+=r[++o])if(t<a){n=e[o];break}return n.sample()},n.pdf=function(t){for(var n=0,a=0;a<i;++a)n+=r[a]*e[a].pdf(t);return n},n.cdf=function(t){for(var n=0,a=0;a<i;++a)n+=r[a]*e[a].cdf(t);return n},n.icdf=function(){throw Error("Mixture icdf not supported.")},n.distributions(e).weights(t)}function _r(e,t){null==t&&(t=null==e?1:e,e=0);var r,n,i,a={};return a.min=function(e){return arguments.length?(i=n-(r=e||0),a):r},a.max=function(e){return arguments.length?(i=(n=e||0)-r,a):n},a.sample=function(){return r+i*gr()},a.pdf=function(e){return e>=r&&e<=n?1/i:0},a.cdf=function(e){return e<r?0:e>n?1:(e-r)/i},a.icdf=function(e){return e>=0&&e<=1?r+e*i:NaN},a.min(e).max(t)}function Ar(e){this._key=e?C(e):Ue,this.reset()}var wr=Ar.prototype;function Fr(e){er.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}wr.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},wr.add=function(e){this._add.push(e)},wr.rem=function(e){this._rem.push(e)},wr.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,r,n=this._add,i=this._rem,a=this._key,o=n.length,s=i.length,u=Array(o-s),f={};for(e=0;e<s;++e)f[a(i[e])]=1;for(e=0,t=0;e<o;++e)f[a(r=n[e])]?f[a(r)]=0:u[t++]=r;return this._rem=[],this._add=u},wr.distinct=function(e){for(var t,r=this.values(),n=r.length,i={},a=0;--n>=0;)t=e(r[n])+"",i.hasOwnProperty(t)||(i[t]=1,++a);return a},wr.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),r=ye(t,e);this._ext=[t[r[0]],t[r[1]]],this._get=e}return this._ext},wr.argmin=function(e){return this.extent(e)[0]||{}},wr.argmax=function(e){return this.extent(e)[1]||{}},wr.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},wr.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},wr.quartile=function(e){return this._get===e&&this._q||(this._q=vr(this.values(),e),this._get=e),this._q},wr.q1=function(e){return this.quartile(e)[0]},wr.q2=function(e){return this.quartile(e)[1]},wr.q3=function(e){return this.quartile(e)[2]},wr.ci=function(e){return this._get===e&&this._ci||(this._ci=br(this.values(),1e3,.05,e),this._get=e),this._ci},wr.ci0=function(e){return this.ci(e)[0]},wr.ci1=function(e){return this.ci(e)[1]},Fr.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ur},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};var Dr=$e(Fr,er);function Cr(e){er.call(this,null,e)}Dr.transform=function(e,t){var r,n=this,i=t.fork(t.NO_SOURCE|t.NO_FIELDS);return this.stamp=i.stamp,this.value&&((r=e.modified())||t.modified(this._inputs))?(this._prev=this.value,this.value=r?this.init(e):{},t.visit(t.SOURCE,function(e){n.add(e)})):(this.value=this.value||this.init(e),t.visit(t.REM,function(e){n.rem(e)}),t.visit(t.ADD,function(e){n.add(e)})),i.modifies(this._outputs),n._drop=!1!==e.drop,e.cross&&n._dims.length>1&&(n._drop=!1,this.cross()),n.changes(i)},Dr.cross=function(){var e=this,t=e.value,r=e._dnames,n=r.map(function(){return{}}),i=r.length;function a(e){var t,a,o,s;for(t in e)for(o=e[t].tuple,a=0;a<i;++a)n[a][s=o[r[a]]]=s}a(e._prev),a(t),function a(o,s,u){var f,l,c=r[u],d=n[u++];for(f in d)s[c]=d[f],l=o?o+"|"+f:f,u<i?a(l,s,u):t[l]||e.cell(l,s)}("",{},0)},Dr.init=function(e){var t=this._inputs=[],r=this._outputs=[],n={};function i(e){for(var r,i=fe(x(e)),a=0,o=i.length;a<o;++a)n[r=i[a]]||(n[r]=1,t.push(r))}this._dims=fe(e.groupby),this._dnames=this._dims.map(function(e){var t=$(e);return i(e),r.push(t),t}),this.cellkey=e.key?e.key:ar(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var a,o,s,u,f,l,c=e.fields||[null],d=e.ops||["count"],p=e.as||[],m=c.length,h={};for(m!==d.length&&k("Unmatched number of fields and aggregate ops."),l=0;l<m;++l)a=c[l],o=d[l],null==a&&"count"!==o&&k("Null aggregate field specified."),f=or(o,u=$(a),p[l]),r.push(f),"count"!==o?((s=h[u])||(i(a),(s=h[u]=[]).field=a,this._measures.push(s)),"count"!==o&&(this._countOnly=!1),s.push(fr(o,f))):this._counts.push(f);return this._measures=this._measures.map(function(e){return dr(e,e.field)}),{}},Dr.cellkey=ar(),Dr.cell=function(e,t){var r=this.value[e];return r?0===r.num&&this._drop&&r.stamp<this.stamp?(r.stamp=this.stamp,this._adds[this._alen++]=r):r.stamp<this.stamp&&(r.stamp=this.stamp,this._mods[this._mlen++]=r):(r=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=r),r},Dr.newcell=function(e,t){var r={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var n,i=this._measures,a=i.length;for(r.agg=Array(a),n=0;n<a;++n)r.agg[n]=new i[n](r)}return r.store&&(r.data=new Ar),r},Dr.newtuple=function(e,t){var r,n,i=this._dnames,a=this._dims,o={};for(r=0,n=a.length;r<n;++r)o[i[r]]=a[r](e);return t?Je(t.tuple,o):Ge(o)},Dr.add=function(e){var t,r,n,i=this.cellkey(e),a=this.cell(i,e);if(a.num+=1,!this._countOnly)for(a.store&&a.data.add(e),r=0,n=(t=a.agg).length;r<n;++r)t[r].add(t[r].get(e),e)},Dr.rem=function(e){var t,r,n,i=this.cellkey(e),a=this.cell(i,e);if(a.num-=1,!this._countOnly)for(a.store&&a.data.rem(e),r=0,n=(t=a.agg).length;r<n;++r)t[r].rem(t[r].get(e),e)},Dr.celltuple=function(e){var t,r,n,i=e.tuple,a=this._counts;for(e.store&&e.data.values(),r=0,n=a.length;r<n;++r)i[a[r]]=e.num;if(!this._countOnly)for(r=0,n=(t=e.agg).length;r<n;++r)t[r].set(i);return i},Dr.changes=function(e){var t,r,n,i,a=this._adds,o=this._mods,s=this._prev,u=this._drop,f=e.add,l=e.rem,c=e.mod;if(s)for(r in s)t=s[r],u&&!t.num||l.push(t.tuple);for(n=0,i=this._alen;n<i;++n)f.push(this.celltuple(a[n])),a[n]=null;for(n=0,i=this._mlen;n<i;++n)(0===(t=o[n]).num&&u?l:c).push(this.celltuple(t)),o[n]=null;return this._alen=this._mlen=0,this._prev=null,e},Cr.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};var Er=$e(Cr,er);function Sr(e,t,r){var n=e,i=t||[],a=r||[],o={},s=0;return{add:function(e){a.push(e)},remove:function(e){o[n(e)]=++s},size:function(){return i.length},data:function(e,t){return s&&(i=i.filter(function(e){return!o[n(e)]}),o={},s=0),t&&e&&i.sort(e),a.length&&(i=e?De(e,i,a.sort(e)):i.concat(a),a=[]),i}}}function jr(e){er.call(this,[],e)}function Mr(e){nt.call(this,null,qr,e)}function qr(e){return this.value&&!e.modified()?this.value:de(e.fields,e.orders)}function Br(e){er.call(this,null,e)}Er.transform=function(e,t){var r,n=this._bins(e),i=n.start,a=n.step,o=e.as||["bin0","bin1"],s=o[0],u=o[1];return r=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(x(e.field))?t.ADD_MOD:t.ADD,t.visit(r,function(e){var t=n(e);e[s]=t,e[u]=null==t?null:i+a*(1+(t-i)/a)}),t.modifies(o)},Er._bins=function(e){if(this.value&&!e.modified())return this.value;var t,r,n=e.field,i=pr(e),a=i.start,o=i.stop,s=i.step;null!=(t=e.anchor)&&(r=t-(a+s*Math.floor((t-a)/s)),a+=r,o+=r);var u=function(e){var t=n(e);return null==t?null:(t=Math.max(a,Math.min(+t,o-s)),a+s*Math.floor((t-a)/s))};return u.start=a,u.stop=o,u.step=s,this.value=O(u,x(n),e.name||"bin_"+$(n))},jr.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},$e(jr,er).transform=function(e,t){var r=t.fork(t.ALL),n=Sr(Ue,this.value,r.materialize(r.ADD).add),i=e.sort,a=t.changed()||i&&(e.modified("sort")||t.modified(i.fields));return r.visit(r.REM,n.remove),this.modified(a),this.value=r.source=n.data(i,a),t.source&&t.source.root&&(this.value.root=t.source.root),r},$e(Mr,nt),Br.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};var Pr=$e(Br,er);function zr(e){er.call(this,null,e)}Pr.transform=function(e,t){function r(t){return function(r){for(var n,i=function(e,t,r){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(r)}(s(r),e.case,a)||[],u=0,f=i.length;u<f;++u)o.test(n=i[u])||t(n)}}var n=this._parameterCheck(e,t),i=this._counts,a=this._match,o=this._stop,s=e.field,u=e.as||["text","count"],f=r(function(e){i[e]=1+(i[e]||0)}),l=r(function(e){i[e]-=1});return n?t.visit(t.SOURCE,f):(t.visit(t.ADD,f),t.visit(t.REM,l)),this._finish(t,u)},Pr._parameterCheck=function(e,t){var r=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),r=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),r=!0),(e.modified("field")||t.modified(e.field.fields))&&(r=!0),r&&(this._counts={}),r},Pr._finish=function(e,t){var r,n,i,a=this._counts,o=this._tuples||(this._tuples={}),s=t[0],u=t[1],f=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(r in a)n=o[r],i=a[r]||0,!n&&i?(o[r]=n=Ge({}),n[s]=r,n[u]=i,f.add.push(n)):0===i?(n&&f.rem.push(n),a[r]=null,o[r]=null):n[u]!==i&&(n[u]=i,f.mod.push(n));return f.modifies(t)},zr.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},$e(zr,er).transform=function(e,t){var r=t.fork(t.NO_SOURCE),n=this.value,i=e.as||["a","b"],a=i[0],o=i[1];return!n||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter")?(n&&(r.rem=n),n=t.materialize(t.SOURCE).source,r.add=this.value=function(e,t,r,n){for(var i,a,o=[],s={},u=e.length,f=0;f<u;++f)for(s[t]=a=e[f],i=0;i<u;++i)s[r]=e[i],n(s)&&(o.push(Ge(s)),(s={})[t]=a);return o}(n,a,o,e.filter||B)):r.mod=n,r.source=this.value,r.modifies(i)};var Rr={kde:xr,mixture:kr,normal:$r,uniform:_r},Tr="distributions",Ir="function",Vr="field";function Lr(e){er.call(this,null,e)}var Nr=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Ur={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Nr},{name:"weights",type:"number",array:!0}]};function Wr(e){nt.call(this,null,Gr,e),this.modified(!0)}function Gr(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:O(function(r){return t(r,e)},x(t),$(t))}function Hr(e){er.call(this,[void 0,void 0],e)}function Xr(e,t){nt.call(this,e),this.parent=t}Lr.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number",default:100},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Nr.concat(Ur)},{name:"as",type:"string",array:!0,default:["value","density"]}]},$e(Lr,er).transform=function(e,t){var r=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var n=function e(t,r){var n=t[Ir];Rr.hasOwnProperty(n)||k("Unknown distribution function: "+n);var i=Rr[n]();for(var a in t)a===Vr?i.data((t.from||r()).map(t[a])):a===Tr?i[a](t[a].map(function(t){return e(t,r)})):typeof i[a]===Ir&&i[a](t[a]);return i}(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),i=e.method||"pdf";"pdf"!==i&&"cdf"!==i&&k("Invalid density method: "+i),e.extent||n.data||k("Missing density extent parameter."),i=n[i];var a=e.as||["value","density"],s=e.extent||Object(o.f)(n.data()),u=(s[1]-s[0])/(e.steps||100),f=Object(o.m)(s[0],s[1]+u/2,u).map(function(e){var t={};return t[a[0]]=e,t[a[1]]=i(e),Ge(t)});this.value&&(r.rem=this.value),this.value=r.add=r.source=f}return r},$e(Wr,nt),Hr.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},$e(Hr,er).transform=function(e,t){var r,n=this.value,i=e.field,a=n[0],o=n[1];((r=t.changed()||t.modified(i.fields)||e.modified("field"))||null==a)&&(a=1/0,o=-1/0),t.visit(r?t.SOURCE:t.ADD,function(e){var t=i(e);null!=t&&((t=+t)<a&&(a=t),t>o&&(o=t))}),isFinite(a)&&isFinite(o)||(a=o=void 0),this.value=[a,o]};var Jr=$e(Xr,nt);function Yr(e){er.call(this,{},e),this._keys=ve();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var r=0,n=t.active;r<n;++r)e(t[r],r,t)}}Jr.connect=function(e){return this.targets().add(e),e.source=this},Jr.add=function(e){this.value.add.push(e)},Jr.rem=function(e){this.value.rem.push(e)},Jr.mod=function(e){this.value.mod.push(e)},Jr.init=function(e){this.value.init(e,e.NO_SOURCE)},Jr.evaluate=function(){return this.value};var Kr=$e(Yr,er);function Qr(e){nt.call(this,null,Zr,e)}function Zr(e){return this.value&&!e.modified()?this.value:A(e.name)?fe(e.name).map(function(e){return C(e)}):C(e.name,e.as)}function en(e){er.call(this,ve(),e)}function tn(e,t){return e?e.map(function(e,r){return t[r]||$(e)}):null}function rn(e){er.call(this,[],e)}function nn(e){er.call(this,[],e)}function an(e){er.call(this,null,e)}function on(e){er.call(this,[],e)}Kr.activate=function(e){this._targets[this._targets.active++]=e},Kr.subflow=function(e,t,r,n){var i,a,o=this.value,s=o.hasOwnProperty(e)&&o[e];return s?s.value.stamp<r.stamp&&(s.init(r),this.activate(s)):(a=n||(a=this._group[e])&&a.tuple,s=(i=r.dataflow).add(new Xr(r.fork(r.NO_SOURCE),this)).connect(t(i,e,a)),o[e]=s,this.activate(s)),s},Kr.transform=function(e,t){var r=t.dataflow,n=this,i=e.key,a=e.subflow,o=this._keys,s=e.modified("key");function u(e){return n.subflow(e,a,t)}return this._group=e.group||{},this._targets.active=0,t.visit(t.REM,function(e){var t=Ue(e),r=o.get(t);void 0!==r&&(o.delete(t),u(r).rem(e))}),t.visit(t.ADD,function(e){var t=i(e);o.set(Ue(e),t),u(t).add(e)}),s||t.modified(i.fields)?t.visit(t.MOD,function(e){var t=Ue(e),r=o.get(t),n=i(e);r===n?u(n).mod(e):(o.set(t,n),u(r).rem(e),u(n).add(e))}):t.changed(t.MOD)&&t.visit(t.MOD,function(e){u(o.get(Ue(e))).mod(e)}),s&&t.visit(t.REFLOW,function(e){var t=Ue(e),r=o.get(t),n=i(e);r!==n&&(o.set(t,n),u(r).rem(e),u(n).add(e))}),o.empty>r.cleanThreshold&&r.runAfter(o.clean),t},$e(Qr,nt),en.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},$e(en,er).transform=function(e,t){var r=t.dataflow,n=this.value,i=t.fork(),a=i.add,o=i.rem,s=i.mod,u=e.expr,f=!0;function l(t){var r=Ue(t),i=u(t,e),l=n.get(r);i&&l?(n.delete(r),a.push(t)):i||l?f&&i&&!l&&s.push(t):(n.set(r,1),o.push(t))}return t.visit(t.REM,function(e){var t=Ue(e);n.has(t)?n.delete(t):o.push(e)}),t.visit(t.ADD,function(t){u(t,e)?a.push(t):n.set(Ue(t),1)}),t.visit(t.MOD,l),e.modified()&&(f=!1,t.visit(t.REFLOW,l)),n.empty>r.cleanThreshold&&r.runAfter(n.clean),i},rn.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0}]},$e(rn,er).transform=function(e,t){var r=t.fork(t.NO_SOURCE),n=e.fields,i=tn(n,e.as||[]),a=i.length;return r.rem=this.value,t.visit(t.SOURCE,function(e){for(var t,o,s,u=n.map(function(t){return t(e)}),f=u.reduce(function(e,t){return Math.max(e,t.length)},0),l=0;l<f;++l){for(o=He(e),t=0;t<a;++t)o[i[t]]=null==(s=u[t][l])?null:s;r.add.push(o)}}),this.value=r.source=r.add,r.modifies(i)},nn.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},$e(nn,er).transform=function(e,t){var r=t.fork(t.NO_SOURCE),n=e.fields,i=n.map($),a=e.as||["key","value"],o=a[0],s=a[1],u=n.length;return r.rem=this.value,t.visit(t.SOURCE,function(e){for(var t,a=0;a<u;++a)(t=He(e))[o]=i[a],t[s]=n[a](e),r.add.push(t)}),this.value=r.source=r.add,r.modifies(a)},an.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},$e(an,er).transform=function(e,t){var r=e.expr,n=e.as,i=e.modified(),a=e.initonly?t.ADD:i?t.SOURCE:t.modified(r.fields)?t.ADD_MOD:t.ADD;return i&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(n),t.visit(a,function(t){t[n]=r(t,e)})},$e(on,er).transform=function(e,t){var r,n,i,a=this.value,o=t.fork(t.ALL),s=e.size-a.length,u=e.generator;if(s>0){for(r=[];--s>=0;)r.push(i=Ge(u(e))),a.push(i);o.add=o.add.length?o.materialize(o.ADD).add.concat(r):r}else n=a.slice(0,-s),o.rem=o.rem.length?o.materialize(o.REM).rem.concat(n):n,a=a.slice(-s);return o.source=this.value=a,o};var sn={value:"value",median:o.i,mean:o.h,min:o.j,max:o.g},un=[];function fn(e){er.call(this,[],e)}function ln(e){Fr.call(this,e)}fn.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},$e(fn,er).transform=function(e,t){var r,n,i,a,o,s,u,f,l,c,d=t.fork(t.ALL),p=function(e){var t,r=e.method||sn.value;if(null!=sn[r])return r===sn.value?(t=void 0!==e.value?e.value:0,function(){return t}):sn[r];k("Unrecognized imputation method: "+r)}(e),m=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),h=$(e.field),g=$(e.key),y=(e.groupby||[]).map($),b=function(e,t,r,n){var i,a,o,s,u,f,l,c,d=function(e){return e(c)},p=[],m=n?n.slice():[],h={},g={};for(m.forEach(function(e,t){h[e]=t+1}),s=0,l=e.length;s<l;++s)c=e[s],f=r(c),u=h[f]||(h[f]=m.push(f)),a=(i=t?t.map(d):un)+"",(o=g[a])||(o=g[a]=[],p.push(o),o.values=i),o[u-1]=c;return p.domain=m,p}(t.source,e.groupby,e.key,e.keyvals),v=[],O=this.value,x=b.domain.length;for(o=0,f=b.length;o<f;++o)for(i=(r=b[o]).values,n=NaN,u=0;u<x;++u)if(null==r[u]){for(a=b.domain[u],c={_impute:!0},s=0,l=i.length;s<l;++s)c[y[s]]=i[s];c[g]=a,c[h]=isNaN(n)?n=p(r,m):n,v.push(Ge(c))}return v.length&&(d.add=d.materialize(d.ADD).add.concat(v)),O.length&&(d.rem=d.materialize(d.REM).rem.concat(O)),this.value=v,d},ln.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ur},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};var cn=$e(ln,Fr);function dn(e){nt.call(this,null,pn,e)}function pn(e){return this.value&&!e.modified()?this.value:Fe(e.fields,e.flat)}function mn(e){er.call(this,[],e)}function hn(e,t,r){r.forEach(Ge);const n=t.fork(t.NO_FIELDS&t.NO_SOURCE);return n.rem=e.value,e.value=n.add=n.source=r,n}function gn(e){er.call(this,{},e)}function yn(e){nt.call(this,null,bn,e)}function bn(e){if(this.value&&!e.modified())return this.value;var t,r,n,i=1/0,a=-1/0,o=e.extents;for(t=0,r=o.length;t<r;++t)(n=o[t])[0]<i&&(i=n[0]),n[1]>a&&(a=n[1]);return[i,a]}function vn(e){nt.call(this,null,On,e)}function On(e){return this.value&&!e.modified()?this.value:e.values.reduce(function(e,t){return e.concat(t)},[])}function $n(e){er.call(this,null,e)}function xn(e){Fr.call(this,e)}cn.transform=function(e,t){var r,n=this,i=e.modified();return n.value&&(i||t.modified(n._inputs))?(r=n.value=i?n.init(e):{},t.visit(t.SOURCE,function(e){n.add(e)})):(r=n.value=n.value||this.init(e),t.visit(t.REM,function(e){n.rem(e)}),t.visit(t.ADD,function(e){n.add(e)})),n.changes(),t.visit(t.SOURCE,function(e){he(e,r[n.cellkey(e)].tuple)}),t.reflow(i).modifies(this._outputs)},cn.changes=function(){var e,t,r=this._adds,n=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(r[e]),r[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(n[e]),n[e]=null;this._alen=this._mlen=0},$e(dn,nt),$e(mn,er).transform=function(e,t){const r=t.dataflow;return e.values?hn(this,t,r.parse(e.values,e.format)):r.request(e.url,e.format).then(e=>hn(this,t,e.data||[]))},gn.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},$e(gn,er).transform=function(e,t){var r,n,i=t,a=e.as,o=e.fields,s=e.index,u=e.values,f=null==e.default?null:e.default,l=e.modified(),c=l?t.SOURCE:t.ADD,d=o.length;return u?(n=u.length,d>1&&!a&&k('Multi-field lookup requires explicit "as" parameter.'),a&&a.length!==d*n&&k('The "as" parameter has too few output field names.'),a=a||u.map($),r=function(e){for(var t,r,i=0,l=0;i<d;++i)if(null==(r=s.get(o[i](e))))for(t=0;t<n;++t,++l)e[a[l]]=f;else for(t=0;t<n;++t,++l)e[a[l]]=u[t](r)}):(a||k("Missing output field names."),r=function(e){for(var t,r=0;r<d;++r)t=s.get(o[r](e)),e[a[r]]=null==t?f:t}),l?i=t.reflow(!0):c|=o.some(function(e){return t.modified(e.fields)})?t.MOD:0,t.visit(c,r),i.modifies(a)},$e(yn,nt),$e(vn,nt),$e($n,er),$n.prototype.transform=function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)},xn.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ur,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};var kn=$e(xn,Fr);function _n(e){Yr.call(this,e)}function An(e){er.call(this,null,e)}function wn(e){er.call(this,null,e)}function Fn(e){er.call(this,null,e)}function Dn(e){er.call(this,[],e),this.count=0}function Cn(e){er.call(this,null,e)}function En(e){er.call(this,null,e),this.modified(!0)}function Sn(e){er.call(this,ve(),e)}function jn(e){er.call(this,null,e)}kn._transform=kn.transform,kn.transform=function(e,t){return this._transform(function(e,t){var r=e.field,n=e.value,i=("count"===e.op?"__count__":e.op)||"sum",a=x(r).concat(x(n)),o=function(e,t,r){var n={},i=[];return r.visit(r.SOURCE,function(t){var r=e(t);n[r]||(n[r]=1,i.push(r))}),i.sort(function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0)}),t?i.slice(0,t):i}(r,e.limit||0,t);return{key:e.key,groupby:e.groupby,ops:o.map(function(){return i}),fields:o.map(function(e){return function(e,t,r,n){return O(function(n){return t(n)===e?r(n):NaN},n,e+"")}(e,r,n,a)}),as:o.map(function(e){return e+""}),modified:e.modified.bind(e)}}(e,t),t)},$e(_n,Yr).transform=function(e,t){var r=this,n=e.subflow,i=e.field;return(e.modified("field")||i&&t.modified(x(i)))&&k("PreFacet does not support field modification."),this._targets.active=0,t.visit(t.MOD,function(e){var a=r.subflow(Ue(e),n,t,e);i?i(e).forEach(function(e){a.mod(e)}):a.mod(e)}),t.visit(t.ADD,function(e){var a=r.subflow(Ue(e),n,t,e);i?i(e).forEach(function(e){a.add(Ge(e))}):a.add(e)}),t.visit(t.REM,function(e){var a=r.subflow(Ue(e),n,t,e);i?i(e).forEach(function(e){a.rem(e)}):a.rem(e)}),t},An.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},$e(An,er).transform=function(e,t){var r,n,i=e.fields,a=tn(e.fields,e.as||[]),o=i?function(e,t){return function(e,t,r,n){for(var i=0,a=r.length;i<a;++i)t[n[i]]=r[i](e);return t}(e,t,i,a)}:Xe;return this.value?n=this.value:(t=t.addAll(),n=this.value={}),r=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=Ue(e);r.rem.push(n[t]),n[t]=null}),t.visit(t.ADD,function(e){var t=o(e,Ge({}));n[Ue(e)]=t,r.add.push(t)}),t.visit(t.MOD,function(e){r.mod.push(o(e,n[Ue(e)]))}),r},$e(wn,er).transform=function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},$e(Fn,er).transform=function(e,t){var r,n;return this.value?n=this.value:(r=t=t.addAll(),n=this.value={}),e.derive&&(r=t.fork(t.NO_SOURCE),t.visit(t.REM,function(e){var t=Ue(e);r.rem.push(n[t]),n[t]=null}),t.visit(t.ADD,function(e){var t=He(e);n[Ue(e)]=t,r.add.push(t)}),t.visit(t.MOD,function(e){r.mod.push(Xe(e,n[Ue(e)]))})),r},Dn.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},$e(Dn,er).transform=function(e,t){var r=t.fork(t.NO_SOURCE),n=e.modified("size"),i=e.size,a=this.value,o=this.count,s=0,u=a.reduce(function(e,t){return e[Ue(t)]=1,e},{});function f(e){var t,n;a.length<i?a.push(e):(n=~~((o+1)*gr()))<a.length&&n>=s&&(t=a[n],u[Ue(t)]&&r.rem.push(t),a[n]=e),++o}if(t.rem.length&&(t.visit(t.REM,function(e){var t=Ue(e);u[t]&&(u[t]=-1,r.rem.push(e)),--o}),a=a.filter(function(e){return-1!==u[Ue(e)]})),(t.rem.length||n)&&a.length<i&&t.source&&(s=o=a.length,t.visit(t.SOURCE,function(e){u[Ue(e)]||f(e)}),s=-1),n&&a.length>i){for(var l=0,c=a.length-i;l<c;++l)u[Ue(a[l])]=-1,r.rem.push(a[l]);a=a.slice(c)}return t.mod.length&&t.visit(t.MOD,function(e){u[Ue(e)]&&r.mod.push(e)}),t.add.length&&t.visit(t.ADD,f),(t.add.length||s<0)&&(r.add=a.filter(function(e){return!u[Ue(e)]})),this.count=o,this.value=r.source=a,r},Cn.Definition={type:"Sequence",metadata:{changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},$e(Cn,er).transform=function(e,t){if(!this.value||e.modified()){var r=t.materialize().fork(t.MOD),n=e.as||"data";return r.rem=this.value?t.rem.concat(this.value):t.rem,this.value=Object(o.m)(e.start,e.stop,e.step||1).map(function(e){var t={};return t[n]=e,Ge(t)}),r.add=t.add.concat(this.value),r}},$e(En,er).transform=function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation},$e(Sn,er).transform=function(e,t){var r=t.dataflow,n=e.field,i=this.value,a=!0;function o(e){i.set(n(e),e)}return e.modified("field")||t.modified(n.fields)?(i.clear(),t.visit(t.SOURCE,o)):t.changed()?(t.visit(t.REM,function(e){i.delete(n(e))}),t.visit(t.ADD,o)):a=!1,this.modified(a),i.empty>r.cleanThreshold&&r.runAfter(i.clean),t.fork()},$e(jn,er).transform=function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(e.sort):t.source).map(e.field))};var Mn={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){e=1},next:function(t){var r=t.index,n=t.data;return r&&t.compare(n[r-1],n[r])?e=r+1:e}}},dense_rank:function(){var e;return{init:function(){e=1},next:function(t){var r=t.index,n=t.data;return r&&t.compare(n[r-1],n[r])?++e:e}}},percent_rank:function(){var e=Mn.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){e=0},next:function(t){var r=t.index,n=t.data,i=t.compare;if(e<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;e=r}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||k("ntile num must be greater than zero.");var r=Mn.cume_dist(),n=r.next;return{init:r.init,next:function(e){return Math.ceil(t*n(e))}}},lag:function(e,t){return t=+t||1,{next:function(r){var n=r.index-t;return n>=0?e(r.data[n]):null}}},lead:function(e,t){return t=+t||1,{next:function(r){var n=r.index+t,i=r.data;return n<i.length?e(i[n]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||k("nth_value nth must be greater than zero."),{next:function(r){var n=r.i0+(t-1);return n<r.i1?e(r.data[n]):null}}}},qn=Object.keys(Mn);function Bn(e){var t=fe(e.ops),r=fe(e.fields),n=fe(e.params),i=fe(e.as),a=this.outputs=[],o=this.windows=[],s={},u={},f=!0,l=[],c=[];function d(e){fe(x(e)).forEach(function(e){s[e]=1})}d(e.sort),t.forEach(function(e,t){var s=r[t],p=$(s),m=or(e,p,i[t]);if(d(s),a.push(m),Mn.hasOwnProperty(e))o.push(function(e,t,r,n){var i=Mn[e](t,r);return{init:i.init||M,update:function(e,t){t[n]=i.next(e)}}}(e,r[t],n[t],m));else{if(null==s&&"count"!==e&&k("Null aggregate field specified."),"count"===e)return void l.push(m);f=!1;var h=u[p];h||((h=u[p]=[]).field=s,c.push(h)),h.push(fr(e,m))}}),(l.length||c.length)&&(this.cell=function(e,t,r){e=e.map(function(e){return dr(e,e.field)});var n={num:0,agg:null,store:!1,count:t};if(!r)for(var i=e.length,a=n.agg=Array(i),o=0;o<i;++o)a[o]=new e[o](n);if(n.store)var s=n.data=new Ar;return n.add=function(e){if(n.num+=1,!r){s&&s.add(e);for(var t=0;t<i;++t)a[t].add(a[t].get(e),e)}},n.rem=function(e){if(n.num-=1,!r){s&&s.rem(e);for(var t=0;t<i;++t)a[t].rem(a[t].get(e),e)}},n.set=function(e){var i,o;for(s&&s.values(),i=0,o=t.length;i<o;++i)e[t[i]]=n.num;if(!r)for(i=0,o=a.length;i<o;++i)a[i].set(e)},n.init=function(){n.num=0,s&&s.reset();for(var e=0;e<i;++e)a[e].init()},n}(c,l,f)),this.inputs=Object.keys(s)}var Pn=Bn.prototype;function zn(e){er.call(this,{},e),this._mlen=0,this._mods=[]}Pn.init=function(){this.windows.forEach(function(e){e.init()}),this.cell&&this.cell.init()},Pn.update=function(e,t){var r,n=this.cell,i=this.windows,a=e.data,o=i&&i.length;if(n){for(r=e.p0;r<e.i0;++r)n.rem(a[r]);for(r=e.p1;r<e.i1;++r)n.add(a[r]);n.set(t)}for(r=0;r<o;++r)i[r].update(e,t)},zn.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:qn.concat(ur)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};var Rn=$e(zn,er);function Tn(e,t,r){var n=r.sort,i=n&&!r.ignorePeers,a=r.frame||[null,0],s=e.data(n),u=s.length,f=0,l=i?Object(o.e)(n):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:n||pe(-1)};for(t.init();f<u;++f)In(c,a,f,u),i&&Vn(c,l),t.update(c,s[f])}function In(e,t,r,n){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,r-Math.abs(t[0])),e.i1=null==t[1]?n:Math.min(n,r+Math.abs(t[1])+1),e.index=r}function Vn(e,t){var r=e.i0,n=e.i1-1,i=e.compare,a=e.data,o=a.length-1;r>0&&!i(a[r],a[r-1])&&(e.i0=t.left(a,a[r])),n<o&&!i(a[n],a[n+1])&&(e.i1=t.right(a,a[n]))}Rn.transform=function(e,t){var r,n,i=this,a=i.state,o=e.modified();this.stamp=t.stamp,a&&!o||(a=i.state=new Bn(e));var s=ar(e.groupby);function u(e){return i.group(s(e))}for(o||t.modified(a.inputs)?(i.value={},t.visit(t.SOURCE,function(e){u(e).add(e)})):(t.visit(t.REM,function(e){u(e).remove(e)}),t.visit(t.ADD,function(e){u(e).add(e)})),r=0,n=i._mlen;r<n;++r)Tn(i._mods[r],a,e);return i._mlen=0,i._mods=[],t.reflow(o).modifies(a.outputs)},Rn.group=function(e){var t=this.value[e];return t||((t=this.value[e]=Sr(Ue)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t};var Ln=Object.freeze({aggregate:Fr,bin:Cr,collect:jr,compare:Mr,countpattern:Br,cross:zr,density:Lr,expression:Wr,extent:Hr,facet:Yr,field:Qr,filter:en,flatten:rn,fold:nn,formula:an,generate:on,impute:fn,joinaggregate:ln,key:dn,load:mn,lookup:gn,multiextent:yn,multivalues:vn,params:$n,pivot:xn,prefacet:_n,project:An,proxy:wn,relay:Fn,sample:Dn,sequence:Cn,sieve:En,subflow:Xr,tupleindex:Sn,values:jn,window:zn}),Nn="top",Un="left",Wn="right",Gn="bottom",Hn="top-left",Xn="top-right",Jn="bottom-left",Yn="bottom-right",Kn="start",Qn="end",Zn="group",ei="axis",ti="title",ri="frame",ni="scope",ii="legend",ai="row-header",oi="row-footer",si="row-title",ui="column-header",fi="column-footer",li="column-title",ci="padding",di="symbol",pi="fit",mi="fit-x",hi="fit-y",gi="pad",yi="none",bi="all",vi="each",Oi="flush",$i="column",xi="row";function ki(e){this.clear(),e&&this.union(e)}var _i=ki.prototype;_i.clone=function(){return new ki(this)},_i.clear=function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},_i.empty=function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},_i.set=function(e,t,r,n){return r<e?(this.x2=e,this.x1=r):(this.x1=e,this.x2=r),n<t?(this.y2=t,this.y1=n):(this.y1=t,this.y2=n),this},_i.add=function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},_i.expand=function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},_i.round=function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},_i.translate=function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},_i.rotate=function(e,t,r){const n=this.rotatedPoints(e,t,r);return this.clear().add(n[0],n[1]).add(n[2],n[3]).add(n[4],n[5]).add(n[6],n[7])},_i.rotatedPoints=function(e,t,r){var{x1:n,y1:i,x2:a,y2:o}=this,s=Math.cos(e),u=Math.sin(e),f=t-t*s+r*u,l=r-t*u-r*s;return[s*n-u*i+f,u*n+s*i+l,s*n-u*o+f,u*n+s*o+l,s*a-u*i+f,u*a+s*i+l,s*a-u*o+f,u*a+s*o+l]},_i.union=function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},_i.intersect=function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},_i.encloses=function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},_i.alignsWith=function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},_i.intersects=function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},_i.contains=function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},_i.width=function(){return this.x2-this.x1},_i.height=function(){return this.y2-this.y1};var Ai=0;function wi(e,t){var r,n=[];return r={id:"gradient_"+Ai++,x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:n,stop:function(e,t){return n.push({offset:e,color:t}),r}}}function Fi(e){this.mark=e,this.bounds=this.bounds||new ki}function Di(e){Fi.call(this,e),this.items=this.items||[]}function Ci(e,t){if("undefined"!=typeof document&&document.createElement){var r=document.createElement("canvas");if(r&&r.getContext)return r.width=e,r.height=t,r}return null}function Ei(){return"undefined"!=typeof Image?Image:null}function Si(e){this._pending=0,this._loader=e||jt()}$e(Di,Fi);var ji=Si.prototype;function Mi(e){e._pending+=1}function qi(e){e._pending-=1}ji.pending=function(){return this._pending},ji.sanitizeURL=function(e){var t=this;return Mi(t),t._loader.sanitize(e,{context:"href"}).then(function(e){return qi(t),e}).catch(function(){return qi(t),null})},ji.loadImage=function(e){var t=this,r=Ei();return Mi(t),t._loader.sanitize(e,{context:"image"}).then(function(e){var n=e.href;if(!n||!r)throw{url:n};var i=new r;return i.onload=function(){qi(t),i.loaded=!0},i.onerror=function(){qi(t),i.loaded=!1},i.src=n,i}).catch(function(e){return qi(t),{loaded:!1,width:0,height:0,src:e&&e.url||""}})},ji.ready=function(){var e=this;return new Promise(function(t){!function r(n){e.pending()?setTimeout(function(){r(!0)},10):t(n)}(!1)})};var Bi={basis:{curve:s.c},"basis-closed":{curve:s.d},"basis-open":{curve:s.e},bundle:{curve:s.f,tension:"beta",value:.85},cardinal:{curve:s.g,tension:"tension",value:0},"cardinal-open":{curve:s.i,tension:"tension",value:0},"cardinal-closed":{curve:s.h,tension:"tension",value:0},"catmull-rom":{curve:s.j,tension:"alpha",value:.5},"catmull-rom-closed":{curve:s.k,tension:"alpha",value:.5},"catmull-rom-open":{curve:s.l,tension:"alpha",value:.5},linear:{curve:s.m},"linear-closed":{curve:s.n},monotone:{horizontal:s.p,vertical:s.o},natural:{curve:s.q},step:{curve:s.r},"step-after":{curve:s.s},"step-before":{curve:s.t}};function Pi(e,t,r){var n=Bi.hasOwnProperty(e)&&Bi[e],i=null;return n&&(i=n.curve||n[t||"vertical"],n.tension&&null!=r&&(i=i[n.tension](r))),i}var zi={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Ri=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\d)([-+])/g,/\s|,|###/];function Ti(e){var t,r,n,i,a,o,s,u,f,l,c,d=[];for(u=0,l=(t=e.slice().replace(Ri[0],"###$1").split(Ri[1]).slice(1)).length;u<l;++u){for(n=(r=t[u]).slice(1).trim().replace(Ri[2],"$1###$2").split(Ri[3]),i=[o=r.charAt(0)],f=0,c=n.length;f<c;++f)(a=+n[f])===a&&i.push(a);if(s=zi[o.toLowerCase()],i.length-1>s)for(f=1,c=i.length;f<c;f+=s)d.push([o].concat(i.slice(f,f+s)));else d.push(i)}return d}var Ii=Math.PI/180,Vi=Math.PI/2,Li=2*Math.PI,Ni=Math.sqrt(3)/2,Ui={},Wi={},Gi=[].join;function Hi(e){var t=Gi.call(e);if(Wi[t])return Wi[t];var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],s=e[5],u=e[6],f=e[7],l=f*o,c=-u*s,d=u*o,p=f*s,m=Math.cos(i),h=Math.sin(i),g=Math.cos(a),y=Math.sin(a),b=.5*(a-i),v=Math.sin(.5*b),O=8/3*v*v/Math.sin(b),$=r+m-O*h,x=n+h+O*m,k=r+g,_=n+y,A=k+O*y,w=_-O*g;return Wi[t]=[l*$+c*x,d*$+p*x,l*A+c*w,d*A+p*w,l*k+c*_,d*k+p*_]}var Xi=["l",0,0,0,0,0,0,0];function Ji(e,t){var r=Xi[0]=e[0];if("a"===r||"A"===r)Xi[1]=t*e[1],Xi[2]=t*e[2],Xi[3]=e[3],Xi[4]=e[4],Xi[5]=e[5],Xi[6]=t*e[6],Xi[7]=t*e[7];else for(var n=1,i=e.length;n<i;++n)Xi[n]=t*e[n];return Xi}function Yi(e,t,r,n,i){var a,o,s,u,f,l=null,c=0,d=0,p=0,m=0;null==r&&(r=0),null==n&&(n=0),null==i&&(i=1),e.beginPath&&e.beginPath();for(var h=0,g=t.length;h<g;++h){switch(a=t[h],1!==i&&(a=Ji(a,i)),a[0]){case"l":c+=a[1],d+=a[2],e.lineTo(c+r,d+n);break;case"L":c=a[1],d=a[2],e.lineTo(c+r,d+n);break;case"h":c+=a[1],e.lineTo(c+r,d+n);break;case"H":c=a[1],e.lineTo(c+r,d+n);break;case"v":d+=a[1],e.lineTo(c+r,d+n);break;case"V":d=a[1],e.lineTo(c+r,d+n);break;case"m":c+=a[1],d+=a[2],e.moveTo(c+r,d+n);break;case"M":c=a[1],d=a[2],e.moveTo(c+r,d+n);break;case"c":o=c+a[5],s=d+a[6],p=c+a[3],m=d+a[4],e.bezierCurveTo(c+a[1]+r,d+a[2]+n,p+r,m+n,o+r,s+n),c=o,d=s;break;case"C":c=a[5],d=a[6],p=a[3],m=a[4],e.bezierCurveTo(a[1]+r,a[2]+n,p+r,m+n,c+r,d+n);break;case"s":o=c+a[3],s=d+a[4],p=2*c-p,m=2*d-m,e.bezierCurveTo(p+r,m+n,c+a[1]+r,d+a[2]+n,o+r,s+n),p=c+a[1],m=d+a[2],c=o,d=s;break;case"S":o=a[3],s=a[4],p=2*c-p,m=2*d-m,e.bezierCurveTo(p+r,m+n,a[1]+r,a[2]+n,o+r,s+n),c=o,d=s,p=a[1],m=a[2];break;case"q":o=c+a[3],s=d+a[4],p=c+a[1],m=d+a[2],e.quadraticCurveTo(p+r,m+n,o+r,s+n),c=o,d=s;break;case"Q":o=a[3],s=a[4],e.quadraticCurveTo(a[1]+r,a[2]+n,o+r,s+n),c=o,d=s,p=a[1],m=a[2];break;case"t":o=c+a[1],s=d+a[2],null===l[0].match(/[QqTt]/)?(p=c,m=d):"t"===l[0]?(p=2*c-u,m=2*d-f):"q"===l[0]&&(p=2*c-p,m=2*d-m),u=p,f=m,e.quadraticCurveTo(p+r,m+n,o+r,s+n),d=s,p=(c=o)+a[1],m=d+a[2];break;case"T":o=a[1],s=a[2],p=2*c-p,m=2*d-m,e.quadraticCurveTo(p+r,m+n,o+r,s+n),c=o,d=s;break;case"a":Ki(e,c+r,d+n,[a[1],a[2],a[3],a[4],a[5],a[6]+c+r,a[7]+d+n]),c+=a[6],d+=a[7];break;case"A":Ki(e,c+r,d+n,[a[1],a[2],a[3],a[4],a[5],a[6]+r,a[7]+n]),c=a[6],d=a[7];break;case"z":case"Z":e.closePath()}l=a}}function Ki(e,t,r,n){for(var i=function(e,t,r,n,i,a,o,s,u){var f=Gi.call(arguments);if(Ui[f])return Ui[f];var l=o*Ii,c=Math.sin(l),d=Math.cos(l),p=d*(s-e)*.5+c*(u-t)*.5,m=d*(u-t)*.5-c*(s-e)*.5,h=p*p/((r=Math.abs(r))*r)+m*m/((n=Math.abs(n))*n);h>1&&(r*=h=Math.sqrt(h),n*=h);var g=d/r,y=c/r,b=-c/n,v=d/n,O=g*s+y*u,$=b*s+v*u,x=g*e+y*t,k=b*e+v*t,_=1/((x-O)*(x-O)+(k-$)*(k-$))-.25;_<0&&(_=0);var A=Math.sqrt(_);a==i&&(A=-A);var w=.5*(O+x)-A*(k-$),F=.5*($+k)+A*(x-O),D=Math.atan2($-F,O-w),C=Math.atan2(k-F,x-w)-D;C<0&&1===a?C+=Li:C>0&&0===a&&(C-=Li);for(var E=Math.ceil(Math.abs(C/(Vi+.001))),S=[],j=0;j<E;++j){var M=D+j*C/E,q=D+(j+1)*C/E;S[j]=[w,F,M,q,r,n,c,d]}return Ui[f]=S}(n[5],n[6],n[0],n[1],n[3],n[4],n[2],t,r),a=0;a<i.length;++a){var o=Hi(i[a]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var Qi={circle:{draw:function(e,t){var r=Math.sqrt(t)/2;e.moveTo(r,0),e.arc(0,0,r,0,Li)}},cross:{draw:function(e,t){var r=Math.sqrt(t)/2,n=r/2.5;e.moveTo(-r,-n),e.lineTo(-r,n),e.lineTo(-n,n),e.lineTo(-n,r),e.lineTo(n,r),e.lineTo(n,n),e.lineTo(r,n),e.lineTo(r,-n),e.lineTo(n,-n),e.lineTo(n,-r),e.lineTo(-n,-r),e.lineTo(-n,-n),e.closePath()}},diamond:{draw:function(e,t){var r=Math.sqrt(t)/2;e.moveTo(-r,0),e.lineTo(0,-r),e.lineTo(r,0),e.lineTo(0,r),e.closePath()}},square:{draw:function(e,t){var r=Math.sqrt(t),n=-r/2;e.rect(n,n,r,r)}},arrow:{draw:function(e,t){var r=Math.sqrt(t)/2,n=r/7,i=r/2.5,a=r/8;e.moveTo(-n,r),e.lineTo(n,r),e.lineTo(n,-a),e.lineTo(i,-a),e.lineTo(0,-r),e.lineTo(-i,-a),e.lineTo(-n,-a),e.closePath()}},wedge:{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r,i=n-.5773502691896257*r,a=r/4;e.moveTo(0,-n-i),e.lineTo(-a,n-i),e.lineTo(a,n-i),e.closePath()}},triangle:{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r,i=n-.5773502691896257*r;e.moveTo(0,-n-i),e.lineTo(-r,n-i),e.lineTo(r,n-i),e.closePath()}},"triangle-up":{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r;e.moveTo(0,-n),e.lineTo(-r,n),e.lineTo(r,n),e.closePath()}},"triangle-down":{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r;e.moveTo(0,n),e.lineTo(-r,-n),e.lineTo(r,-n),e.closePath()}},"triangle-right":{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r;e.moveTo(n,0),e.lineTo(-n,-r),e.lineTo(-n,r),e.closePath()}},"triangle-left":{draw:function(e,t){var r=Math.sqrt(t)/2,n=Ni*r;e.moveTo(-n,0),e.lineTo(n,-r),e.lineTo(n,r),e.closePath()}},stroke:{draw:function(e,t){var r=Math.sqrt(t)/2;e.moveTo(-r,0),e.lineTo(r,0)}}};function Zi(e){return Qi.hasOwnProperty(e)?Qi[e]:function(e){if(!ea.hasOwnProperty(e)){var t=Ti(e);ea[e]={draw:function(e,r){Yi(e,t,0,0,Math.sqrt(r)/2)}}}return ea[e]}(e)}var ea={};function ta(e){return e.x}function ra(e){return e.y}function na(e){return e.width}function ia(e){return e.height}function aa(e){return function(){return e}}function oa(){var e=ta,t=ra,r=na,n=ia,i=aa(0),a=null;function o(o,s,f){var l,c=null!=s?s:+e.call(this,o),d=null!=f?f:+t.call(this,o),p=+r.call(this,o),m=+n.call(this,o),h=+i.call(this,o);if(a||(a=l=Object(u.a)()),h<=0)a.rect(c,d,p,m);else{var g=c+p,y=d+m;a.moveTo(c+h,d),a.lineTo(g-h,d),a.quadraticCurveTo(g,d,g,d+h),a.lineTo(g,y-h),a.quadraticCurveTo(g,y,g-h,y),a.lineTo(c+h,y),a.quadraticCurveTo(c,y,c,y-h),a.lineTo(c,d+h),a.quadraticCurveTo(c,d,c+h,d),a.closePath()}if(l)return a=null,l+""||null}return o.x=function(t){return arguments.length?(e="function"==typeof t?t:aa(+t),o):e},o.y=function(e){return arguments.length?(t="function"==typeof e?e:aa(+e),o):t},o.width=function(e){return arguments.length?(r="function"==typeof e?e:aa(+e),o):r},o.height=function(e){return arguments.length?(n="function"==typeof e?e:aa(+e),o):n},o.cornerRadius=function(e){return arguments.length?(i="function"==typeof e?e:aa(+e),o):i},o.context=function(e){return arguments.length?(a=null==e?null:e,o):a},o}function sa(){var e,t,r,n,i,a,o,s,f=null;function l(e,t,r){var n=r/2;if(i){var u=o-t,l=e-a;if(u||l){var c=Math.sqrt(u*u+l*l),d=(u/=c)*s,p=(l/=c)*s,m=Math.atan2(l,u);f.moveTo(a-d,o-p),f.lineTo(e-u*n,t-l*n),f.arc(e,t,n,m-Math.PI,m),f.lineTo(a+d,o+p),f.arc(a,o,s,m,m+Math.PI)}else f.arc(e,t,n,0,Li);f.closePath()}else i=1;a=e,o=t,s=n}function c(a){var o,s,c,d=a.length,p=!1;for(null==f&&(f=c=Object(u.a)()),o=0;o<=d;++o)!(o<d&&n(s=a[o],o,a))===p&&(p=!p)&&(i=0),p&&l(+e(s,o,a),+t(s,o,a),+r(s,o,a));if(c)return f=null,c+""||null}return c.x=function(t){return arguments.length?(e=t,c):e},c.y=function(e){return arguments.length?(t=e,c):t},c.size=function(e){return arguments.length?(r=e,c):r},c.defined=function(e){return arguments.length?(n=e,c):n},c.context=function(e){return arguments.length?(f=null==e?null:e,c):f},c}function ua(e){return e.x||0}function fa(e){return e.y||0}function la(e){return e.cornerRadius||0}function ca(e){return!(!1===e.defined)}var da=Object(s.a)().startAngle(function(e){return e.startAngle||0}).endAngle(function(e){return e.endAngle||0}).padAngle(function(e){return e.padAngle||0}).innerRadius(function(e){return e.innerRadius||0}).outerRadius(function(e){return e.outerRadius||0}).cornerRadius(la),pa=Object(s.b)().x(ua).y1(fa).y0(function(e){return(e.y||0)+(e.height||0)}).defined(ca),ma=Object(s.b)().y(fa).x1(ua).x0(function(e){return(e.x||0)+(e.width||0)}).defined(ca),ha=Object(s.u)().x(ua).y(fa).defined(ca),ga=oa().x(ua).y(fa).width(function(e){return e.width||0}).height(function(e){return e.height||0}).cornerRadius(la),ya=Object(s.v)().type(function(e){return Zi(e.shape||"circle")}).size(function(e){return null==e.size?64:e.size}),ba=sa().x(ua).y(fa).defined(ca).size(function(e){return e.size||1});function va(e,t,r,n){return ga.context(e)(t,r,n)}function Oa(e,t){return t.stroke&&0!==t.opacity&&0!==t.strokeOpacity&&e.expand(null!=t.strokeWidth?+t.strokeWidth:1),e}var $a,xa=Li-1e-8;function ka(e){return $a=e,ka}function _a(){}function Aa(e,t){$a.add(e,t)}ka.beginPath=_a,ka.closePath=_a,ka.moveTo=Aa,ka.lineTo=Aa,ka.rect=function(e,t,r,n){Aa(e,t),Aa(e+r,t+n)},ka.quadraticCurveTo=function(e,t,r,n){Aa(e,t),Aa(r,n)},ka.bezierCurveTo=function(e,t,r,n,i,a){Aa(e,t),Aa(r,n),Aa(i,a)},ka.arc=function(e,t,r,n,i,a){if(Math.abs(i-n)>xa)return Aa(e-r,t-r),void Aa(e+r,t+r);var o,s,u,f,l=1/0,c=-1/0,d=1/0,p=-1/0;function m(e){u=r*Math.cos(e),f=r*Math.sin(e),u<l&&(l=u),u>c&&(c=u),f<d&&(d=f),f>p&&(p=f)}if(m(n),m(i),i!==n)if((n%=Li)<0&&(n+=Li),(i%=Li)<0&&(i+=Li),i<n&&(a=!a,o=n,n=i,i=o),a)for(i-=Li,o=n-n%Vi,s=0;s<4&&o>i;++s,o-=Vi)m(o);else for(o=n-n%Vi+Vi,s=0;s<4&&o<i;++s,o+=Vi)m(o);Aa(e+l,t+d),Aa(e+c,t+p)};var wa=(wa=Ci(1,1))?wa.getContext("2d"):null;const Fa=new ki;function Da(e){return function(t,r){if(!wa)return!0;e(wa,t),Fa.clear().union(t.bounds).intersect(r).round();const{x1:n,y1:i,x2:a,y2:o}=Fa;for(let e=i;e<=o;++e)for(let t=n;t<=a;++t)if(wa.isPointInPath(t,e))return!0;return!1}}function Ca(e,t){return t.contains(e.x||0,e.y||0)}function Ea(e,t){const r=e.x||0,n=e.y||0,i=e.width||0,a=e.height||0;return t.intersects(Fa.set(r,n,r+i,n+a))}function Sa(e,t){const r=e.x||0,n=e.y||0;return ja(t,r,n,null!=e.x2?e.x2:r,null!=e.y2?e.y2:n)}function ja(e,t,r,n,i){const{x1:a,y1:o,x2:s,y2:u}=e,f=n-t,l=i-r;let c,d,p,m,h=0,g=1;for(m=0;m<4;++m){if(0===m&&(c=-f,d=-(a-t)),1===m&&(c=f,d=s-t),2===m&&(c=-l,d=-(o-r)),3===m&&(c=l,d=u-r),Math.abs(c)<1e-10&&d<0)return!1;if(p=d/c,c<0){if(p>g)return!1;p>h&&(h=p)}else if(c>0){if(p<h)return!1;p<g&&(g=p)}}return!0}function Ma(e,t,r){return r.id?function(e,t,r){for(var n=r.width(),i=r.height(),a=r.x1+t.x1*n,o=r.y1+t.y1*i,s=r.x1+t.x2*n,u=r.y1+t.y2*i,f=t.stops,l=0,c=f.length,d=e.createLinearGradient(a,o,s,u);l<c;++l)d.addColorStop(f[l].offset,f[l].color);return d}(e,r,t.bounds):r}function qa(e,t,r){return(r*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=r,e.fillStyle=Ma(e,t,t.fill),!0)}var Ba=[];function Pa(e,t,r){var n=null!=(n=t.strokeWidth)?n:1;return!(n<=0)&&((r*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=r,e.strokeStyle=Ma(e,t,t.stroke),e.lineWidth=n,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||Ba),e.lineDashOffset=t.strokeDashOffset||0),!0))}function za(e,t){return e.zindex-t.zindex||e.index-t.index}function Ra(e){if(!e.zdirty)return e.zitems;var t,r,n,i=e.items,a=[];for(r=0,n=i.length;r<n;++r)(t=i[r]).index=r,t.zindex&&a.push(t);return e.zdirty=!1,e.zitems=a.sort(za)}function Ta(e,t){var r,n,i=e.items;if(i&&i.length){var a=Ra(e);if(a&&a.length){for(r=0,n=i.length;r<n;++r)i[r].zindex||t(i[r]);i=a}for(r=0,n=i.length;r<n;++r)t(i[r])}}function Ia(e,t){var r,n,i=e.items;if(!i||!i.length)return null;var a=Ra(e);for(a&&a.length&&(i=a),n=i.length;--n>=0;)if(r=t(i[n]))return r;if(i===a)for(n=(i=e.items).length;--n>=0;)if(!i[n].zindex&&(r=t(i[n])))return r;return null}function Va(e){return function(t,r,n){Ta(r,function(r){n&&!n.intersects(r.bounds)||La(e,t,r,r)})}}function La(e,t,r,n){var i=null==r.opacity?1:r.opacity;0!==i&&(e(t,n)||(r.fill&&qa(t,r,i)&&t.fill(),r.stroke&&Pa(t,r,i)&&t.stroke()))}function Na(e){return e=e||B,function(t,r,n,i,a,o){return n*=t.pixelRatio,i*=t.pixelRatio,Ia(r,function(r){var s=r.bounds;if((!s||s.contains(a,o))&&s)return e(t,r,n,i,a,o)?r:void 0})}}function Ua(e,t){return function(r,n,i,a){var o,s,u=Array.isArray(n)?n[0]:n,f=null==t?u.fill:t,l=u.stroke&&r.isPointInStroke;return l&&(o=u.strokeWidth,s=u.strokeCap,r.lineWidth=null!=o?o:1,r.lineCap=null!=s?s:"butt"),!e(r,n)&&(f&&r.isPointInPath(i,a)||l&&r.isPointInStroke(i,a))}}function Wa(e){return Na(Ua(e))}function Ga(e,t){return"translate("+e+","+t+")"}function Ha(e){return"rotate("+e+")"}function Xa(e){return Ga(e.x||0,e.y||0)}function Ja(e,t,r){function n(e,r){var n=r.x||0,i=r.y||0,a=r.angle||0;e.translate(n,i),a&&e.rotate(a*=Ii),e.beginPath(),t(e,r),a&&e.rotate(-a),e.translate(-n,-i)}return{type:e,tag:"path",nested:!1,attr:function(e,r){e("transform",function(e){return Ga(e.x||0,e.y||0)+(e.angle?" "+Ha(e.angle):"")}(r)),e("d",t(null,r))},bound:function(e,r){var n=r.x||0,i=r.y||0;return t(ka(e),r),Oa(e,r).translate(n,i),r.angle&&e.rotate(r.angle*Ii,n,i),e},draw:Va(n),pick:Wa(n),isect:r||Da(n)}}var Ya=Ja("arc",function(e,t){return da.context(e)(t)});function Ka(e,t,r){function n(e,r){e.beginPath(),t(e,r)}var i,a=Ua(n);return{type:e,tag:"path",nested:!0,attr:function(e,r){var n=r.mark.items;n.length&&e("d",t(null,n))},bound:function(e,r){var n=r.items;return 0===n.length?e:(t(ka(e),n),Oa(e,n[0]))},draw:(i=n,function(e,t,r){!t.items.length||r&&!r.intersects(t.bounds)||La(i,e,t.items[0],t.items)}),pick:function(e,t,r,n,i,o){var s=t.items,u=t.bounds;return!s||!s.length||u&&!u.contains(i,o)?null:(r*=e.pixelRatio,n*=e.pixelRatio,a(e,s,r,n)?s[0]:null)},isect:Ca,tip:r}}var Qa=Ka("area",function(e,t){var r=t[0],n=r.interpolate||"linear";return("horizontal"===r.orient?ma:pa).curve(Pi(n,r.orient,r.tension)).context(e)(t)},function(e,t){for(var r,n,i="horizontal"===e[0].orient?t[1]:t[0],a="horizontal"===e[0].orient?"y":"x",o=e.length,s=1/0;--o>=0;)!1!==e[o].defined&&(n=Math.abs(e[o][a]-i))<s&&(s=n,r=e[o]);return r}),Za=1;function eo(){Za=1}function to(e,t,r){var n=t.clip,i=e._defs,a=t.clip_id||(t.clip_id="clip"+Za++),o=i.clipping[a]||(i.clipping[a]={id:a});return ce(n)?o.path=n(null):(o.width=r.width||0,o.height=r.height||0),"url(#"+a+")"}var ro=.5;function no(e,t){var r=t.stroke?ro:0;e.beginPath(),va(e,t,r,r)}var io=Ua(no);var ao={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Xa(t))},bound:function(e,t){if(!t.clip&&t.items)for(var r=t.items,n=0,i=r.length;n<i;++n)e.union(r[n].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Oa(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,r){var n=this;Ta(t,function(t){var i,a=t.x||0,o=t.y||0,s=t.width||0,u=t.height||0;e.save(),e.translate(a,o),(t.stroke||t.fill)&&(i=null==t.opacity?1:t.opacity)>0&&(no(e,t),t.fill&&qa(e,t,i)&&e.fill(),t.stroke&&Pa(e,t,i)&&e.stroke()),t.clip&&(e.beginPath(),e.rect(0,0,s,u),e.clip()),r&&r.translate(-a,-o),Ta(t,function(t){n.draw(e,t,r)}),r&&r.translate(a,o),e.restore()})},pick:function(e,t,r,n,i,a){if(t.bounds&&!t.bounds.contains(i,a)||!t.items)return null;var o=this,s=r*e.pixelRatio,u=n*e.pixelRatio;return Ia(t,function(f){var l,c,d,p;if(!(p=f.bounds)||p.contains(i,a))return c=f.x||0,d=f.y||0,e.save(),e.translate(c,d),c=i-c,d=a-d,!(l=Ia(f,function(e){return function(e,t,r){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,r)}(e,c,d)?o.pick(e,r,n,c,d):null}))&&!1!==t.interactive&&(f.fill||f.stroke)&&io(e,f,s,u)&&(l=f),e.restore(),l||null})},isect:Ea,background:function(e,t){var r=t.stroke?ro:0;e("class","background"),e("d",va(null,t,r,r))},foreground:function(e,t,r){e("clip-path",t.clip?to(r,t,t):null)}};function oo(e,t){var r=e.image;return r&&r.url===e.url||(r={loaded:!1,width:0,height:0},t.loadImage(e.url).then(function(t){e.image=t,e.image.url=e.url})),r}function so(e,t){return"center"===e?t/2:"right"===e?t:0}function uo(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var fo={type:"image",tag:"image",nested:!1,attr:function(e,t,r){var n=oo(t,r),i=t.x||0,a=t.y||0,o=(null!=t.width?t.width:n.width)||0,s=(null!=t.height?t.height:n.height)||0,u=!1===t.aspect?"none":"xMidYMid";i-=so(t.align,o),a-=uo(t.baseline,s),e("href",n.src||"","http://www.w3.org/1999/xlink","xlink:href"),e("transform",Ga(i,a)),e("width",o),e("height",s),e("preserveAspectRatio",u)},bound:function(e,t){var r=t.image,n=t.x||0,i=t.y||0,a=(null!=t.width?t.width:r&&r.width)||0,o=(null!=t.height?t.height:r&&r.height)||0;return n-=so(t.align,a),i-=uo(t.baseline,o),e.set(n,i,n+a,i+o)},draw:function(e,t,r){var n=this;Ta(t,function(t){if(!r||r.intersects(t.bounds)){var i,a,o,s,u=oo(t,n),f=t.x||0,l=t.y||0,c=(null!=t.width?t.width:u.width)||0,d=(null!=t.height?t.height:u.height)||0;f-=so(t.align,c),l-=uo(t.baseline,d),!1!==t.aspect&&(a=u.width/u.height,o=t.width/t.height,a==a&&o==o&&a!==o&&(o<a?(l+=(d-(s=c/a))/2,d=s):(f+=(c-(s=d*a))/2,c=s))),u.loaded&&(e.globalAlpha=null!=(i=t.opacity)?i:1,e.drawImage(u,f,l,c,d))}})},pick:Na(),isect:B,get:oo,xOffset:so,yOffset:uo},lo=Ka("line",function(e,t){var r=t[0],n=r.interpolate||"linear";return ha.curve(Pi(n,r.orient,r.tension)).context(e)(t)},function(e,t){for(var r,n,i=Math.pow(e[0].strokeWidth||1,2),a=e.length;--a>=0;)if(!1!==e[a].defined&&(r=e[a].x-t[0])*r+(n=e[a].y-t[1])*n<i)return e[a];return null});function co(e,t){var r=t.path;if(null==r)return!0;var n=t.pathCache;n&&n.path===r||((t.pathCache=n=Ti(r)).path=r),Yi(e,n,t.x,t.y)}var po={type:"path",tag:"path",nested:!1,attr:function(e,t){e("transform",Xa(t)),e("d",t.path)},bound:function(e,t){return co(ka(e),t)?e.set(0,0,0,0):Oa(e,t)},draw:Va(co),pick:Wa(co),isect:Da(co)};function mo(e,t){e.beginPath(),va(e,t)}var ho={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",va(null,t))},bound:function(e,t){var r,n;return Oa(e.set(r=t.x||0,n=t.y||0,r+t.width||0,n+t.height||0),t)},draw:Va(mo),pick:Wa(mo),isect:Ea};function go(e,t,r){var n,i,a,o;return!(!t.stroke||!Pa(e,t,r))&&(n=t.x||0,i=t.y||0,a=null!=t.x2?t.x2:n,o=null!=t.y2?t.y2:i,e.beginPath(),e.moveTo(n,i),e.lineTo(a,o),!0)}var yo,bo={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Xa(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var r,n;return Oa(e.set(r=t.x||0,n=t.y||0,null!=t.x2?t.x2:r,null!=t.y2?t.y2:n),t)},draw:function(e,t,r){Ta(t,function(t){if(!r||r.intersects(t.bounds)){var n=null==t.opacity?1:t.opacity;n&&go(e,t,n)&&e.stroke()}})},pick:Na(function(e,t,r,n){return!!e.isPointInStroke&&go(e,t,1)&&e.isPointInStroke(r,n)}),isect:Sa},vo=Ja("shape",function(e,t){return(t.mark.shape||t.shape).context(e)(t)}),Oo=Ja("symbol",function(e,t){return ya.context(e)(t)},Ca),$o={height:wo,measureWidth:_o,estimateWidth:xo,width:xo,canvas:Fo};function xo(e){return yo=wo(e),ko(Do(e))}function ko(e){return~~(.8*e.length*yo)}function _o(e){return wo(e)<=0?0:(wa.font=Eo(e),Ao(Do(e)))}function Ao(e){return wa.measureText(e).width}function wo(e){return null!=e.fontSize?e.fontSize:11}function Fo(e){$o.width=e&&wa?_o:xo}function Do(e){var t=e.text;return null==t?"":e.limit>0?function(e){var t,r=+e.limit,n=e.text+"";$o.width===_o?(wa.font=Eo(e),t=Ao):(yo=wo(e),t=ko);if(t(n)<r)return n;var i,a=e.ellipsis||"…",o="rtl"===e.dir,s=0,u=n.length;if(r-=t(a),o){for(;s<u;)i=s+u>>>1,t(n.slice(i))>r?s=i+1:u=i;return a+n.slice(s)}for(;s<u;)i=1+(s+u>>>1),t(n.slice(0,i))<r?s=i:u=i-1;return n.slice(0,s)+a}(e):t+""}function Co(e,t){var r=e.font;return(t&&r?String(r).replace(/"/g,"'"):r)||"sans-serif"}function Eo(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+wo(e)+"px "+Co(e,t)}function So(e){var t=e.baseline,r=wo(e);return Math.round("top"===t?.79*r:"middle"===t?.3*r:"bottom"===t?-.21*r:0)}Fo(!0);var jo={left:"start",center:"middle",right:"end"},Mo=new ki;function qo(e){var t,r=e.x||0,n=e.y||0,i=e.radius||0;return i&&(t=(e.theta||0)-Vi,r+=i*Math.cos(t),n+=i*Math.sin(t)),Mo.x1=r,Mo.y1=n,Mo}function Bo(e,t,r){var n,i=$o.height(t),a=t.align,o=qo(t),s=o.x1,u=o.y1,f=t.dx||0,l=(t.dy||0)+So(t)-Math.round(.8*i);if(n=$o.width(t),"center"===a?f-=n/2:"right"===a&&(f-=n),e.set(f+=s,l+=u,f+n,l+i),t.angle&&!r)e.rotate(t.angle*Ii,s,u);else if(2===r)return e.rotatedPoints(t.angle*Ii,s,u);return e.expand(r||!n?0:1)}var Po={arc:Ya,area:Qa,group:ao,image:fo,line:lo,path:po,rect:ho,rule:bo,shape:vo,symbol:Oo,text:{type:"text",tag:"text",nested:!1,attr:function(e,t){var r,n=t.dx||0,i=(t.dy||0)+So(t),a=qo(t),o=a.x1,s=a.y1,u=t.angle||0;e("text-anchor",jo[t.align]||"start"),u?(r=Ga(o,s)+" "+Ha(u),(n||i)&&(r+=" "+Ga(n,i))):r=Ga(o+n,s+i),e("transform",r)},bound:Bo,draw:function(e,t,r){Ta(t,function(t){var n,i,a,o,s;r&&!r.intersects(t.bounds)||(s=Do(t))&&(0===(n=null==t.opacity?1:t.opacity)||t.fontSize<=0||(e.font=Eo(t),e.textAlign=t.align||"left",a=(i=qo(t)).x1,o=i.y1,t.angle&&(e.save(),e.translate(a,o),e.rotate(t.angle*Ii),a=o=0),a+=t.dx||0,o+=(t.dy||0)+So(t),t.fill&&qa(e,t,n)&&e.fillText(s,a,o),t.stroke&&Pa(e,t,n)&&e.strokeText(s,a,o),t.angle&&e.restore()))})},pick:Na(function(e,t,r,n,i,a){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=qo(t),s=o.x1,u=o.y1,f=Bo(Mo,t,1),l=-t.angle*Ii,c=Math.cos(l),d=Math.sin(l),p=c*i-d*a+(s-c*s+d*u),m=d*i+c*a+(u-d*s-c*u);return f.contains(p,m)}),isect:function(e,t){var r=Bo(Mo,e,2);return ja(t,r[0],r[1],r[2],r[3])||ja(t,r[0],r[1],r[4],r[5])||ja(t,r[4],r[5],r[6],r[7])||ja(t,r[2],r[3],r[6],r[7])}},trail:Ka("trail",function(e,t){return ba.context(e)(t)},function(e,t){for(var r,n,i=e.length;--i>=0;)if(!1!==e[i].defined&&(r=e[i].x-t[0])*r+(n=e[i].y-t[1])*n<(r=e[i].size||1)*r)return e[i];return null})};function zo(e,t,r){var n=Po[e.mark.marktype],i=t||n.bound;return n.nested&&(e=e.mark),i(e.bounds||(e.bounds=new ki),e,r)}var Ro={mark:null};function To(e,t,r){var n,i,a,o,s=Po[e.marktype],u=s.bound,f=e.items,l=f&&f.length;if(s.nested)return l?a=f[0]:(Ro.mark=e,a=Ro),o=zo(a,u,r),t=t&&t.union(o)||o;if(t=t||e.bounds&&e.bounds.clear()||new ki,l)for(n=0,i=f.length;n<i;++n)t.union(zo(f[n],u,r));return e.bounds=t}var Io=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","interpolate","tension","orient","defined","url","path","x2","y2","size","shape","text","angle","theta","radius","dx","dy","font","fontSize","fontWeight","fontStyle","fontVariant"];function Vo(e,t){return JSON.stringify(e,Io,t)}function Lo(e){return function e(t){var r,n,i,a=t.marktype,o=t.items;if(o)for(n=0,i=o.length;n<i;++n)r=a?"mark":"group",o[n][r]=t,o[n].zindex&&(o[n][r].zdirty=!0),"group"===(a||r)&&e(o[n]);a&&To(t);return t}("string"==typeof e?JSON.parse(e):e)}function No(e){arguments.length?this.root=Lo(e):(this.root=Wo({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Di(this.root)])}var Uo=No.prototype;function Wo(e,t){return{bounds:new ki,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0}}function Go(e,t,r){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?r?e.createElementNS(r,t):e.createElement(t):null}function Ho(e,t){t=t.toLowerCase();for(var r=e.childNodes,n=0,i=r.length;n<i;++n)if(r[n].tagName.toLowerCase()===t)return r[n]}function Xo(e,t,r,n){var i,a=e.childNodes[t];return a&&a.tagName.toLowerCase()===r.toLowerCase()||(i=a||null,a=Go(e.ownerDocument,r,n),e.insertBefore(a,i)),a}function Jo(e,t){for(var r=e.childNodes,n=r.length;n>t;)e.removeChild(r[--n]);return e}function Yo(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function Ko(e,t){var r=t.getBoundingClientRect();return[e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0)]}function Qo(e,t){this._active=null,this._handlers={},this._loader=e||jt(),this._tooltip=t||Zo}function Zo(e,t,r,n){e.element().setAttribute("title",n||"")}Uo.toJSON=function(e){return Vo(this.root,e||0)},Uo.mark=function(e,t,r){var n=Wo(e,t=t||this.root.items[0]);return t.items[r]=n,n.zindex&&(n.group.zdirty=!0),n};var es=Qo.prototype;function ts(e){this._el=null,this._bgcolor=null,this._loader=new Si(e)}es.initialize=function(e,t,r){return this._el=e,this._obj=r||null,this.origin(t)},es.element=function(){return this._el},es.canvas=function(){return this._el&&this._el.firstChild},es.origin=function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},es.scene=function(e){return arguments.length?(this._scene=e,this):this._scene},es.on=function(){},es.off=function(){},es._handlerIndex=function(e,t,r){for(var n=e?e.length:0;--n>=0;)if(e[n].type===t&&(!r||e[n].handler===r))return n;return-1},es.handlers=function(e){var t,r=this._handlers,n=[];if(e)n.push.apply(n,r[this.eventName(e)]);else for(t in r)n.push.apply(n,r[t]);return n},es.eventName=function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},es.handleHref=function(e,t,r){this._loader.sanitize(r,{context:"href"}).then(function(t){var r=new MouseEvent(e.type,e),n=Go(null,"a");for(var i in t)n.setAttribute(i,t[i]);n.dispatchEvent(r)}).catch(function(){})},es.handleTooltip=function(e,t,r){if(t&&null!=t.tooltip){t=function(e,t,r,n){var i,a,o=e&&e.mark;if(o&&(i=Po[o.marktype]).tip){for((a=Ko(t,r))[0]-=n[0],a[1]-=n[1];e=e.mark.group;)a[0]-=e.x||0,a[1]-=e.y||0;e=i.tip(o.items,a)}return e}(t,e,this.canvas(),this._origin);var n=r&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,n)}},es.getItemBoundingClientRect=function(e){if(t=this.canvas()){for(var t,r=t.getBoundingClientRect(),n=this._origin,i=e.bounds,a=i.x1+n[0]+r.left,o=i.y1+n[1]+r.top,s=i.width(),u=i.height();e.mark&&(e=e.mark.group);)a+=e.x||0,o+=e.y||0;return{x:a,y:o,width:s,height:u,left:a,top:o,right:a+s,bottom:o+u}}};var rs=ts.prototype;rs.initialize=function(e,t,r,n,i){return this._el=e,this.resize(t,r,n,i)},rs.element=function(){return this._el},rs.canvas=function(){return this._el&&this._el.firstChild},rs.background=function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},rs.resize=function(e,t,r,n){return this._width=e,this._height=t,this._origin=r||[0,0],this._scale=n||1,this},rs.dirty=function(){},rs.render=function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},rs._render=function(){},rs.renderAsync=function(e){var t=this.render(e);return this._ready?this._ready.then(function(){return t}):Promise.resolve(t)},rs._load=function(e,t){var r=this,n=r._loader[e](t);if(!r._ready){var i=r._call;r._ready=r._loader.ready().then(function(e){e&&i(),r._ready=null})}return n},rs.sanitizeURL=function(e){return this._load("sanitizeURL",e)},rs.loadImage=function(e){return this._load("loadImage",e)};var ns="mouseout";function is(e,t){Qo.call(this,e,t),this._down=null,this._touch=null,this._first=!0}var as=$e(is,Qo);function os(e,t,r){return function(n){var i=this._active,a=this.pickEvent(n);a===i?this.fire(e,n):(i&&i.exit||this.fire(r,n),this._active=a,this.fire(t,n),this.fire(e,n))}}function ss(e){return function(t){this.fire(e,t),this._active=null}}as.initialize=function(e,t,r){var n=this._canvas=e&&Ho(e,"canvas");if(n){var i=this;this.events.forEach(function(e){n.addEventListener(e,function(t){as[e]?as[e].call(i,t):i.fire(e,t)})})}return Qo.prototype.initialize.call(this,e,t,r)},as.canvas=function(){return this._canvas},as.context=function(){return this._canvas.getContext("2d")},as.events=["keydown","keypress","keyup","dragenter","dragleave","dragover","mousedown","mouseup","mousemove","mouseout","mouseover","click","dblclick","wheel","mousewheel","touchstart","touchmove","touchend"],as.DOMMouseScroll=function(e){this.fire("mousewheel",e)},as.mousemove=os("mousemove","mouseover","mouseout"),as.dragover=os("dragover","dragenter","dragleave"),as.mouseout=ss("mouseout"),as.dragleave=ss("dragleave"),as.mousedown=function(e){this._down=this._active,this.fire("mousedown",e)},as.click=function(e){this._down===this._active&&(this.fire("click",e),this._down=null)},as.touchstart=function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire("touchstart",e,!0)},as.touchmove=function(e){this.fire("touchmove",e,!0)},as.touchend=function(e){this.fire("touchend",e,!0),this._touch=null},as.fire=function(e,t,r){var n,i,a=r?this._touch:this._active,o=this._handlers[e];if(t.vegaType=e,"click"===e&&a&&a.href?this.handleHref(t,a,a.href):"mousemove"!==e&&e!==ns||this.handleTooltip(t,a,e!==ns),o)for(n=0,i=o.length;n<i;++n)o[n].handler.call(this._obj,t,a)},as.on=function(e,t){var r=this.eventName(e),n=this._handlers;return this._handlerIndex(n[r],e,t)<0&&(n[r]||(n[r]=[])).push({type:e,handler:t}),this},as.off=function(e,t){var r=this.eventName(e),n=this._handlers[r],i=this._handlerIndex(n,e,t);return i>=0&&n.splice(i,1),this},as.pickEvent=function(e){var t=Ko(e,this._canvas),r=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-r[0],t[1]-r[1])},as.pick=function(e,t,r,n,i){var a=this.context();return Po[e.marktype].pick.call(this,a,e,t,r,n,i)};var us="undefined"!=typeof window&&window.devicePixelRatio||1;function fs(e){ts.call(this,e),this._redraw=!1,this._dirty=new ki}var ls=$e(fs,ts),cs=ts.prototype,ds=new ki;function ps(e,t){Qo.call(this,e,t);var r=this;r._hrefHandler=hs(r,function(e,t){t&&t.href&&r.handleHref(e,t,t.href)}),r._tooltipHandler=hs(r,function(e,t){r.handleTooltip(e,t,e.type!==ns)})}ls.initialize=function(e,t,r,n,i,a){return this._options=a,this._canvas=Ci(1,1,a&&a.type),e&&(Jo(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),cs.initialize.call(this,e,t,r,n,i)},ls.resize=function(e,t,r,n){return cs.resize.call(this,e,t,r,n),function(e,t,r,n,i,a){var o,s="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),f=s?us:i;for(o in e.width=t*f,e.height=r*f,a)u[o]=a[o];s&&1!==f&&(e.style.width=t+"px",e.style.height=r+"px"),u.pixelRatio=f,u.setTransform(f,0,0,f,f*n[0],f*n[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options&&this._options.context),this._redraw=!0,this},ls.canvas=function(){return this._canvas},ls.context=function(){return this._canvas?this._canvas.getContext("2d"):null},ls.dirty=function(e){var t=function(e,t){if(null==t)return e;for(var r=ds.clear().union(e);null!=t;t=t.mark.group)r.translate(t.x||0,t.y||0);return r}(e.bounds,e.mark.group);this._dirty.union(t)},ls._render=function(e){var t=this.context(),r=this._origin,n=this._width,i=this._height,a=this._dirty;return t.save(),this._redraw||a.empty()?(this._redraw=!1,a=null):a=function(e,t,r){return t.expand(1).round(),t.translate(-r[0]%1,-r[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(t,a,r),this.clear(-r[0],-r[1],n,i),this.draw(t,e,a),t.restore(),this._dirty.clear(),this},ls.draw=function(e,t,r){var n=Po[t.marktype];t.clip&&function(e,t){var r=t.clip;if(e.save(),e.beginPath(),ce(r))r(e);else{var n=t.group;e.rect(0,0,n.width||0,n.height||0)}e.clip()}(e,t),n.draw.call(this,e,t,r),t.clip&&e.restore()},ls.clear=function(e,t,r,n){var i=this.context();i.clearRect(e,t,r,n),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,r,n))};var ms=$e(ps,Qo);function hs(e,t){return function(r){var n=r.target.__data__;r.vegaType=r.type,n=Array.isArray(n)?n[0]:n,t.call(e._obj,r,n)}}function gs(e,t,r){var n,i,a="<"+e;if(t)for(n in t)null!=(i=t[n])&&(a+=" "+n+'="'+i+'"');return r&&(a+=" "+r),a+">"}function ys(e){return"</"+e+">"}ms.initialize=function(e,t,r){var n=this._svg;return n&&(n.removeEventListener("click",this._hrefHandler),n.removeEventListener("mousemove",this._tooltipHandler),n.removeEventListener(ns,this._tooltipHandler)),this._svg=n=e&&Ho(e,"svg"),n&&(n.addEventListener("click",this._hrefHandler),n.addEventListener("mousemove",this._tooltipHandler),n.addEventListener(ns,this._tooltipHandler)),Qo.prototype.initialize.call(this,e,t,r)},ms.canvas=function(){return this._svg},ms.on=function(e,t){var r=this.eventName(e),n=this._handlers;if(this._handlerIndex(n[r],e,t)<0){var i={type:e,handler:t,listener:hs(this,t)};(n[r]||(n[r]=[])).push(i),this._svg&&this._svg.addEventListener(r,i.listener)}return this},ms.off=function(e,t){var r=this.eventName(e),n=this._handlers[r],i=this._handlerIndex(n,e,t);return i>=0&&(this._svg&&this._svg.removeEventListener(r,n[i].listener),n.splice(i,1)),this};var bs={version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},vs={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},Os=Object.keys(vs),$s=bs.xmlns;function xs(e){ts.call(this,e),this._dirtyID=1,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var ks=$e(xs,ts),_s=ts.prototype;function As(e,t,r){var n,i,a;for((e=Xo(e,r,"linearGradient",$s)).setAttribute("id",t.id),e.setAttribute("x1",t.x1),e.setAttribute("x2",t.x2),e.setAttribute("y1",t.y1),e.setAttribute("y2",t.y2),n=0,i=t.stops.length;n<i;++n)(a=Xo(e,n,"stop",$s)).setAttribute("offset",t.stops[n].offset),a.setAttribute("stop-color",t.stops[n].color);Jo(e,n)}function ws(e,t,r){var n;(e=Xo(e,r,"clipPath",$s)).setAttribute("id",t.id),t.path?(n=Xo(e,0,"path",$s)).setAttribute("d",t.path):((n=Xo(e,0,"rect",$s)).setAttribute("x",0),n.setAttribute("y",0),n.setAttribute("width",t.width),n.setAttribute("height",t.height))}function Fs(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function Ds(e,t,r,n,i){var a,o=e._svg;if(!o&&(o=Go(a=t.ownerDocument,n,$s),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===n))){var s=Go(a,"path",$s);s.setAttribute("class","background"),o.appendChild(s),s.__data__=e;var u=Go(a,"g",$s);o.appendChild(u),u.__data__=e}return(o.ownerSVGElement!==i||function(e){var t=e.mark||e.group;return t&&t.items.length>1}(e)&&o.previousSibling!==r)&&t.insertBefore(o,r?r.nextSibling:t.firstChild),o}ks.initialize=function(e,t,r,n){return e&&(this._svg=Xo(e,0,"svg",$s),this._svg.setAttribute("class","marks"),Jo(e,1),this._root=Xo(this._svg,0,"g",$s),Jo(this._svg,1)),this._defs={gradient:{},clipping:{}},this.background(this._bgcolor),_s.initialize.call(this,e,t,r,n)},ks.background=function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),_s.background.apply(this,arguments)},ks.resize=function(e,t,r,n){return _s.resize.call(this,e,t,r,n),this._svg&&(this._svg.setAttribute("width",this._width*this._scale),this._svg.setAttribute("height",this._height*this._scale),this._svg.setAttribute("viewBox","0 0 "+this._width+" "+this._height),this._root.setAttribute("transform","translate("+this._origin+")")),this._dirty=[],this},ks.canvas=function(){return this._svg},ks.svg=function(){if(!this._svg)return null;var e={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var t in bs)e[t]=bs[t];var r=this._bgcolor?gs("rect",{width:this._width,height:this._height,style:"fill: "+this._bgcolor+";"})+ys("rect"):"";return gs("svg",e)+r+this._svg.innerHTML+ys("svg")},ks._render=function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._resetDefs(),this.draw(this._root,e),Jo(this._root,1)),this.updateDefs(),this._dirty=[],++this._dirtyID,this},ks.updateDefs=function(){var e,t=this._svg,r=this._defs,n=r.el,i=0;for(e in r.gradient)n||(r.el=n=Xo(t,0,"defs",$s)),As(n,r.gradient[e],i++);for(e in r.clipping)n||(r.el=n=Xo(t,0,"defs",$s)),ws(n,r.clipping[e],i++);n&&(0===i?(t.removeChild(n),r.el=null):Jo(n,i))},ks._resetDefs=function(){var e=this._defs;e.gradient={},e.clipping={}},ks.dirty=function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},ks.isDirty=function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},ks._dirtyCheck=function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length)return!0;var t,r,n,i,a,o,s,u=++this._dirtyID;for(a=0,o=e.length;a<o;++a)(r=(t=e[a]).mark).marktype!==n&&(n=r.marktype,i=Po[n]),r.zdirty&&r.dirty!==u&&(this._dirtyAll=!1,Fs(t,u),r.items.forEach(function(e){e.dirty=u})),r.zdirty||(t.exit?(i.nested&&r.items.length?(s=r.items[0])._svg&&this._update(i,s._svg,s):t._svg&&(s=t._svg.parentNode)&&s.removeChild(t._svg),t._svg=null):(t=i.nested?r.items[0]:t)._update!==u&&(t._svg&&t._svg.ownerSVGElement?this._update(i,t._svg,t):(this._dirtyAll=!1,Fs(t,u)),t._update=u));return!this._dirtyAll},ks.draw=function(e,t,r){if(!this.isDirty(t))return t._svg;var n,i=this,a=this._svg,o=Po[t.marktype],s=!1===t.interactive?"none":null,u="g"===o.tag,f=null,l=0;function c(e){var t=i.isDirty(e),r=Ds(e,n,f,o.tag,a);t&&(i._update(o,r,e),u&&function(e,t,r){t=t.lastChild;var n,i=0;Ta(r,function(r){n=e.draw(t,r,n),++i}),Jo(t,1+i)}(i,r,e)),f=r,++l}return(n=Ds(t,e,r,"g",a)).setAttribute("class",Yo(t)),u||n.style.setProperty("pointer-events",s),t.clip?n.setAttribute("clip-path",to(i,t,t.group)):n.removeAttribute("clip-path"),o.nested?t.items.length&&c(t.items[0]):Ta(t,c),Jo(n,l),n};var Cs=null,Es=null,Ss={group:function(e,t,r){Es=t.__values__,Cs=t.childNodes[1],e.foreground(Ms,r,this),Cs=t.childNodes[0],e.background(Ms,r,this);var n=!1===r.mark.interactive?"none":null;n!==Es.events&&(Cs.style.setProperty("pointer-events",n),Es.events=n)},text:function(e,t,r){var n;(n=Do(r))!==Es.text&&(t.textContent=n,Es.text=n),js(t,"font-family",Co(r)),js(t,"font-size",wo(r)+"px"),js(t,"font-style",r.fontStyle),js(t,"font-variant",r.fontVariant),js(t,"font-weight",r.fontWeight)}};function js(e,t,r){r!==Es[t]&&(null==r?e.style.removeProperty(t):e.style.setProperty(t,r+""),Es[t]=r)}function Ms(e,t,r){t!==Es[e]&&(null!=t?r?Cs.setAttributeNS(r,e,t):Cs.setAttribute(e,t):r?Cs.removeAttributeNS(r,e):Cs.removeAttribute(e),Es[e]=t)}function qs(e){ts.call(this,e),this._text={head:"",bg:"",root:"",foot:"",defs:"",body:""},this._defs={gradient:{},clipping:{}}}ks._update=function(e,t,r){Cs=t,Es=t.__values__,e.attr(Ms,r,this);var n=Ss[e.type];n&&n.call(this,e,t,r),this.style(Cs,r)},ks.style=function(e,t){var r,n,i,a,o,s;if(null!=t)for(r=0,n=Os.length;r<n;++r)o=t[i=Os[r]],"font"===i&&(o=Co(t)),o!==Es[i]&&(a=vs[i],null==o?"fill"===a?e.style.setProperty(a,"none"):e.style.removeProperty(a):(o.id&&(this._defs.gradient[o.id]=o,o="url("+(s=void 0,"undefined"==typeof window?"":(s=window.location).hash?s.href.slice(0,-s.hash.length):s.href)+"#"+o.id+")"),e.style.setProperty(a,o+"")),Es[i]=o)};var Bs,Ps=$e(qs,ts),zs=ts.prototype;function Rs(e,t,r,n){Bs[n||e]=t}function Ts(e,t,r,n){if(null==e)return"";var i,a,o,s,u,f="";for("bgrect"===r&&!1===t.interactive&&(f+="pointer-events: none; "),"text"===r&&(f+="font-family: "+Co(e)+"; ",f+="font-size: "+wo(e)+"px; ",e.fontStyle&&(f+="font-style: "+e.fontStyle+"; "),e.fontVariant&&(f+="font-variant: "+e.fontVariant+"; "),e.fontWeight&&(f+="font-weight: "+e.fontWeight+"; ")),i=0,a=Os.length;i<a;++i)o=Os[i],s=vs[o],null==(u=e[o])?"fill"===s&&(f+="fill: none; "):"transparent"!==u||"fill"!==s&&"stroke"!==s?(u.id&&(n.gradient[u.id]=u,u="url(#"+u.id+")"),f+=s+": "+u+"; "):f+=s+": none; ";return f?'style="'+f.trim()+'"':null}Ps.resize=function(e,t,r,n){zs.resize.call(this,e,t,r,n);var i=this._origin,a=this._text,o={class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 "+this._width+" "+this._height};for(var s in bs)o[s]=bs[s];a.head=gs("svg",o);var u=this._bgcolor;return"transparent"!==u&&"none"!==u||(u=null),a.bg=u?gs("rect",{width:this._width,height:this._height,style:"fill: "+u+";"})+ys("rect"):"",a.root=gs("g",{transform:"translate("+i+")"}),a.foot=ys("g")+ys("svg"),this},Ps.background=function(){var e=zs.background.apply(this,arguments);return arguments.length&&this._text.head&&this.resize(this._width,this._height,this._origin,this._scale),e},Ps.svg=function(){var e=this._text;return e.head+e.bg+e.defs+e.root+e.body+e.foot},Ps._render=function(e){return this._text.body=this.mark(e),this._text.defs=this.buildDefs(),this},Ps.buildDefs=function(){var e,t,r,n,i=this._defs,a="";for(t in i.gradient){for(n=(r=i.gradient[t]).stops,a+=gs("linearGradient",{id:t,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2}),e=0;e<n.length;++e)a+=gs("stop",{offset:n[e].offset,"stop-color":n[e].color})+ys("stop");a+=ys("linearGradient")}for(t in i.clipping)r=i.clipping[t],a+=gs("clipPath",{id:t}),r.path?a+=gs("path",{d:r.path})+ys("path"):a+=gs("rect",{x:0,y:0,width:r.width,height:r.height})+ys("rect"),a+=ys("clipPath");return a.length>0?gs("defs")+a+ys("defs"):""},Ps.attributes=function(e,t){return Bs={},e(Rs,t,this),Bs},Ps.href=function(e){var t,r=this,n=e.href;if(n){if(t=r._hrefs&&r._hrefs[n])return t;r.sanitizeURL(n).then(function(e){e["xlink:href"]=e.href,e.href=null,(r._hrefs||(r._hrefs={}))[n]=e})}return null},Ps.mark=function(e){var t,r=this,n=Po[e.marktype],i=n.tag,a=this._defs,o="";function s(s){var u=r.href(s);u&&(o+=gs("a",u)),t="g"!==i?Ts(s,e,i,a):null,o+=gs(i,r.attributes(n.attr,s),t),"text"===i?o+=Do(s).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):"g"===i&&(o+=gs("path",r.attributes(n.background,s),Ts(s,e,"bgrect",a))+ys("path"),o+=gs("g",r.attributes(n.foreground,s))+r.markGroup(s)+ys("g")),o+=ys(i),u&&(o+=ys("a"))}return"g"!==i&&!1===e.interactive&&(t='style="pointer-events: none;"'),o+=gs("g",{class:Yo(e),"clip-path":e.clip?to(r,e,e.group):null},t),n.nested?e.items&&e.items.length&&s(e.items[0]):Ta(e,s),o+ys("g")},Ps.markGroup=function(e){var t=this,r="";return Ta(e,function(e){r+=t.mark(e)}),r};var Is={Canvas:"canvas",PNG:"png",SVG:"svg",None:"none"},Vs={};function Ls(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(Vs[e]=t,this):Vs[e]}function Ns(e,t,r){const n=[],i=(new ki).union(t),a=e.marktype;return a?Us(e,i,r,n):"group"===a?Ws(e,i,r,n):k("Intersect scene must be mark node or group item.")}function Us(e,t,r,n){if(function(e,t,r){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!r||r(e)))}(e,t,r)){const i=e.items,a=e.marktype,o=i.length;let s=0;if("group"===a)for(;s<o;++s)Ws(i[s],t,r,n);else for(const e=Po[a].isect;s<o;++s){let r=i[s];Gs(r,t,e)&&n.push(r)}}return n}function Ws(e,t,r,n){r&&r(e.mark)&&Gs(e,t,Po.group.isect)&&n.push(e);const i=e.items,a=i&&i.length;if(a){const o=e.x||0,s=e.y||0;t.translate(-o,-s);for(let e=0;e<a;++e)Us(i[e],t,r,n);t.translate(o,s)}return n}function Gs(e,t,r){const n=e.bounds;return t.encloses(n)||t.intersects(n)&&r(e,t)}Vs.canvas=Vs.png={renderer:fs,headless:fs,handler:is},Vs.svg={renderer:xs,headless:qs,handler:ps},Vs.none={};var Hs=new ki;function Xs(e){var t=e.clip;if(ce(t))t(ka(Hs.clear()));else{if(!t)return;Hs.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(Hs)}var Js=1e-9;function Ys(e,t,r){return e===t||("path"===r?Ks(e,t):e instanceof Date&&t instanceof Date?+e==+t:Ae(e)&&Ae(t)?Math.abs(e-t)<=Js:e&&t&&(w(e)||w(t))?null!=e&&null!=t&&function(e,t){var r,n,i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(i.sort(),a.sort(),n=i.length-1;n>=0;n--)if(i[n]!=a[n])return!1;for(n=i.length-1;n>=0;n--)if(r=i[n],!Ys(e[r],t[r],r))return!1;return typeof e==typeof t}(e,t):e==t)}function Ks(e,t){return Ys(Ti(e),Ti(t))}function Qs(e){er.call(this,null,e)}function Zs(e,t,r){return t(e.bounds.clear(),e,r)}$e(Qs,er).transform=function(e,t){var r,n=t.dataflow,i=e.mark,a=i.marktype,o=Po[a],s=o.bound,u=i.bounds;return o.nested?(i.items.length&&n.dirty(i.items[0]),u=Zs(i,s),i.items.forEach(function(e){e.bounds.clear().union(u)})):a===Zn||e.modified()?(t.visit(t.MOD,function(e){n.dirty(e)}),u.clear(),i.items.forEach(function(e){u.union(Zs(e,s))}),i.role===ii&&t.reflow()):(r=t.changed(t.REM),t.visit(t.ADD,function(e){u.union(Zs(e,s))}),t.visit(t.MOD,function(e){r=r||u.alignsWith(e.bounds),n.dirty(e),u.union(Zs(e,s))}),r&&(u.clear(),i.items.forEach(function(e){u.union(e.bounds)}))),Xs(i),t.modifies("bounds")};var eu=":vega_identifier:";function tu(e){er.call(this,0,e)}function ru(e){er.call(this,null,e)}function nu(e){er.call(this,null,e)}tu.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},$e(tu,er).transform=function(e,t){var r=function(e){var t=e._signals[eu];t||(e._signals[eu]=t=e.add(0));return t}(t.dataflow),n=r.value,i=e.as;return t.visit(t.ADD,function(e){e[i]||(e[i]=++n)}),r.set(this.value=n),t},$e(ru,er).transform=function(e,t){var r=this.value;r||((r=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,r=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&r?t.lookup(r):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=r.group),r.source=this,r.clip=e.clip,r.interactive=e.interactive,this.value=r);var n=r.marktype===Zn?Di:Fi;return t.visit(t.ADD,function(e){n.call(e,r)}),(e.modified("clip")||e.modified("interactive"))&&(r.clip=e.clip,r.interactive=!!e.interactive,r.zdirty=!0,t.reflow()),r.items=t.source,t};var iu=$e(nu,er),au={parity:function(e){return e.filter(function(e,t){return t%2?e.opacity=0:1})},greedy:function(e,t){var r;return e.filter(function(e,n){return n&&ou(r.bounds,e.bounds,t)?e.opacity=0:(r=e,1)})}};function ou(e,t,r){return r>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)}function su(e,t){for(var r,n=1,i=e.length,a=e[0].bounds;n<i;a=r,++n)if(ou(a,r=e[n].bounds,t))return!0}function uu(e){var t=e.bounds;return t.width()>1&&t.height()>1}function fu(e){return e.forEach(function(e){e.opacity=1}),e}function lu(e,t){return e.reflow(t.modified()).modifies("opacity")}function cu(e){er.call(this,null,e)}function du(e,t){for(var r=0,n=e.length;r<n;++r)t.push(e[r])}function pu(e){return{x1:0,y1:0,x2:e.width||0,y2:e.height||0}}function mu(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function hu(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function gu(e,t){return e.bounds[t]}function yu(e,t,r){var n=w(e)?e[t]:e;return null!=n?n:void 0!==r?r:0}function bu(e){return e<0?Math.ceil(-e):0}function vu(e,t,r){var n,i,a,o,s,u,f,l,c,d,p,m,h=function(e){for(var t,r,n=e.items,i=n.length,a=0,o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};a<i;++a)if(r=(t=n[a]).items,t.marktype===Zn)switch(t.role){case ei:case ii:break;case ai:du(r,o.rowheaders);break;case oi:du(r,o.rowfooters);break;case ui:du(r,o.colheaders);break;case fi:du(r,o.colfooters);break;case si:o.rowtitle=r[0];break;case li:o.coltitle=r[0];break;default:du(r,o.marks)}return o}(t),g=h.marks,y=r.bounds===Oi,b=y?pu:mu,v=new ki(0,0,0,0),O=yu(r.align,$i),$=yu(r.align,xi),x=yu(r.padding,$i),k=yu(r.padding,xi),_=r.offset,A=t.columns||r.columns||g.length,w=A<0?1:Math.ceil(g.length/A),F=w*A,D=[],C=[],E=0,S=[],j=[],M=0,q=g.length;for(i=0;i<A;++i)C[i]=0;for(i=0;i<w;++i)j[i]=0;for(i=0;i<q;++i)s=b(g[i]),a=i%A,o=~~(i/A),f=Math.ceil(b(g[i]).x2),l=Math.ceil(b(g[i]).y2),E=Math.max(E,f),M=Math.max(M,l),C[a]=Math.max(C[a],f),j[o]=Math.max(j[o],l),D.push(x+bu(s.x1)),S.push(k+bu(s.y1)),e.dirty(g[i]);for(i=0;i<q;++i)i%A==0&&(D[i]=0),i<A&&(S[i]=0);if(O===vi)for(a=1;a<A;++a){for(m=0,i=a;i<q;i+=A)m<D[i]&&(m=D[i]);for(i=a;i<q;i+=A)D[i]=m+C[a-1]}else if(O===bi){for(m=0,i=0;i<q;++i)i%A&&m<D[i]&&(m=D[i]);for(i=0;i<q;++i)i%A&&(D[i]=m+E)}else for(O=!1,a=1;a<A;++a)for(i=a;i<q;i+=A)D[i]+=C[a-1];if($===vi)for(o=1;o<w;++o){for(m=0,n=(i=o*A)+A;i<n;++i)m<S[i]&&(m=S[i]);for(i=o*A;i<n;++i)S[i]=m+j[o-1]}else if($===bi){for(m=0,i=A;i<q;++i)m<S[i]&&(m=S[i]);for(i=A;i<q;++i)S[i]=m+M}else for($=!1,o=1;o<w;++o)for(n=(i=o*A)+A;i<n;++i)S[i]+=j[o-1];for(c=0,i=0;i<q;++i)f=(u=g[i]).x||0,u.x=c=D[i]+(i%A?c:0),u.bounds.translate(c-f,0);for(a=0;a<A;++a)for(d=0,i=a;i<q;i+=A)l=(u=g[i]).y||0,u.y=d+=S[i],u.bounds.translate(0,d-l);if(yu(r.center,$i)&&w>1&&O)for(i=0;i<q;++i)u=g[i],(c=(s=O===bi?E:C[i%A])-b(u).x2)>0&&(u.x+=f=c/2,u.bounds.translate(f,0));if(yu(r.center,xi)&&1!==A&&$)for(i=0;i<q;++i)u=g[i],(d=(s=$===bi?M:j[~~(i/A)])-b(u).y2)>0&&(u.y+=l=d/2,u.bounds.translate(0,l));for(i=0;i<q;++i)g[i].mark.bounds.clear();for(i=0;i<q;++i)u=g[i],e.dirty(u),v.union(u.mark.bounds.union(u.bounds));function B(e,t){return Math.floor(Math.min(e,t))}function P(e,t){return Math.ceil(Math.max(e,t))}b=y?hu:gu,p=yu(r.headerBand,xi,null),c=Ou(e,h.rowheaders,g,A,w,-yu(_,"rowHeader"),B,0,b,"x1",0,A,1,p),p=yu(r.headerBand,$i,null),d=Ou(e,h.colheaders,g,A,A,-yu(_,"columnHeader"),B,1,b,"y1",0,1,A,p),p=yu(r.footerBand,xi,null),Ou(e,h.rowfooters,g,A,w,yu(_,"rowFooter"),P,0,b,"x2",A-1,A,1,p),p=yu(r.footerBand,$i,null),Ou(e,h.colfooters,g,A,A,yu(_,"columnFooter"),P,1,b,"y2",F-A,1,A,p),h.rowtitle&&(m=c-yu(_,"rowTitle"),p=yu(r.titleBand,xi,.5),$u(e,h.rowtitle,m,0,v,p)),h.coltitle&&(m=d-yu(_,"columnTitle"),p=yu(r.titleBand,$i,.5),$u(e,h.coltitle,m,1,v,p))}function Ou(e,t,r,n,i,a,o,s,u,f,l,c,d,p){var m,h,g,y,b,v,O,$,x,k=r.length,_=0,A=0;if(!k)return _;for(m=l;m<k;m+=c)r[m]&&(_=o(_,u(r[m],f)));if(!t.length)return _;for(t.length>i&&(e.warn("Grid headers exceed limit: "+i),t=t.slice(0,i)),_+=a,h=0,y=t.length;h<y;++h)e.dirty(t[h]),t[h].mark.bounds.clear();for(m=l,h=0,y=t.length;h<y;++h,m+=c){for(b=(v=t[h]).mark.bounds,g=m;g>=0&&null==(O=r[g]);g-=d);s?($=null==p?O.x:Math.round(O.bounds.x1+p*O.bounds.width()),x=_):($=_,x=null==p?O.y:Math.round(O.bounds.y1+p*O.bounds.height())),b.union(v.bounds.translate($-(v.x||0),x-(v.y||0))),v.x=$,v.y=x,e.dirty(v),A=o(A,b[f])}return A}function $u(e,t,r,n,i,a){if(t){e.dirty(t);var o=r,s=r;n?o=Math.round(i.x1+a*i.width()):s=Math.round(i.y1+a*i.height()),t.bounds.translate(o-(t.x||0),s-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=s,e.dirty(t)}}iu.transform=function(e,t){var r,n,i=au[e.method]||au.parity,a=t.materialize(t.SOURCE).source,o=e.separation||0;if(a){if(!e.method)return e.modified("method")&&(fu(a),t=lu(t,e)),t;if(e.sort&&(a=a.slice().sort(e.sort)),r=fu(a=a.filter(uu)),t=lu(t,e),r.length>=3&&su(r,o)){do{r=i(r,o)}while(r.length>=3&&su(r,o));r.length<3&&!U(a).opacity&&(r.length>1&&(U(r).opacity=0),U(a).opacity=1)}var s,u,f,l,c;return e.boundScale&&e.boundTolerance>=0&&(s=e.boundScale,u=e.boundOrient,f=+e.boundTolerance,l=s.range(),c=new ki,u===Nn||u===Gn?c.set(l[0],-1/0,l[1],1/0):c.set(-1/0,l[0],1/0,l[1]),c.expand(f||1),n=function(e){return c.encloses(e.bounds)},a.forEach(function(e){n(e)||(e.opacity=0)})),t}},$e(cu,er).transform=function(e,t){var r=t.dataflow;if(t.visit(t.ALL,function(e){r.dirty(e)}),t.fields&&t.fields.zindex){var n=t.source&&t.source[0];n&&(n.mark.zdirty=!0)}};var xu=.5,ku=new ki;function _u(e){er.call(this,null,e)}function Au(e,t,r){return e[t]===r?0:(e[t]=r,1)}function wu(e){var t=e.items[0].datum.orient;return t===Un||t===Wn}function Fu(e,t,r,n){var i,a,o=t.items[0],s=o.datum,u=s.orient,f=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(s),l=o.range,c=o.offset,d=o.position,p=o.minExtent,m=o.maxExtent,h=s.title&&o.items[f[2]].items[0],g=o.titlePadding,y=o.bounds,b=0,v=0;switch(ku.clear().union(y),y.clear(),(i=f[0])>-1&&y.union(o.items[i].bounds),(i=f[1])>-1&&y.union(o.items[i].bounds),u){case Nn:b=d||0,v=-c,a=Math.max(p,Math.min(m,-y.y1)),h&&(a=Du(h,a,g,0,-1,y)),y.add(0,-a).add(l,0);break;case Un:b=-c,v=d||0,a=Math.max(p,Math.min(m,-y.x1)),h&&(a=Du(h,a,g,1,-1,y)),y.add(-a,0).add(0,l);break;case Wn:b=r+c,v=d||0,a=Math.max(p,Math.min(m,y.x2)),h&&(a=Du(h,a,g,1,1,y)),y.add(0,0).add(a,l);break;case Gn:b=d||0,v=n+c,a=Math.max(p,Math.min(m,y.y2)),h&&(a=Du(h,a,g,0,1,y)),y.add(0,0).add(l,a);break;default:b=o.x,v=o.y}return Oa(y.translate(b,v),o),Au(o,"x",b+xu)|Au(o,"y",v+xu)&&(o.bounds=ku,e.dirty(o),o.bounds=y,e.dirty(o)),o.mark.bounds.clear().union(y)}function Du(e,t,r,n,i,a){var o=e.bounds,s=0,u=0;return e.auto?(t+=r,n?s=(e.x||0)-(e.x=i*t):u=(e.y||0)-(e.y=i*t),o.translate(-s,-u),e.mark.bounds.set(o.x1,o.y1,o.x2,o.y2),n?(a.add(0,o.y1).add(0,o.y2),t+=o.width()):(a.add(o.x1,0).add(o.x2,0),t+=o.height())):a.union(o),t}function Cu(e,t){return t.reduce(function(t,r){var n=r.items[0];if(function(e,t,r){var n=t.padding-r.x,i=t.padding-r.y;if(t.datum.title){var a=t.items[1].items[0];i+=t.titlePadding+a.fontSize}(n||i)&&(r.x+=n,r.y+=i,r.bounds.translate(n,i),r.mark.bounds.translate(n,i),e.dirty(r))}(e,n,n.items[0].items[0]),n.datum.orient===Un){var i=ku.clear();n.items.forEach(function(e){i.union(e.bounds)}),t=Math.max(t,Math.ceil(i.width()+2*n.padding-1))}return t},0)}function Eu(e,t,r,n,i,a,o){var s,u,f,l,c,d=t.items[0],p=d.datum,m=p.orient,h=d.offset,g=d.bounds,y=0,b=0;switch(m===Nn||m===Gn?(f=i,y=r[m]):m!==Un&&m!==Wn||(f=n,b=r[m]),ku.clear().union(g),g.clear(),d.items.forEach(function(e){g.union(e.bounds)}),s=2*d.padding-1,u=2*d.padding-1,g.empty()||(s=Math.ceil(g.width()+s),u=Math.ceil(g.height()+u)),p.type===di&&(l=d.items[0].items[0].items[0].items,c=l.reduce(function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e},{}),l.forEach(function(e){e.width=c[e.column],e.height=e.bounds.y2-e.y})),m){case Un:y-=r.leftWidth+h-Math.floor(f.x1),r.left+=u+r.margin;break;case Wn:y+=h+Math.ceil(f.x2),r.right+=u+r.margin;break;case Nn:b-=u+h-Math.floor(f.y1),r.top+=s+r.margin;break;case Gn:b+=h+Math.ceil(f.y2),r.bottom+=s+r.margin;break;case Hn:y+=h,b+=h;break;case Xn:y+=a-s-h,b+=h;break;case Jn:y+=h,b+=o-u-h;break;case Yn:y+=a-s-h,b+=o-u-h;break;default:y=d.x,b=d.y}return Oa(g.set(y,b,y+s,b+u),d),Au(d,"x",y)|Au(d,"width",s)|Au(d,"y",b)|Au(d,"height",u)&&(d.bounds=ku,e.dirty(d),d.bounds=g,e.dirty(d)),d.mark.bounds.clear().union(g)}$e(_u,er).transform=function(e,t){var r=t.dataflow;return e.mark.items.forEach(function(t){e.layout&&vu(r,t,e.layout),function(e,t,r){var n,i,a,o,s,u,f=t.items,l=Math.max(0,t.width||0),c=Math.max(0,t.height||0),d=(new ki).set(0,0,l,c),p=d.clone(),m=d.clone(),h=[];for(s=0,u=f.length;s<u;++s)switch((i=f[s]).role){case ei:(o=wu(i)?p:m).union(Fu(e,i,l,c));break;case ti:n=i;break;case ii:h.push(i);break;case ri:case ni:case ai:case oi:case si:case ui:case fi:case li:p.union(i.bounds),m.union(i.bounds);break;default:d.union(i.bounds)}if(h.length)for(a={leftWidth:Cu(e,h),margin:r.legendMargin||8,left:0,right:0,top:0,bottom:0},s=0,u=h.length;s<u;++s)if(o=Eu(e,h[s],a,p,m,l,c),r.autosize&&r.autosize.type===pi){var g=h[s].items[0].datum.orient;g===Un||g===Wn?d.add(o.x1,0).add(o.x2,0):g!==Nn&&g!==Gn||d.add(0,o.y1).add(0,o.y2)}else d.union(o);d.union(p).union(m),n&&d.union(function(e,t,r,n,i){var a,o=t.items[0],s=o.orient,u=o.frame,f=o.anchor,l=o.offset,c=o.bounds,d=0,p=s===Un||s===Wn?n:r,m=0,h=0;u!==Zn?s===Un?(d=i.y2,p=i.y1):s===Wn?(d=i.y1,p=i.y2):(d=i.x1,p=i.x2):s===Un&&(d=n,p=0);switch(a=f===Kn?d:f===Qn?p:(d+p)/2,ku.clear().union(c),s){case Nn:m=a,h=i.y1-l;break;case Un:m=i.x1-l,h=a;break;case Wn:m=i.x2+l,h=a;break;case Gn:m=a,h=i.y2+l;break;default:m=o.x,h=o.y}c.translate(m-o.x,h-o.y),Au(o,"x",m)|Au(o,"y",h)&&(o.bounds=ku,e.dirty(o),o.bounds=c,e.dirty(o));return t.bounds.clear().union(c)}(e,n,l,c,d));!function(e,t,r,n){var i=n.autosize||{},a=i.type,o=e._width,s=e._height,u=e.padding();if(e._autosize<1||!a)return;var f=Math.max(0,t.width||0),l=Math.max(0,Math.ceil(-r.x1)),c=Math.max(0,Math.ceil(r.x2-f)),d=Math.max(0,t.height||0),p=Math.max(0,Math.ceil(-r.y1)),m=Math.max(0,Math.ceil(r.y2-d));i.contains===ci&&(o-=u.left+u.right,s-=u.top+u.bottom);a===yi?(l=0,p=0,f=o,d=s):a===pi?(f=Math.max(0,o-l-c),d=Math.max(0,s-p-m)):a===mi?(f=Math.max(0,o-l-c),s=d+p+m):a===hi?(o=f+l+c,d=Math.max(0,s-p-m)):a===gi&&(o=f+l+c,s=d+p+m);e._resizeView(o,s,f,d,[l,p],i.resize)}(e,t,d,r)}(r,t,e)}),e.modified()&&t.reflow(),t};var Su=Object.freeze({bound:Qs,identifier:tu,mark:ru,overlap:nu,render:cu,viewlayout:_u});function ju(e,t,r){var n=e-t+2*r;return e?n>0?n:1:0}const Mu="identity",qu="linear",Bu="log",Pu="pow",zu="sqrt",Ru="symlog",Tu="time",Iu="utc",Vu="sequential",Lu="diverging",Nu="quantile",Uu="quantize",Wu="threshold",Gu="ordinal",Hu="point",Xu="band",Ju="bin-ordinal";function Yu(e){return e===Ju}function Ku(e){return e===Nu}function Qu(e){return function(e){return e&&e.startsWith(Vu)}(e)||function(e){return e&&e.startsWith(Lu)}(e)}function Zu(e){return e===Bu||e.endsWith("-log")}function ef(e){switch(e){case qu:case Bu:case Pu:case zu:case Ru:case Tu:case Iu:case Vu:return!0}return!1}function tf(e){return Yu(e)||e===Gu||e===Xu||e===Hu}function rf(e){return Yu(e)||e===Nu||e===Uu||e===Wu}var nf={millisecond:f.c,second:f.g,minute:f.d,hour:f.b,day:f.a,week:f.j,month:f.f,year:f.k},af={millisecond:f.n,second:f.r,minute:f.o,hour:f.m,day:f.l,week:f.u,month:f.q,year:f.v};function of(e,t){const r=t===Iu?af:nf;return r.hasOwnProperty(e)&&r[e]}function sf(){var e,t,r=Object(l.j)().unknown(void 0),n=r.domain,i=r.range,a=[0,1],s=!1,u=0,f=0,c=.5;function d(){var r=n().length,l=a[1]<a[0],d=a[l-0],p=a[1-l],m=ju(r,u,f);e=(p-d)/(m||1),s&&(e=Math.floor(e)),d+=(p-d-e*(r-u))*c,t=e*(1-u),s&&(d=Math.round(d),t=Math.round(t));var h=Object(o.m)(r).map(function(t){return d+e*t});return i(l?h.reverse():h)}return delete r.unknown,r.domain=function(e){return arguments.length?(n(e),d()):n()},r.range=function(e){return arguments.length?(a=[+e[0],+e[1]],d()):a.slice()},r.rangeRound=function(e){return a=[+e[0],+e[1]],s=!0,d()},r.bandwidth=function(){return t},r.step=function(){return e},r.round=function(e){return arguments.length?(s=!!e,d()):s},r.padding=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),u=f,d()):u},r.paddingInner=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},r.paddingOuter=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),d()):f},r.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),d()):c},r.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var r,s,u,f=+e[0],l=+e[1],c=a[1]<a[0],d=c?i().reverse():i(),p=d.length-1;if(f==f&&l==l&&(l<f&&(u=f,f=l,l=u),!(l<d[0]||f>a[1-c])))return r=Math.max(0,Object(o.d)(d,f)-1),s=f===l?r:Object(o.d)(d,l)-1,f-d[r]>t+1e-10&&++r,c&&(u=r,r=p-s,s=p-u),r>s?void 0:n().slice(r,s+1)}},r.invert=function(e){var t=r.invertRange([e,e]);return t?t[0]:t},r.copy=function(){return sf().domain(n()).range(a).round(s).paddingInner(u).paddingOuter(f).align(c)},d()}var uf=Array.prototype.map;var ff=Array.prototype.slice;function lf(e,t){return arguments.length>1?(cf[e]=function(e,t){return function(){var r=t();return r.invertRange||(r.invertRange=r.invert?function(e){return function(t){var r,n=t[0],i=t[1];return i<n&&(r=n,n=i,i=r),[e.invert(n),e.invert(i)]}}(r):r.invertExtent?function(e){return function(t){var r,n,i,a,o=e.range(),s=t[0],u=t[1],f=-1;for(u<s&&(n=s,s=u,u=n),i=0,a=o.length;i<a;++i)o[i]>=s&&o[i]<=u&&(f<0&&(f=i),r=i);if(!(f<0))return s=e.invertExtent(o[f]),u=e.invertExtent(o[r]),[void 0===s[0]?s[1]:s[0],void 0===u[1]?u[0]:u[1]]}}(r):void 0),r.type=e,r}}(e,t),this):cf.hasOwnProperty(e)?cf[e]:void 0}var cf={[Mu]:l.f,[qu]:l.h,[Bu]:l.i,[Pu]:l.k,[zu]:l.s,[Ru]:l.t,[Tu]:l.v,[Iu]:l.w,[Vu]:l.n,[Vu+"-"+qu]:l.n,[Vu+"-"+Bu]:l.o,[Vu+"-"+Pu]:l.p,[Vu+"-"+zu]:l.q,[Vu+"-"+Ru]:l.r,[Lu+"-"+qu]:l.a,[Lu+"-"+Bu]:l.b,[Lu+"-"+Pu]:l.c,[Lu+"-"+zu]:l.d,[Lu+"-"+Ru]:l.e,[Nu]:l.l,[Uu]:l.m,[Wu]:l.u,[Ju]:function e(){var t=[],r=[];function n(e){return null==e||e!=e?void 0:r[(Object(o.b)(t,e)-1)%r.length]}return n.domain=function(e){return arguments.length?(t=function(e){return uf.call(e,function(e){return+e})}(e),n):t.slice()},n.range=function(e){return arguments.length?(r=ff.call(e),n):r.slice()},n.tickFormat=function(e,r){return Object(l.x)(t[0],U(t),null==e?10:e,r)},n.copy=function(){return e().domain(n.domain()).range(n.range())},n},[Gu]:l.j,[Xu]:sf,[Hu]:function(){return function e(t){var r=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return e(r())},t}(sf().paddingInner(1))}};for(var df in cf)lf(df,cf[df]);const pf=["clamp","base","constant","exponent"];function mf(e,t){var r=t[0],n=U(t)-r;return function(t){return e(r+t*n)}}function hf(e,t,r){return Object(c.piecewise)(bf(t||"rgb",r),e)}function gf(e,t){for(var r=new Array(t),n=t+1,i=0;i<t;)r[i]=e(++i/n);return r}function yf(e,t,r){var n,i,a,o=r-t;return o&&isFinite(o)?(n=(i=e.type).indexOf("-"),i=n<0?i:i.slice(n+1),a=lf(i)().domain([t,r]).range([0,1]),pf.forEach(t=>e[t]?a[t](e[t]()):0),a):pe(.5)}function bf(e,t){var r=c[function(e){return"interpolate"+e.toLowerCase().split("-").map(function(e){return e[0].toUpperCase()+e.slice(1)}).join("")}(e)];return null!=t&&r&&r.gamma?r.gamma(t):r}function vf(e){for(var t=e.length/6|0,r=new Array(t),n=0;n<t;)r[n]="#"+e.slice(6*n,6*++n);return r}function Of(e,t){for(let r in e)xf(r,t(e[r]))}const $f={};function xf(e,t){return e=e&&e.toLowerCase(),arguments.length>1?($f[e]=t,this):$f[e]}function kf(e,t,r){var n;return Ae(t)&&null!=r&&(t=Math.min(t,~~(Se(e.domain())/r)||1)),w(t)&&(n=t.step,t=t.interval),F(t)&&(t=of(t,e.type)||k("Only time and utc scales accept interval strings."),n&&(t=t.every(n))),t}function _f(e,t,r){var n=e.range(),i=Math.floor(n[0]),a=Math.ceil(U(n));if(i>a&&(n=a,a=i,i=n),t=t.filter(function(t){return t=e(t),i<=t&&t<=a}),r>0&&t.length>1){for(var o=[t[0],U(t)];t.length>r&&t.length>=3;)t=t.filter(function(e,t){return!(t%2)});t.length<3&&(t=o)}return t}function Af(e,t){return e.bins?_f(e,function(e,t){var r=e.length,n=~~(r/(t||r));return n<2?e.slice():e.filter(function(e,t){return!(t%n)})}(e.bins,t)):e.ticks?e.ticks(t):e.domain()}function wf(e,t,r){var n,i,a=e.tickFormat?e.tickFormat(t,r):r?Object(d.a)(r):String;if(Zu(e.type)){var o=function(e){var t=Object(d.d)(e||",");if(null==t.precision){switch(t.precision=12,t.type){case"%":t.precision-=2;break;case"e":t.precision-=1}return r=Object(d.a)(t),n=Object(d.a)(".1f")(1)[1],function(e){var t,i,a=r(e),o=a.indexOf(n);if(o<0)return a;for(t=function(e,t){var r,n=e.lastIndexOf("e");if(n>0)return n;for(n=e.length;--n>t;)if((r=e.charCodeAt(n))>=48&&r<=57)return n+1}(a,o),i=t<a.length?a.slice(t):"";--t>o;)if("0"!==a[t]){++t;break}return a.slice(0,t)+i}}return Object(d.a)(t);var r,n}(r);a=e.bins?o:(n=a,i=o,function(e){return n(e)?i(e):""})}return a}function Ff(e){er.call(this,null,e)}function Df(e){er.call(this,null,e)}function Cf(){return Ge({})}function Ef(e){return e.exit}function Sf(e){er.call(this,null,e)}Of({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},vf),Of({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},e=>hf(vf(e))),$e(Ff,er).transform=function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var r=t.fork(t.NO_SOURCE|t.NO_FIELDS),n=this.value,i=e.scale,a=kf(i,null==e.count?e.values?e.values.length:10:e.count,e.minstep),o=e.format||wf(i,a,e.formatSpecifier),s=e.values?_f(i,e.values,a):Af(i,a);return n&&(r.rem=n),n=s.map(function(e,t){return Ge({index:t/(s.length-1),value:e,label:o(e)})}),e.extra&&n.length&&n.push(Ge({index:-1,extra:{value:n[0].value},label:""})),r.source=n,r.add=n,this.value=n,r},$e(Df,er).transform=function(e,t){var r=t.dataflow,n=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||Cf,a=e.key||Ue,o=this.value;return A(n.encode)&&(n.encode=null),o&&(e.modified("key")||t.modified(a))&&k("DataJoin does not support modified key function or fields."),o||(t=t.addAll(),this.value=o=ve().test(Ef),o.lookup=function(e){return o.get(a(e))}),t.visit(t.ADD,function(e){var t=a(e),r=o.get(t);r?r.exit?(o.empty--,n.add.push(r)):n.mod.push(r):(o.set(t,r=i(e)),n.add.push(r)),r.datum=e,r.exit=!1}),t.visit(t.MOD,function(e){var t=a(e),r=o.get(t);r&&(r.datum=e,n.mod.push(r))}),t.visit(t.REM,function(e){var t=a(e),r=o.get(t);e!==r.datum||r.exit||(n.rem.push(r),r.exit=!0,++o.empty)}),t.changed(t.ADD_MOD)&&n.modifies("datum"),e.clean&&o.empty>r.cleanThreshold&&r.runAfter(o.clean),n},$e(Sf,er).transform=function(e,t){var r=t.fork(t.ADD_REM),n=e.encoders,i=t.encode;if(A(i)){if(!r.changed()&&!i.every(function(e){return n[e]}))return t.StopPropagation;i=i[0],r.encode=null}var a="enter"===i,o=n.update||P,s=n.enter||P,u=n.exit||P,f=(i&&!a?n[i]:o)||P;if(t.changed(t.ADD)&&(t.visit(t.ADD,function(t){s(t,e),o(t,e),f!==P&&f!==o&&f(t,e)}),r.modifies(s.output),r.modifies(o.output),f!==P&&f!==o&&r.modifies(f.output)),t.changed(t.REM)&&u!==P&&(t.visit(t.REM,function(t){u(t,e)}),r.modifies(u.output)),a||f!==P){var l=t.MOD|(e.modified()?t.REFLOW:0);a?(t.visit(l,function(t){var n=s(t,e);(f(t,e)||n)&&r.mod.push(t)}),r.mod.length&&r.modifies(s.output)):t.visit(l,function(t){f(t,e)&&r.mod.push(t)}),r.mod.length&&r.modifies(f.output)}return r.changed()?r:t.StopPropagation};var jf="symbol",Mf="discrete";const qf={[Nu]:function(e){var t=[-1/0].concat(e.quantiles());return t.max=1/0,t},[Uu]:function(e){var t=e.domain(),r=t[0],n=U(t),i=e.range().length,a=new Array(i),o=0;a[0]=-1/0;for(;++o<i;)a[o]=(o*n-(o-i)*r)/i;return a.max=1/0,a},[Wu]:function(e){var t=[-1/0].concat(e.domain());return t.max=1/0,t}};function Bf(e,t,r){return r===jf&&function(e){return qf[e.type]||e.bins}(e)?function(e){return function(t,r,n){var i=n[r+1]||n.max||1/0,a=Pf(t,e),o=Pf(i,e);return a&&o?a+"–"+o:o?"< "+o:"≥ "+a}}(t):r===Mf?function(e){return function(t,r){return r?e(t):null}}(t):function(e){return function(t){return e(t)}}(t)}function Pf(e,t){return isFinite(e)?t(e):null}function zf(e){er.call(this,[],e)}$e(zf,er).transform=function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var r,n,i,a,o=t.fork(t.NO_SOURCE|t.NO_FIELDS),s=this.value,u=e.type||jf,f=e.scale,l=kf(f,null==e.count?5:e.count,e.minstep),c=e.format||wf(f,l,e.formatSpecifier),d=e.values||function(e,t){return e.bins?((r=e.bins.slice()).max=r.pop(),r):qf[e.type]?qf[e.type](e):Af(e,t);var r}(f,l);return c=Bf(f,c,u),s&&(o.rem=s),u===jf?(ce(i=e.size)?(e.values||0!==f(d[0])||(d=d.slice(1)),a=d.reduce(function(t,r){return Math.max(t,i(r,e))},0)):i=pe(a=i||8),s=d.map(function(t,r){return Ge({index:r,label:c(t,r,d),value:t,offset:a,size:i(t,e)})})):"gradient"===u?(r=f.domain(),n=yf(f,r[0],U(r)),d.length<3&&!e.values&&r[0]!==U(r)&&(d=[r[0],U(r)]),s=d.map(function(e,t){return Ge({index:t,label:c(e,t,d),value:e,perc:n(e)})})):(i=d.length-1,n=function(e){var t=e.domain(),r=t.length-1,n=+t[0],i=+U(t),a=i-n;if(e.type===Wu){var o=r?a/r:.1;a=(i+=o)-(n-=o)}return function(e){return(e-n)/a}}(f),s=d.map(function(e,t){return Ge({index:t,label:c(e,t,d),value:e,perc:t?n(e):0,perc2:t===i?1:n(d[t+1])})})),o.source=s,o.add=s,this.value=s,o};var Rf=ve({line:Uf,"line-radial":function(e,t,r,n){return Uf(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r))},arc:Wf,"arc-radial":function(e,t,r,n){return Wf(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r))},curve:Gf,"curve-radial":function(e,t,r,n){return Gf(t*Math.cos(e),t*Math.sin(e),n*Math.cos(r),n*Math.sin(r))},"orthogonal-horizontal":function(e,t,r,n){return"M"+e+","+t+"V"+n+"H"+r},"orthogonal-vertical":function(e,t,r,n){return"M"+e+","+t+"H"+r+"V"+n},"orthogonal-radial":function(e,t,r,n){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(r),s=Math.sin(r),u=Math.abs(r-e)>Math.PI?r<=e:r>e;return"M"+t*i+","+t*a+"A"+t+","+t+" 0 0,"+(u?1:0)+" "+t*o+","+t*s+"L"+n*o+","+n*s},"diagonal-horizontal":function(e,t,r,n){var i=(e+r)/2;return"M"+e+","+t+"C"+i+","+t+" "+i+","+n+" "+r+","+n},"diagonal-vertical":function(e,t,r,n){var i=(t+n)/2;return"M"+e+","+t+"C"+e+","+i+" "+r+","+i+" "+r+","+n},"diagonal-radial":function(e,t,r,n){var i=Math.cos(e),a=Math.sin(e),o=Math.cos(r),s=Math.sin(r),u=(t+n)/2;return"M"+t*i+","+t*a+"C"+u*i+","+u*a+" "+u*o+","+u*s+" "+n*o+","+n*s}});function Tf(e){return e.source.x}function If(e){return e.source.y}function Vf(e){return e.target.x}function Lf(e){return e.target.y}function Nf(e){er.call(this,{},e)}function Uf(e,t,r,n){return"M"+e+","+t+"L"+r+","+n}function Wf(e,t,r,n){var i=r-e,a=n-t,o=Math.sqrt(i*i+a*a)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(a,i)/Math.PI+" 0 1 "+r+","+n}function Gf(e,t,r,n){var i=r-e,a=n-t,o=.2*(i+a),s=.2*(a-i);return"M"+e+","+t+"C"+(e+o)+","+(t+s)+" "+(r+s)+","+(n-o)+" "+r+","+n}function Hf(e){er.call(this,null,e)}Nf.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},$e(Nf,er).transform=function(e,t){var r=e.sourceX||Tf,n=e.sourceY||If,i=e.targetX||Vf,a=e.targetY||Lf,o=e.as||"path",s=e.orient||"vertical",u=e.shape||"line",f=Rf.get(u+"-"+s)||Rf.get(u);return f||k("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,function(e){e[o]=f(r(e),n(e),i(e),a(e))}),t.reflow(e.modified()).modifies(o)},Hf.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},$e(Hf,er).transform=function(e,t){var r,n,i,a=e.as||["startAngle","endAngle"],s=a[0],u=a[1],f=e.field||q,l=e.startAngle||0,c=null!=e.endAngle?e.endAngle:2*Math.PI,d=t.source,p=d.map(f),m=p.length,h=l,g=(c-l)/Object(o.n)(p),y=Object(o.m)(m);for(e.sort&&y.sort(function(e,t){return p[e]-p[t]}),r=0;r<m;++r)i=p[y[r]],(n=d[y[r]])[s]=h,n[u]=h+=i*g;return this.value=p,t.reflow(e.modified()).modifies(a)};var Xf=5;function Jf(e){return ef(e)&&e!==Vu}var Yf=Pe(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function Kf(e){er.call(this,null,e),this.modified(!0)}function Qf(e,t,r){Zu(e)&&(Math.abs(t.reduce(function(e,t){return e+(t<0?-1:t>0?1:0)},0))!==t.length&&r.warn("Log scale domain includes zero: "+D(t)));return t}function Zf(e,t,r){return ce(e)&&(t||r)?mf(e,el(t||[0,1],r)):e}function el(e,t){return t?e.slice().reverse():e}function tl(e){er.call(this,null,e)}$e(Kf,er).transform=function(e,t){var r=t.dataflow,n=this.value,i=function(e){var t,r=e.type,n="";if(r===Vu)return Vu+"-"+qu;(function(e){const t=e.type;return ef(t)&&t!==Tu&&t!==Iu&&(e.scheme||e.range&&e.range.length&&e.range.every(F))})(e)&&(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0,n=2===t?Vu+"-":3===t?Lu+"-":"");return(n+r||qu).toLowerCase()}(e);for(i in n&&i===n.type||(this.value=n=lf(i)()),e)if(!Yf[i]){if("padding"===i&&Jf(n.type))continue;ce(n[i])?n[i](e[i]):r.warn("Unsupported scale property: "+i)}return function(e,t,r){var n=t.round||!1,i=t.range;if(null!=t.rangeStep)i=function(e,t,r){e!==Xu&&e!==Hu&&k("Only band and point scales support rangeStep.");var n=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===Hu?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*ju(r,i,n)]}(e.type,t,r);else if(t.scheme){if(i=function(e,t,r){var n,i,a=t.schemeExtent;A(t.scheme)?i=hf(t.scheme,t.interpolate,t.interpolateGamma):(n=t.scheme.toLowerCase(),(i=xf(n))||k("Unrecognized scheme name: "+t.scheme));return r=e===Wu?r+1:e===Ju?r-1:e===Nu||e===Uu?+t.schemeCount||Xf:r,Qu(e)?Zf(i,a,t.reverse):ce(i)?gf(Zf(i,a),r):e===Gu?i:i.slice(0,r)}(e.type,t,r),ce(i))return e.interpolator(i)}else if(i&&Qu(e.type))return e.interpolator(hf(el(i,t.reverse),t.interpolate,t.interpolateGamma));i&&t.interpolate&&e.interpolate?e.interpolate(bf(t.interpolate,t.interpolateGamma)):ce(e.round)?e.round(n):ce(e.rangeRound)&&e.interpolate(n?c.interpolateRound:c.interpolate);i&&e.range(el(i,t.reverse))}(n,e,function(e,t,r){let n=t.bins;if(n&&!A(n)){const t=(null==n.start||null==n.stop)&&e.domain(),r=null==n.start?t[0]:n.start,i=null==n.stop?U(t):n.stop,a=n.step;a||k("Scale bins parameter missing step property."),n=Object(o.m)(r,i+a,a)}n?e.bins=n:e.bins&&delete e.bins;e.type===Ju&&(n?t.domain||(e.domain(n),r=n.length):e.bins=e.domain());return r}(n,e,function(e,t,r){var n=function(e,t,r){return t?(e.domain(Qf(e.type,t,r)),t.length):-1}(e,t.domainRaw,r);if(n>-1)return n;var i,a,o=t.domain,s=e.type,u=t.zero||void 0===t.zero&&function(e){const t=e.type;return!e.bins&&(t===qu||t===Pu||t===zu)}(e);if(!o)return 0;Jf(s)&&t.padding&&o[0]!==U(o)&&(o=function(e,t,r,n,i,a){var o=Math.abs(U(r)-r[0]),s=o/(o-2*n),u=e===Bu?ie(t,null,s):e===zu?ae(t,null,s,.5):e===Pu?ae(t,null,s,i||1):e===Ru?oe(t,null,s,a||1):ne(t,null,s);return(t=t.slice())[0]=u[0],t[t.length-1]=u[1],t}(s,o,t.range,t.padding,t.exponent,t.constant));(u||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(i=(o=o.slice()).length-1||1,u&&(o[0]>0&&(o[0]=0),o[i]<0&&(o[i]=0)),null!=t.domainMin&&(o[0]=t.domainMin),null!=t.domainMax&&(o[i]=t.domainMax),null!=t.domainMid&&(((a=t.domainMid)<o[0]||a>o[i])&&r.warn("Scale domainMid exceeds domain min or max.",a),o.splice(i,0,a)));e.domain(Qf(s,o,r)),s===Gu&&e.unknown(t.domainImplicit?l.g:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&kf(e,t.nice)||null);return o.length}(n,e,r))),t.fork(t.NO_SOURCE|t.NO_FIELDS)},$e(tl,er).transform=function(e,t){var r=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return r&&t.source.sort(e.sort),this.modified(r),t};var rl=["y0","y1"];function nl(e){er.call(this,null,e)}function il(e,t,r,n,i){for(var a,o=(t-e.sum)/2,s=e.length,u=0;u<s;++u)(a=e[u])[n]=o,a[i]=o+=Math.abs(r(a))}function al(e,t,r,n,i){for(var a,o=1/e.sum,s=0,u=e.length,f=0,l=0;f<u;++f)(a=e[f])[n]=s,a[i]=s=o*(l+=Math.abs(r(a)))}function ol(e,t,r,n,i){for(var a,o,s=0,u=0,f=e.length,l=0;l<f;++l)(a=r(o=e[l]))<0?(o[n]=u,o[i]=u+=a):(o[n]=s,o[i]=s+=a)}nl.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:"zero",values:["zero","center","normalize"]},{name:"as",type:"string",array:!0,length:2,default:rl}]},$e(nl,er).transform=function(e,t){var r,n,i,a,o=e.as||rl,s=o[0],u=o[1],f=e.field||q,l="center"===e.offset?il:"normalize"===e.offset?al:ol;for(r=function(e,t,r,n){var i,a,o,s,u,f,l,c,d,p=[],m=function(e){return e(u)};if(null==t)p.push(e.slice());else for(i={},a=0,o=e.length;a<o;++a)u=e[a],f=t.map(m),(l=i[f])||(i[f]=l=[],p.push(l)),l.push(u);for(f=0,d=0,s=p.length;f<s;++f){for(l=p[f],a=0,c=0,o=l.length;a<o;++a)c+=Math.abs(n(l[a]));l.sum=c,c>d&&(d=c),r&&l.sort(r)}return p.max=d,p}(t.source,e.groupby,e.sort,f),n=0,i=r.length,a=r.max;n<i;++n)l(r[n],a,f,s,u);return t.reflow(e.modified()).modifies(o)};var sl=Object.freeze({axisticks:Ff,datajoin:Df,encode:Sf,legendentries:zf,linkpath:Nf,pie:Hf,scale:Kf,sortitems:tl,stack:nl,validTicks:_f}),ul=["size","smooth"],fl=["x","y","weight","size","cellSize","bandwidth"];function ll(e){er.call(this,null,e)}ll.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"smooth",type:"boolean"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0}]},$e(ll,er).transform=function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var r,n,i,a,s=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=e.count||10;return e.values?(r=Object(p.b)(),n=ul,i=e.values):(r=Object(p.a)(),n=fl,i=t.materialize(t.SOURCE).source),r.thresholds(e.thresholds||(e.nice?u:(a=u,function(e){for(var t=Object(o.f)(e),r=t[0],n=t[1]-r,i=[],s=1;s<=a;++s)i.push(r+n*s/(a+1));return i}))),n.forEach(function(t){null!=e[t]&&r[t](e[t])}),this.value&&(s.rem=this.value),i=i&&i.length?r(i).map(Ge):[],this.value=s.source=s.add=i,s};var cl="FeatureCollection";function dl(e){er.call(this,null,e)}dl.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},$e(dl,er).transform=function(e,t){var r,n=this._features,i=this._points,a=e.fields,o=a&&a[0],s=a&&a[1],u=e.geojson,f=t.ADD;r=e.modified()||t.changed(t.REM)||t.modified(x(u))||o&&t.modified(x(o))||s&&t.modified(x(s)),this.value&&!r||(f=t.SOURCE,this._features=n=[],this._points=i=[]),u&&t.visit(f,function(e){n.push(u(e))}),o&&s&&(t.visit(f,function(e){var t=o(e),r=s(e);null!=t&&null!=r&&(t=+t)===t&&(r=+r)===r&&i.push([t,r])}),n=n.concat({type:"Feature",geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:cl,features:n}};var pl=Object(m.x)(),ml=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function hl(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(yl[e]=function(e,t){return function r(){var n=t();return n.type=e,n.path=Object(m.x)().projection(n),n.copy=n.copy||function(){var e=r();return ml.forEach(function(t){n.hasOwnProperty(t)&&e[t](n[t]())}),e.path.pointRadius(n.path.pointRadius()),e},n}}(e,t),this):yl.hasOwnProperty(e)?yl[e]:null}function gl(e){return e&&e.path||pl}var yl={albers:m.a,albersusa:m.b,azimuthalequalarea:m.d,azimuthalequidistant:m.f,conicconformal:m.k,conicequalarea:m.l,conicequidistant:m.m,equirectangular:m.n,gnomonic:m.o,identity:m.r,mercator:m.t,naturalEarth1:m.u,orthographic:m.w,stereographic:m.B,transversemercator:m.D};for(var bl in yl)hl(bl,yl[bl]);function vl(e){er.call(this,null,e)}function Ol(e){er.call(this,null,e)}function $l(e){er.call(this,null,e)}function xl(e){er.call(this,[],e),this.generator=Object(m.q)()}function kl(e){er.call(this,null,e),this.modified(!0)}function _l(e,t,r){ce(e[t])&&e[t](r)}vl.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},$e(vl,er).transform=function(e,t){var r=t.fork(t.ALL),n=this.value,i=e.field||j,a=e.as||"path",o=r.SOURCE;!n||e.modified()?(this.value=n=gl(e.projection),r.materialize().reflow()):o=i===j||t.modified(i.fields)?r.ADD_MOD:r.ADD;var s=function(e,t){var r=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return r}(n,e.pointRadius);return r.visit(o,function(e){e[a]=n(i(e))}),n.pointRadius(s),r.modifies(a)},Ol.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},$e(Ol,er).transform=function(e,t){var r,n=e.projection,i=e.fields[0],a=e.fields[1],o=e.as||["x","y"],s=o[0],u=o[1];function f(e){var t=n([i(e),a(e)]);t?(e[s]=t[0],e[u]=t[1]):(e[s]=void 0,e[u]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,f):(r=t.modified(i.fields)||t.modified(a.fields),t.visit(r?t.ADD_MOD:t.ADD,f)),t.modifies(o)},$l.Definition={type:"GeoShape",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},$e($l,er).transform=function(e,t){var r=t.fork(t.ALL),n=this.value,i=e.field||C("datum"),a=e.as||"shape",o=r.ADD_MOD;return n&&!e.modified()||(this.value=n=function(e,t,r){var n=null==r?function(r){return e(t(r))}:function(n){var i=e.pointRadius(),a=e.pointRadius(r)(t(n));return e.pointRadius(i),a};return n.context=function(t){return e.context(t),n},n}(gl(e.projection),i,e.pointRadius),r.materialize().reflow(),o=r.SOURCE),r.visit(o,function(e){e[a]=n}),r.modifies(a)},xl.Definition={type:"Graticule",metadata:{changes:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},$e(xl,er).transform=function(e,t){var r,n=this.value,i=this.generator;if(!n.length||e.modified())for(var a in e)ce(i[a])&&i[a](e[a]);return r=i(),n.length?t.mod.push(Je(n[0],r)):t.add.push(Ge(r)),n[0]=r,t},$e(kl,er).transform=function(e,t){var r=this.value;return!r||e.modified("type")?(this.value=r=function(e){var t=hl((e||"mercator").toLowerCase());t||k("Unrecognized projection type: "+e);return t()}(e.type),ml.forEach(function(t){null!=e[t]&&_l(r,t,e[t])})):ml.forEach(function(t){e.modified(t)&&_l(r,t,e[t])}),null!=e.pointRadius&&r.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var r=(n=t.fit,1===(n=fe(n)).length?n[0]:{type:cl,features:n.reduce(function(e,t){return t&&t.type===cl?e.push.apply(e,t.features):A(t)?e.push.apply(e,t):e.push(t),e},[])});var n;t.extent?e.fitExtent(t.extent,r):t.size&&e.fitSize(t.size,r)}(r,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)};var Al=Object.freeze({contour:ll,geojson:dl,geopath:vl,geopoint:Ol,geoshape:$l,graticule:xl,projection:kl}),wl={center:h.a,collide:h.b,nbody:h.d,link:h.c,x:h.f,y:h.g},Fl="forces",Dl=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],Cl=["static","iterations"],El=["x","y","vx","vy"];function Sl(e){er.call(this,null,e)}Sl.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:El}]};var jl=$e(Sl,er);function Ml(e,t,r,n){var i,a,o,s,u=fe(t.forces);for(i=0,a=Dl.length;i<a;++i)(o=Dl[i])!==Fl&&t.modified(o)&&e[o](t[o]);for(i=0,a=u.length;i<a;++i)s=Fl+i,(o=r||t.modified(Fl,i)?Bl(u[i]):n&&ql(u[i],n)?e.force(s):null)&&e.force(s,o);for(a=e.numForces||0;i<a;++i)e.force(Fl+i,null);return e.numForces=u.length,e}function ql(e,t){var r,n;for(r in e)if(ce(n=e[r])&&t.modified(x(n)))return 1;return 0}function Bl(e){var t,r;for(r in wl.hasOwnProperty(e.force)||k("Unrecognized force: "+e.force),t=wl[e.force](),e)ce(t[r])&&Pl(t[r],e[r],e);return t}function Pl(e,t,r){e(ce(t)?function(e){return t(e,r)}:t)}jl.transform=function(e,t){var r,n,i=this.value,a=t.changed(t.ADD_REM),o=e.modified(Dl),s=e.iterations||300;if(i?(a&&(t.modifies("index"),i.nodes(t.source)),(o||t.changed(t.MOD))&&Ml(i,e,0,t)):(this.value=i=function(e,t){var r=Object(h.e)(e),n=!1,i=r.stop,a=r.restart;return r.stopped=function(){return n},r.restart=function(){return n=!1,a()},r.stop=function(){return n=!0,i()},Ml(r,t,!0).on("end",function(){n=!0})}(t.source,e),i.on("tick",(r=t.dataflow,n=this,function(){r.touch(n).run()})),e.static||(a=!0,i.tick()),t.modifies("index")),o||a||e.modified(Cl)||t.changed()&&e.restart)if(i.alpha(Math.max(i.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/s)),e.static)for(i.stop();--s>=0;)i.tick();else if(i.stopped()&&i.restart(),!a)return t.StopPropagation;return this.finish(e,t)},jl.finish=function(e,t){for(var r,n=t.dataflow,i=this._argops,a=0,o=i.length;a<o;++a)if((r=i[a]).name===Fl&&"link"===r.op._argval.force)for(var s,u=r.op._argops,f=0,l=u.length;f<l;++f)if("links"===u[f].name&&(s=u[f].op.source)){n.pulse(s,n.changeset().reflow());break}return t.reflow(e.modified()).modifies(El)};var zl=Object.freeze({force:Sl});function Rl(e,t,r){var n={};return e.each(function(e){var i=e.data;r(i)&&(n[t(i)]=e)}),e.lookup=n,e}function Tl(e){er.call(this,null,e)}function Il(e){return e.values}function Vl(){var e,t=[];return e={entries:function(e){return function e(r,n){if(++n>t.length)return r;var i,a=[];for(i in r)a.push({key:i,values:e(r[i],n)});return a}(function e(r,n){if(n>=t.length)return r;for(var i,a,o,s=-1,u=r.length,f=t[n++],l={},c={};++s<u;)(o=l[i=f(a=r[s])+""])?o.push(a):l[i]=[a];for(i in l)c[i]=e(l[i],n);return c}(e,0),0)},key:function(r){return t.push(r),e}}}function Ll(e){er.call(this,null,e)}function Nl(e,t){return e.parent===t.parent?1:2}Tl.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]},$e(Tl,er).transform=function(e,t){t.source||k("Nest transform requires an upstream data source.");var r=e.generate,n=e.modified(),i=t.clone(),a=this.value;return(!a||n||t.changed())&&(a&&a.each(function(e){e.children&&Ne(e.data)&&i.rem.push(e.data)}),this.value=a=Object(g.b)({values:fe(e.keys).reduce(function(e,t){return e.key(t),e},Vl()).entries(i.source)},Il),r&&a.each(function(e){e.children&&(e=Ge(e.data),i.add.push(e),i.source.push(e))}),Rl(a,Ue,Ue)),i.source.root=a,i},$e(Ll,er).transform=function(e,t){t.source&&t.source.root||k(this.constructor.name+" transform requires a backing tree data source.");var r=this.layout(e.method),n=this.fields,i=t.source.root,a=e.as||n;e.field&&i.sum(e.field),e.sort&&i.sort(e.sort),function(e,t,r){for(var n,i=0,a=t.length;i<a;++i)(n=t[i])in r&&e[n](r[n])}(r,this.params,e),r.separation&&r.separation(!1!==e.separation?Nl:q);try{this.value=r(i)}catch(e){k(e)}return i.each(function(e){!function(e,t,r){for(var n=e.data,i=0,a=t.length-1;i<a;++i)n[r[i]]=e[t[i]];n[r[a]]=e.children?e.children.length:0}(e,n,a)}),t.reflow(e.modified()).modifies(a).modifies("leaf")};var Ul=["x","y","r","depth","children"];function Wl(e){Ll.call(this,e)}Wl.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Ul.length,default:Ul}]};var Gl=$e(Wl,Ll);Gl.layout=g.c,Gl.params=["size","padding"],Gl.fields=Ul;var Hl=["x0","y0","x1","y1","depth","children"];function Xl(e){Ll.call(this,e)}Xl.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Hl.length,default:Hl}]};var Jl=$e(Xl,Ll);function Yl(e){er.call(this,null,e)}Jl.layout=g.d,Jl.params=["size","round","padding"],Jl.fields=Hl,Yl.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},$e(Yl,er).transform=function(e,t){t.source||k("Stratify transform requires an upstream data source.");var r=this.value,n=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),a=!this.value||n||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),a&&(r=i.source.length?Rl(Object(g.e)().id(e.key).parentId(e.parentKey)(i.source),e.key,B):Rl(Object(g.e)()([{}]),e.key,e.key)),i.source.root=this.value=r,i};var Kl={tidy:g.f,cluster:g.a},Ql=["x","y","depth","children"];function Zl(e){Ll.call(this,e)}Zl.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Ql.length,default:Ql}]};var ec=$e(Zl,Ll);function tc(e){er.call(this,[],e)}ec.layout=function(e){var t=e||"tidy";if(Kl.hasOwnProperty(t))return Kl[t]();k("Unrecognized Tree layout method: "+t)},ec.params=["size","nodeSize"],ec.fields=Ql,tc.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},$e(tc,er).transform=function(e,t){var r=this.value,n=t.source&&t.source.root,i=t.fork(t.NO_SOURCE),a={};return n||k("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(i.rem=r,t.visit(t.SOURCE,function(e){a[Ue(e)]=1}),n.each(function(e){var t=e.data,r=e.parent&&e.parent.data;r&&a[Ue(t)]&&a[Ue(r)]&&i.add.push(Ge({source:r,target:t}))}),this.value=i.add):t.changed(t.MOD)&&(t.visit(t.MOD,function(e){a[Ue(e)]=1}),r.forEach(function(e){(a[Ue(e.source)]||a[Ue(e.target)])&&i.mod.push(e)})),i};var rc={binary:g.h,dice:g.i,slice:g.k,slicedice:g.l,squarify:g.m,resquarify:g.j},nc=["x0","y0","x1","y1","depth","children"];function ic(e){Ll.call(this,e)}ic.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:nc.length,default:nc}]};var ac=$e(ic,Ll);ac.layout=function(){var e=Object(g.g)();return e.ratio=function(t){var r=e.tile();r.ratio&&e.tile(r.ratio(t))},e.method=function(t){rc.hasOwnProperty(t)?e.tile(rc[t]):k("Unrecognized Treemap layout method: "+t)},e},ac.params=["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],ac.fields=nc;var oc=Object.freeze({nest:Tl,pack:Wl,partition:Xl,stratify:Yl,tree:Zl,treelinks:tc,treemap:ic});function sc(e){er.call(this,null,e)}sc.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var uc=$e(sc,er),fc=[[-1e5,-1e5],[1e5,1e5]];uc.transform=function(e,t){var r,n,i,a,o=e.as||"path",s=t.source;for(r=Object(y.a)().x(e.x).y(e.y),e.size?r.size(e.size):r.extent(e.extent||fc),this.value=r=r(s),n=r.polygons(),i=0,a=s.length;i<a;++i)s[i][o]=n[i]?"M"+n[i].join("L")+"Z":null;return t.reflow(e.modified()).modifies(o)};var lc=Object.freeze({voronoi:sc}),cc=Math.PI/180,dc=64,pc=2048;function mc(){var e,t,r,n,i,a,o,s=[256,256],u=bc,f=[],l=Math.random,c={};function d(e,t,r){for(var n,i,a,o,f,c=t.x,d=t.y,p=Math.sqrt(s[0]*s[0]+s[1]*s[1]),m=u(s),h=l()<.5?1:-1,g=-h;(n=m(g+=h))&&(i=~~n[0],a=~~n[1],!(Math.min(Math.abs(i),Math.abs(a))>=p));)if(t.x=c+i,t.y=d+a,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1]||r&&gc(t,e,s[0])||r&&(f=r,!((o=t).x+o.x1>f[0].x&&o.x+o.x0<f[1].x&&o.y+o.y1>f[0].y&&o.y+o.y0<f[1].y)))){for(var y,b=t.sprite,v=t.width>>5,O=s[0]>>5,$=t.x-(v<<4),x=127&$,k=32-x,_=t.y1-t.y0,A=(t.y+t.y0)*O+($>>5),w=0;w<_;w++){y=0;for(var F=0;F<=v;F++)e[A+F]|=y<<k|(F<v?(y=b[w*v+F])>>>x:0);A+=O}return t.sprite=null,!0}return!1}return c.layout=function(){for(var u=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=(dc<<5)/t,e.height=pc/t;var r=e.getContext("2d");return r.fillStyle=r.strokeStyle="red",r.textAlign="center",{context:r,ratio:t}}(Ci()),c=function(e){var t=[],r=-1;for(;++r<e;)t[r]=0;return t}((s[0]>>5)*s[1]),p=null,m=f.length,h=-1,g=[],y=f.map(function(s){return{text:e(s),font:t(s),style:n(s),weight:i(s),rotate:a(s),size:~~r(s),padding:o(s),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:s}}).sort(function(e,t){return t.size-e.size});++h<m;){var b=y[h];b.x=s[0]*(l()+.5)>>1,b.y=s[1]*(l()+.5)>>1,hc(u,b,y,h),b.hasText&&d(c,b,p)&&(g.push(b),p?yc(p,b):p=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=s[0]>>1,b.y-=s[1]>>1)}return g},c.words=function(e){return arguments.length?(f=e,c):f},c.size=function(e){return arguments.length?(s=[+e[0],+e[1]],c):s},c.font=function(e){return arguments.length?(t=vc(e),c):t},c.fontStyle=function(e){return arguments.length?(n=vc(e),c):n},c.fontWeight=function(e){return arguments.length?(i=vc(e),c):i},c.rotate=function(e){return arguments.length?(a=vc(e),c):a},c.text=function(t){return arguments.length?(e=vc(t),c):e},c.spiral=function(e){return arguments.length?(u=Oc[e]||e,c):u},c.fontSize=function(e){return arguments.length?(r=vc(e),c):r},c.padding=function(e){return arguments.length?(o=vc(e),c):o},c.random=function(e){return arguments.length?(l=e,c):l},c}function hc(e,t,r,n){if(!t.sprite){var i=e.context,a=e.ratio;i.clearRect(0,0,(dc<<5)/a,pc/a);var o,s,u,f,l,c=0,d=0,p=0,m=r.length;for(--n;++n<m;){if(t=r[n],i.save(),i.font=t.style+" "+t.weight+" "+~~((t.size+1)/a)+"px "+t.font,o=i.measureText(t.text+"m").width*a,u=t.size<<1,t.rotate){var h=Math.sin(t.rotate*cc),g=Math.cos(t.rotate*cc),y=o*g,b=o*h,v=u*g,O=u*h;o=Math.max(Math.abs(y+O),Math.abs(y-O))+31>>5<<5,u=~~Math.max(Math.abs(b+v),Math.abs(b-v))}else o=o+31>>5<<5;if(u>p&&(p=u),c+o>=dc<<5&&(c=0,d+=p,p=0),d+u>=pc)break;i.translate((c+(o>>1))/a,(d+(u>>1))/a),t.rotate&&i.rotate(t.rotate*cc),i.fillText(t.text,0,0),t.padding&&(i.lineWidth=2*t.padding,i.strokeText(t.text,0,0)),i.restore(),t.width=o,t.height=u,t.xoff=c,t.yoff=d,t.x1=o>>1,t.y1=u>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,c+=o}for(var $=i.getImageData(0,0,(dc<<5)/a,pc/a).data,x=[];--n>=0;)if((t=r[n]).hasText){for(s=(o=t.width)>>5,u=t.y1-t.y0,f=0;f<u*s;f++)x[f]=0;if(null==(c=t.xoff))return;d=t.yoff;var k=0,_=-1;for(l=0;l<u;l++){for(f=0;f<o;f++){var A=s*l+(f>>5),w=$[(d+l)*(dc<<5)+(c+f)<<2]?1<<31-f%32:0;x[A]|=w,k|=w}k?_=l:(t.y0++,u--,l--,d++)}t.y1=t.y0+_,t.sprite=x.slice(0,(t.y1-t.y0)*s)}}}function gc(e,t,r){r>>=5;for(var n,i=e.sprite,a=e.width>>5,o=e.x-(a<<4),s=127&o,u=32-s,f=e.y1-e.y0,l=(e.y+e.y0)*r+(o>>5),c=0;c<f;c++){n=0;for(var d=0;d<=a;d++)if((n<<u|(d<a?(n=i[c*a+d])>>>s:0))&t[l+d])return!0;l+=r}return!1}function yc(e,t){var r=e[0],n=e[1];t.x+t.x0<r.x&&(r.x=t.x+t.x0),t.y+t.y0<r.y&&(r.y=t.y+t.y0),t.x+t.x1>n.x&&(n.x=t.x+t.x1),t.y+t.y1>n.y&&(n.y=t.y+t.y1)}function bc(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function vc(e){return"function"==typeof e?e:function(){return e}}var Oc={archimedean:bc,rectangular:function(e){var t=4*e[0]/e[1],r=0,n=0;return function(e){var i=e<0?-1:1;switch(Math.sqrt(1+4*i*e)-i&3){case 0:r+=t;break;case 1:n+=4;break;case 2:r-=t;break;default:n-=4}return[r,n]}}},$c=["x","y","font","fontSize","fontStyle","fontWeight","angle"],xc=["text","font","rotate","fontSize","fontStyle","fontWeight"];function kc(e){er.call(this,mc(),e)}kc.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:$c}]},$e(kc,er).transform=function(e,t){var r=e.modified();if(r||t.changed(t.ADD_REM)||xc.some(function(r){var n=e[r];return ce(n)&&t.modified(n.fields)})){var n,i=t.materialize(t.SOURCE).source,a=this.value,o=e.as||$c,s=e.fontSize||14;if(ce(s)?n=e.fontSizeRange:s=pe(s),n){var u=s,f=lf("sqrt")().domain(function(e,t){for(var r,n=1/0,i=-1/0,a=0,o=t.length;a<o;++a)(r=e(t[a]))<n&&(n=r),r>i&&(i=r);return[n,i]}(u,i)).range(n);s=function(e){return f(u(e))}}i.forEach(function(e){e[o[0]]=NaN,e[o[1]]=NaN,e[o[3]]=0});for(var l,c,d=a.words(i).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(s).random(gr).layout(),p=a.size(),m=p[0]>>1,h=p[1]>>1,g=0,y=d.length;g<y;++g)(c=(l=d[g]).datum)[o[0]]=l.x+m,c[o[1]]=l.y+h,c[o[2]]=l.font,c[o[3]]=l.size,c[o[4]]=l.style,c[o[5]]=l.weight,c[o[6]]=l.rotate;return t.reflow(r).modifies(o)}};var _c=Object.freeze({wordcloud:kc});function Ac(e){return new Uint32Array(e)}function wc(e,t,r){var n=(t<257?function(e){return new Uint8Array(e)}:t<65537?function(e){return new Uint16Array(e)}:Ac)(e);return r&&n.set(r),n}function Fc(e,t,r){var n=1<<t;return{one:n,zero:~n,range:r.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var r,i=this.bisect(this.range,e.value),a=e.index,o=i[0],s=i[1],u=a.length;for(r=0;r<o;++r)t[a[r]]|=n;for(r=s;r<u;++r)t[a[r]]|=n;return this}}}function Dc(){var e=Ac(0),t=[],r=0;return{insert:function(n,i,a){if(!i.length)return[];var s,u,f,l=r,c=i.length,d=Array(c),p=Ac(c);for(f=0;f<c;++f)d[f]=n(i[f]),p[f]=f;if(d=function(e,t){return e.sort.call(t,function(t,r){var n=e[t],i=e[r];return n<i?-1:n>i?1:0}),Object(o.k)(e,t)}(d,p),l)s=t,u=e,t=Array(l+c),e=Ac(l+c),function(e,t,r,n,i,a,o,s,u){var f,l=0,c=0;for(f=0;l<n&&c<o;++f)t[l]<i[c]?(s[f]=t[l],u[f]=r[l++]):(s[f]=i[c],u[f]=a[c++]+e);for(;l<n;++l,++f)s[f]=t[l],u[f]=r[l];for(;c<o;++c,++f)s[f]=i[c],u[f]=a[c]+e}(a,s,u,l,d,p,c,t,e);else{if(a>0)for(f=0;f<c;++f)p[f]+=a;t=d,e=p}return r=l+c,{index:p,value:d}},remove:function(n,i){var a,o,s,u=r;for(o=0;!i[e[o]]&&o<u;++o);for(s=o;o<u;++o)i[a=e[o]]||(e[s]=a,t[s]=t[o],++s);r=u-n},bisect:function(e,n){var i;return n?i=n.length:(n=t,i=r),[Object(o.c)(n,e[0],0,i),Object(o.d)(n,e[1],0,i)]},reindex:function(t){for(var n=0,i=r;n<i;++n)e[n]=t[e[n]]},index:function(){return e},size:function(){return r}}}function Cc(e){var t,r,n,i,a;er.call(this,(t=8,r=[],n=Ac(0),i=wc(0,t),a=wc(0,t),{data:function(){return r},seen:function(){return e=n,t=r.length,n=e.length>=t?e:((i=i||new e.constructor(t)).set(e),i);var e,t,i},add:function(e){for(var t,n=0,i=r.length,a=e.length;n<a;++n)(t=e[n])._index=i++,r.push(t)},remove:function(e,t){var n,o,s,u=r.length,f=Array(u-e),l=r;for(o=0;!t[o]&&o<u;++o)f[o]=r[o],l[o]=o;for(s=o;o<u;++o)n=r[o],t[o]?l[o]=-1:(l[o]=s,i[s]=i[o],a[s]=a[o],f[s]=n,n._index=s++),i[o]=0;return r=f,l},size:function(){return r.length},curr:function(){return i},prev:function(){return a},reset:function(e){a[e]=i[e]},all:function(){return t<257?255:t<65537?65535:4294967295},set:function(e,t){i[e]|=t},clear:function(e,t){i[e]&=~t},resize:function(e,r){(e>i.length||r>t)&&(t=Math.max(r,t),i=wc(e,t,i),a=wc(e,t))}}),e),this._indices=null,this._dims=null}Cc.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};var Ec=$e(Cc,er);function Sc(e){er.call(this,null,e)}Ec.transform=function(e,t){return this._dims?e.modified("fields")||e.fields.some(function(e){return t.modified(e.fields)})?this.reinit(e,t):this.eval(e,t):this.init(e,t)},Ec.init=function(e,t){for(var r,n,i=e.fields,a=e.query,o=this._indices={},s=this._dims=[],u=a.length,f=0;f<u;++f)n=o[r=i[f].fname]||(o[r]=Dc()),s.push(Fc(n,f,a[f]));return this.eval(e,t)},Ec.reinit=function(e,t){var r,n,i,a,o,s,u,f,l,c=t.materialize().fork(),d=e.fields,p=e.query,m=this._indices,h=this._dims,g=this.value,y=g.curr(),b=g.prev(),v=g.all(),O=c.rem=c.add,$=c.mod,x=p.length,k={};if(b.set(y),t.rem.length&&(o=this.remove(e,t,c)),t.add.length&&g.add(t.add),t.mod.length)for(s={},u=0,f=(a=t.mod).length;u<f;++u)s[a[u]._index]=1;for(u=0;u<x;++u)l=d[u],(!h[u]||e.modified("fields",u)||t.modified(l.fields))&&((r=k[i=l.fname])||(m[i]=n=Dc(),k[i]=r=n.insert(l,t.source,0)),h[u]=Fc(n,u,p[u]).onAdd(r,y));for(u=0,f=g.data().length;u<f;++u)o[u]||(b[u]!==y[u]?O.push(u):s[u]&&y[u]!==v&&$.push(u));return g.mask=(1<<x)-1,c},Ec.eval=function(e,t){var r=t.materialize().fork(),n=this._dims.length,i=0;return t.rem.length&&(this.remove(e,t,r),i|=(1<<n)-1),e.modified("query")&&!e.modified("fields")&&(i|=this.update(e,t,r)),t.add.length&&(this.insert(e,t,r),i|=(1<<n)-1),t.mod.length&&(this.modify(t,r),i|=(1<<n)-1),this.value.mask=i,r},Ec.insert=function(e,t,r){var n,i,a,o=t.add,s=this.value,u=this._dims,f=this._indices,l=e.fields,c={},d=r.add,p=s.size(),m=p+o.length,h=u.length;s.resize(m,h),s.add(o);var g=s.curr(),y=s.prev(),b=s.all();for(n=0;n<h;++n)a=c[i=l[n].fname]||(c[i]=f[i].insert(l[n],o,p)),u[n].onAdd(a,g);for(;p<m;++p)y[p]=b,g[p]!==b&&d.push(p)},Ec.modify=function(e,t){var r,n,i,a=t.mod,o=this.value,s=o.curr(),u=o.all(),f=e.mod;for(r=0,n=f.length;r<n;++r)s[i=f[r]._index]!==u&&a.push(i)},Ec.remove=function(e,t,r){var n,i,a,o,s=this._indices,u=this.value,f=u.curr(),l=u.prev(),c=u.all(),d={},p=r.rem,m=t.rem;for(n=0,i=m.length;n<i;++n)d[a=m[n]._index]=1,l[a]=o=f[a],f[a]=c,o!==c&&p.push(a);for(a in s)s[a].remove(i,d);return this.reindex(t,i,d),d},Ec.reindex=function(e,t,r){var n=this._indices,i=this.value;e.runAfter(function(){var e=i.remove(t,r);for(var a in n)n[a].reindex(e)})},Ec.update=function(e,t,r){var n,i,a=this._dims,o=e.query,s=t.stamp,u=a.length,f=0;for(r.filters=0,i=0;i<u;++i)e.modified("query",i)&&(n=i,++f);if(1===f)f=a[n].one,this.incrementOne(a[n],o[n],r.add,r.rem);else for(i=0,f=0;i<u;++i)e.modified("query",i)&&(f|=a[i].one,this.incrementAll(a[i],o[i],s,r.add),r.rem=r.add);return f},Ec.incrementAll=function(e,t,r,n){var i,a,o,s=this.value,u=s.seen(),f=s.curr(),l=s.prev(),c=e.index(),d=e.bisect(e.range),p=e.bisect(t),m=p[0],h=p[1],g=d[0],y=d[1],b=e.one;if(m<g)for(i=m,a=Math.min(g,h);i<a;++i)u[o=c[i]]!==r&&(l[o]=f[o],u[o]=r,n.push(o)),f[o]^=b;else if(m>g)for(i=g,a=Math.min(m,y);i<a;++i)u[o=c[i]]!==r&&(l[o]=f[o],u[o]=r,n.push(o)),f[o]^=b;if(h>y)for(i=Math.max(m,y),a=h;i<a;++i)u[o=c[i]]!==r&&(l[o]=f[o],u[o]=r,n.push(o)),f[o]^=b;else if(h<y)for(i=Math.max(g,h),a=y;i<a;++i)u[o=c[i]]!==r&&(l[o]=f[o],u[o]=r,n.push(o)),f[o]^=b;e.range=t.slice()},Ec.incrementOne=function(e,t,r,n){var i,a,o,s=this.value.curr(),u=e.index(),f=e.bisect(e.range),l=e.bisect(t),c=l[0],d=l[1],p=f[0],m=f[1],h=e.one;if(c<p)for(i=c,a=Math.min(p,d);i<a;++i)s[o=u[i]]^=h,r.push(o);else if(c>p)for(i=p,a=Math.min(c,m);i<a;++i)s[o=u[i]]^=h,n.push(o);if(d>m)for(i=Math.max(c,m),a=d;i<a;++i)s[o=u[i]]^=h,r.push(o);else if(d<m)for(i=Math.max(p,d),a=m;i<a;++i)s[o=u[i]]^=h,n.push(o);e.range=t.slice()},Sc.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},$e(Sc,er).transform=function(e,t){var r=~(e.ignore||0),n=e.filter,i=n.mask;if(0==(i&r))return t.StopPropagation;var a=t.fork(t.ALL),o=n.data(),s=n.curr(),u=n.prev(),f=function(e){return s[e]&r?null:o[e]};return a.filter(a.MOD,f),i&i-1?(a.filter(a.ADD,function(e){var t=s[e]&r;return!t&&t^u[e]&r?o[e]:null}),a.filter(a.REM,function(e){var t=s[e]&r;return t&&!(t^t^u[e]&r)?o[e]:null})):(a.filter(a.ADD,f),a.filter(a.REM,function(e){return(s[e]&r)===i?o[e]:null})),a.filter(a.SOURCE,function(e){return f(e._index)})};var jc=Object.freeze({crossfilter:Cc,resolvefilter:Sc}),Mc="5.0.0-rc2",qc="default";function Bc(e){var t=e._signals.cursor;t||(e._signals.cursor=t=e.add({user:qc,item:null})),e.on(e.events("view","mousemove"),t,function(e,r){var n=t.value,i=n?F(n)?n:n.user:qc,a=r.item&&r.item.cursor||null;return n&&i===n.user&&a==n.item?n:{user:i,item:a}}),e.add(null,function(e){var t,r=e.cursor,n=this.value;return F(r)||(n=r.item,r=r.user),t=r&&r!==qc?r:n||r,"undefined"!=typeof document&&document.body&&(document.body.style.cursor=t),n},{cursor:t})}function Pc(e,t){var r=e._runtime.data;return r.hasOwnProperty(t)||k("Unrecognized data set: "+t),r[t]}function zc(e,t){Ye(t)||k("Second argument to changes must be a changeset.");var r=Pc(this,e);return r.modified=!0,this.pulse(r.input,t)}function Rc(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function Tc(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function Ic(e){var t=e.padding(),r=e._origin;return[t.left+r[0],t.top+r[1]]}function Vc(e,t,r){var n,i,a=e._renderer.canvas();return a&&(i=Ic(e),(n=Ko(t.changedTouches?t.changedTouches[0]:t,a))[0]-=i[0],n[1]-=i[1]),t.dataflow=e,t.vega=function(e,t,r){var n=t?"group"===t.mark.marktype?t:t.mark.group:null;function i(e){var r,i=n;if(e)for(r=t;r;r=r.mark.group)if(r.mark.name===e){i=r;break}return i&&i.mark&&i.mark.interactive?i:{}}function a(e){if(!e)return r;F(e)&&(e=i(e));for(var t=r.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:pe(e),item:pe(t||{}),group:i,xy:a,x:function(e){return a(e)[0]},y:function(e){return a(e)[1]}}}(e,r,n),t.item=r,t}var Lc="view",Nc="timer",Uc="window",Wc={trap:!1};function Gc(e){return e.item}function Hc(e){var t=e.item.mark.source;return t.source||t}function Xc(e){return function(t,r){return r.vega.view().changeset().encode(r.item,e)}}function Jc(e,t,r){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);return null!=r&&(n.textContent=r),n}var Yc="vega-bind",Kc="vega-bind-name",Qc="vega-bind-radio",Zc="vega-option-";function ed(e,t,r){if(t){var n=r.param,i=r.state;return i||(i=r.state={elements:null,active:!1,set:null,update:function(t){t!==e.signal(n.signal)&&e.runAsync(null,function(){i.source=!0,e.signal(n.signal,t)})}},n.debounce&&(i.update=me(n.debounce,i.update))),function(e,t,r,n){var i=Jc("div",{class:Yc});i.appendChild(Jc("span",{class:Kc},r.name||r.signal)),t.appendChild(i);var a=td;switch(r.input){case"checkbox":a=rd;break;case"select":a=nd;break;case"radio":a=id;break;case"range":a=ad}a(e,i,r,n)}(i,t,n,e.signal(n.signal)),i.active||(e.on(e._signals[n.signal],null,function(){i.source?i.source=!1:i.set(e.signal(n.signal))}),i.active=!0),i}}function td(e,t,r,n){var i=Jc("input");for(var a in r)"signal"!==a&&"element"!==a&&i.setAttribute("input"===a?"type":a,r[a]);i.setAttribute("name",r.signal),i.value=n,t.appendChild(i),i.addEventListener("input",function(){e.update(i.value)}),e.elements=[i],e.set=function(e){i.value=e}}function rd(e,t,r,n){var i={type:"checkbox",name:r.signal};n&&(i.checked=!0);var a=Jc("input",i);t.appendChild(a),a.addEventListener("change",function(){e.update(a.checked)}),e.elements=[a],e.set=function(e){a.checked=!!e||null}}function nd(e,t,r,n){var i=Jc("select",{name:r.signal});r.options.forEach(function(e){var t={value:e};od(e,n)&&(t.selected=!0),i.appendChild(Jc("option",t,e+""))}),t.appendChild(i),i.addEventListener("change",function(){e.update(r.options[i.selectedIndex])}),e.elements=[i],e.set=function(e){for(var t=0,n=r.options.length;t<n;++t)if(od(r.options[t],e))return void(i.selectedIndex=t)}}function id(e,t,r,n){var i=Jc("span",{class:Qc});t.appendChild(i),e.elements=r.options.map(function(t){var a=Zc+r.signal+"-"+t,o={id:a,type:"radio",name:r.signal,value:t};od(t,n)&&(o.checked=!0);var s=Jc("input",o);return s.addEventListener("change",function(){e.update(t)}),i.appendChild(s),i.appendChild(Jc("label",{for:a},t+"")),s}),e.set=function(t){for(var r=e.elements,n=0,i=r.length;n<i;++n)od(r[n].value,t)&&(r[n].checked=!0)}}function ad(e,t,r,n){n=void 0!==n?n:(+r.max+ +r.min)/2;var i=r.min||Math.min(0,+n)||0,a=r.max||Math.max(100,+n)||100,s=r.step||Object(o.o)(i,a,100),u=Jc("input",{type:"range",name:r.signal,min:i,max:a,step:s});u.value=n;var f=Jc("label",{},+n);function l(){f.textContent=u.value,e.update(+u.value)}t.appendChild(u),t.appendChild(f),u.addEventListener("input",l),u.addEventListener("change",l),e.elements=[u],e.set=function(e){u.value=e,f.textContent=e}}function od(e,t){return e===t||e+""==t+""}function sd(e,t,r,n,i,a){return(t=t||new n(e.loader())).initialize(r,Rc(e),Tc(e),Ic(e),i,a).background(e._background)}function ud(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null}function fd(e,t){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t)try{t.innerHTML=""}catch(r){t=null,e.error(r)}return t}async function ld(e,t,r,n){const i=Ls(t),a=i&&i.headless;return a||k("Unrecognized renderer type: "+t),await e.runAsync(),sd(e,null,null,a,r,n).renderAsync(e._scenegraph.root)}var cd,dd,pd,md,hd,gd="RawCode",yd="Literal",bd="Property",vd="Identifier",Od="ArrayExpression",$d="BinaryExpression",xd="CallExpression",kd="ConditionalExpression",_d="LogicalExpression",Ad="MemberExpression",wd="ObjectExpression",Fd="UnaryExpression";function Dd(e){this.type=e}Dd.prototype.visit=function(e){var t,r,n;if(e(this))return 1;for(r=0,n=(t=function(e){switch(e.type){case Od:return e.elements;case $d:case _d:return[e.left,e.right];case xd:var t=e.arguments.slice();return t.unshift(e.callee),t;case kd:return[e.test,e.consequent,e.alternate];case Ad:return[e.object,e.property];case wd:return e.properties;case bd:return[e.key,e.value];case Fd:return[e.argument];case vd:case yd:case gd:default:return[]}}(this)).length;r<n;++r)if(t[r].visit(e))return 1};var Cd=1,Ed=2,Sd=3,jd=4,Md=5,qd=6,Bd=7,Pd=8;(cd={})[Cd]="Boolean",cd[Ed]="<end>",cd[Sd]="Identifier",cd[jd]="Keyword",cd[Md]="Null",cd[qd]="Numeric",cd[Bd]="Punctuator",cd[Pd]="String",cd[9]="RegularExpression";var zd="ArrayExpression",Rd="BinaryExpression",Td="CallExpression",Id="ConditionalExpression",Vd="Identifier",Ld="Literal",Nd="LogicalExpression",Ud="MemberExpression",Wd="ObjectExpression",Gd="Property",Hd="UnaryExpression",Xd="Unexpected token %0",Jd="Unexpected number",Yd="Unexpected string",Kd="Unexpected identifier",Qd="Unexpected reserved word",Zd="Unexpected end of input",ep="Invalid regular expression",tp="Invalid regular expression: missing /",rp="Octal literals are not allowed in strict mode.",np="Duplicate data property in object literal not allowed in strict mode",ip="ILLEGAL",ap="Disabled.",op=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),sp=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function up(e,t){if(!e)throw new Error("ASSERT: "+t)}function fp(e){return e>=48&&e<=57}function lp(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function cp(e){return"01234567".indexOf(e)>=0}function dp(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function pp(e){return 10===e||13===e||8232===e||8233===e}function mp(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&op.test(String.fromCharCode(e))}function hp(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&sp.test(String.fromCharCode(e))}var gp={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function yp(){for(var e;pd<md&&(dp(e=dd.charCodeAt(pd))||pp(e));)++pd}function bp(e){var t,r,n,i=0;for(r="u"===e?4:2,t=0;t<r;++t)pd<md&&lp(dd[pd])?(n=dd[pd++],i=16*i+"0123456789abcdef".indexOf(n.toLowerCase())):qp({},Xd,ip);return String.fromCharCode(i)}function vp(){var e,t,r,n;for(t=0,"}"===(e=dd[pd])&&qp({},Xd,ip);pd<md&&lp(e=dd[pd++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&qp({},Xd,ip),t<=65535?String.fromCharCode(t):(r=55296+(t-65536>>10),n=56320+(t-65536&1023),String.fromCharCode(r,n))}function Op(){var e,t;for(e=dd.charCodeAt(pd++),t=String.fromCharCode(e),92===e&&(117!==dd.charCodeAt(pd)&&qp({},Xd,ip),++pd,(e=bp("u"))&&"\\"!==e&&mp(e.charCodeAt(0))||qp({},Xd,ip),t=e);pd<md&&hp(e=dd.charCodeAt(pd));)++pd,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==dd.charCodeAt(pd)&&qp({},Xd,ip),++pd,(e=bp("u"))&&"\\"!==e&&hp(e.charCodeAt(0))||qp({},Xd,ip),t+=e);return t}function $p(){var e,t;return e=pd,{type:1===(t=92===dd.charCodeAt(pd)?Op():function(){var e,t;for(e=pd++;pd<md;){if(92===(t=dd.charCodeAt(pd)))return pd=e,Op();if(!hp(t))break;++pd}return dd.slice(e,pd)}()).length?Sd:gp.hasOwnProperty(t)?jd:"null"===t?Md:"true"===t||"false"===t?Cd:Sd,value:t,start:e,end:pd}}function xp(){var e,t,r,n,i=pd,a=dd.charCodeAt(pd),o=dd[pd];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++pd,{type:Bd,value:String.fromCharCode(a),start:i,end:pd};default:if(61===(e=dd.charCodeAt(pd+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return pd+=2,{type:Bd,value:String.fromCharCode(a)+String.fromCharCode(e),start:i,end:pd};case 33:case 61:return pd+=2,61===dd.charCodeAt(pd)&&++pd,{type:Bd,value:dd.slice(i,pd),start:i,end:pd}}}return">>>="===(n=dd.substr(pd,4))?{type:Bd,value:n,start:i,end:pd+=4}:">>>"===(r=n.substr(0,3))||"<<="===r||">>="===r?{type:Bd,value:r,start:i,end:pd+=3}:o===(t=r.substr(0,2))[1]&&"+-<>&|".indexOf(o)>=0||"=>"===t?{type:Bd,value:t,start:i,end:pd+=2}:"<>=!+-*%&|^/".indexOf(o)>=0?{type:Bd,value:o,start:i,end:++pd}:void qp({},Xd,ip)}function kp(){var e,t,r;if(up(fp((r=dd[pd]).charCodeAt(0))||"."===r,"Numeric literal must start with a decimal digit or a decimal point"),t=pd,e="","."!==r){if(e=dd[pd++],r=dd[pd],"0"===e){if("x"===r||"X"===r)return++pd,function(e){for(var t="";pd<md&&lp(dd[pd]);)t+=dd[pd++];return 0===t.length&&qp({},Xd,ip),mp(dd.charCodeAt(pd))&&qp({},Xd,ip),{type:qd,value:parseInt("0x"+t,16),start:e,end:pd}}(t);if(cp(r))return function(e){for(var t="0"+dd[pd++];pd<md&&cp(dd[pd]);)t+=dd[pd++];return(mp(dd.charCodeAt(pd))||fp(dd.charCodeAt(pd)))&&qp({},Xd,ip),{type:qd,value:parseInt(t,8),octal:!0,start:e,end:pd}}(t);r&&fp(r.charCodeAt(0))&&qp({},Xd,ip)}for(;fp(dd.charCodeAt(pd));)e+=dd[pd++];r=dd[pd]}if("."===r){for(e+=dd[pd++];fp(dd.charCodeAt(pd));)e+=dd[pd++];r=dd[pd]}if("e"===r||"E"===r)if(e+=dd[pd++],"+"!==(r=dd[pd])&&"-"!==r||(e+=dd[pd++]),fp(dd.charCodeAt(pd)))for(;fp(dd.charCodeAt(pd));)e+=dd[pd++];else qp({},Xd,ip);return mp(dd.charCodeAt(pd))&&qp({},Xd,ip),{type:qd,value:parseFloat(e),start:t,end:pd}}function _p(){var e,t,r,n;return hd=null,yp(),e=pd,t=function(){var e,t,r,n;for(up("/"===(e=dd[pd]),"Regular expression literal must start with a slash"),t=dd[pd++],r=!1,n=!1;pd<md;)if(t+=e=dd[pd++],"\\"===e)pp((e=dd[pd++]).charCodeAt(0))&&qp({},tp),t+=e;else if(pp(e.charCodeAt(0)))qp({},tp);else if(r)"]"===e&&(r=!1);else{if("/"===e){n=!0;break}"["===e&&(r=!0)}return n||qp({},tp),{value:t.substr(1,t.length-2),literal:t}}(),r=function(){var e,t,r;for(t="",r="";pd<md&&hp((e=dd[pd]).charCodeAt(0));)++pd,"\\"===e&&pd<md?qp({},Xd,ip):(r+=e,t+=e);return r.search(/[^gimuy]/g)>=0&&qp({},ep,r),{value:r,literal:t}}(),n=function(e,t){var r=e;t.indexOf("u")>=0&&(r=r.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111)return"x";qp({},ep)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return new RegExp(e,t)}catch(e){return null}}(t.value,r.value),{literal:t.literal+r.literal,value:n,regex:{pattern:t.value,flags:r.value},start:e,end:pd}}function Ap(){var e;return yp(),pd>=md?{type:Ed,start:pd,end:pd}:mp(e=dd.charCodeAt(pd))?$p():40===e||41===e||59===e?xp():39===e||34===e?function(){var e,t,r,n,i="",a=!1;for(up("'"===(e=dd[pd])||'"'===e,"String literal must starts with a quote"),t=pd,++pd;pd<md;){if((r=dd[pd++])===e){e="";break}if("\\"===r)if((r=dd[pd++])&&pp(r.charCodeAt(0)))"\r"===r&&"\n"===dd[pd]&&++pd;else switch(r){case"u":case"x":"{"===dd[pd]?(++pd,i+=vp()):i+=bp(r);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:cp(r)?(0!==(n="01234567".indexOf(r))&&(a=!0),pd<md&&cp(dd[pd])&&(a=!0,n=8*n+"01234567".indexOf(dd[pd++]),"0123".indexOf(r)>=0&&pd<md&&cp(dd[pd])&&(n=8*n+"01234567".indexOf(dd[pd++]))),i+=String.fromCharCode(n)):i+=r}else{if(pp(r.charCodeAt(0)))break;i+=r}}return""!==e&&qp({},Xd,ip),{type:Pd,value:i,octal:a,start:t,end:pd}}():46===e?fp(dd.charCodeAt(pd+1))?kp():xp():fp(e)?kp():xp()}function wp(){var e;return pd=(e=hd).end,hd=Ap(),pd=e.end,e}function Fp(){var e;e=pd,hd=Ap(),pd=e}function Dp(e,t,r){var n=new Dd("||"===e||"&&"===e?Nd:Rd);return n.operator=e,n.left=t,n.right=r,n}function Cp(e,t){var r=new Dd(Td);return r.callee=e,r.arguments=t,r}function Ep(e){var t=new Dd(Vd);return t.name=e,t}function Sp(e){var t=new Dd(Ld);return t.value=e.value,t.raw=dd.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function jp(e,t,r){var n=new Dd(Ud);return n.computed="["===e,n.object=t,n.property=r,n.computed||(r.member=!0),n}function Mp(e,t,r){var n=new Dd(Gd);return n.key=t,n.value=r,n.kind=e,n}function qp(e,t){var r,n=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(e,t){return up(t<n.length,"Message reference must be in range"),n[t]});throw(r=new Error(i)).index=pd,r.description=i,r}function Bp(e){e.type===Ed&&qp(e,Zd),e.type===qd&&qp(e,Jd),e.type===Pd&&qp(e,Yd),e.type===Sd&&qp(e,Kd),e.type===jd&&qp(e,Qd),qp(e,Xd,e.value)}function Pp(e){var t=wp();t.type===Bd&&t.value===e||Bp(t)}function zp(e){return hd.type===Bd&&hd.value===e}function Rp(e){return hd.type===jd&&hd.value===e}function Tp(){var e=[];for(pd=hd.start,Pp("[");!zp("]");)zp(",")?(wp(),e.push(null)):(e.push(Kp()),zp("]")||Pp(","));return wp(),function(e){var t=new Dd(zd);return t.elements=e,t}(e)}function Ip(){var e;return pd=hd.start,(e=wp()).type===Pd||e.type===qd?(e.octal&&qp(e,rp),Sp(e)):Ep(e.value)}function Vp(){var e,t,r;return pd=hd.start,(e=hd).type===Sd?(r=Ip(),Pp(":"),Mp("init",r,Kp())):e.type!==Ed&&e.type!==Bd?(t=Ip(),Pp(":"),Mp("init",t,Kp())):void Bp(e)}function Lp(){var e,t,r=[],n={},i=String;for(pd=hd.start,Pp("{");!zp("}");)t="$"+((e=Vp()).key.type===Vd?e.key.name:i(e.key.value)),Object.prototype.hasOwnProperty.call(n,t)?qp({},np):n[t]=!0,r.push(e),zp("}")||Pp(",");return Pp("}"),function(e){var t=new Dd(Wd);return t.properties=e,t}(r)}var Np={if:1,this:1};function Up(){var e,t,r;if(zp("("))return function(){var e;return Pp("("),e=Qp(),Pp(")"),e}();if(zp("["))return Tp();if(zp("{"))return Lp();if(e=hd.type,pd=hd.start,e===Sd||Np[hd.value])r=Ep(wp().value);else if(e===Pd||e===qd)hd.octal&&qp(hd,rp),r=Sp(wp());else{if(e===jd)throw new Error(ap);e===Cd?((t=wp()).value="true"===t.value,r=Sp(t)):e===Md?((t=wp()).value=null,r=Sp(t)):zp("/")||zp("/=")?(r=Sp(_p()),Fp()):Bp(wp())}return r}function Wp(){var e=[];if(Pp("("),!zp(")"))for(;pd<md&&(e.push(Kp()),!zp(")"));)Pp(",");return Pp(")"),e}function Gp(){var e;return pd=hd.start,function(e){return e.type===Sd||e.type===jd||e.type===Cd||e.type===Md}(e=wp())||Bp(e),Ep(e.value)}function Hp(){var e;return Pp("["),e=Qp(),Pp("]"),e}function Xp(){var e=function(){var e;for(e=Up();;)if(zp("."))Pp("."),e=jp(".",e,Gp());else if(zp("("))e=Cp(e,Wp());else{if(!zp("["))break;e=jp("[",e,Hp())}return e}();if(hd.type===Bd&&(zp("++")||zp("--")))throw new Error(ap);return e}function Jp(){var e,t,r,n,i;if(hd.type!==Bd&&hd.type!==jd)t=Xp();else{if(zp("++")||zp("--"))throw new Error(ap);if(zp("+")||zp("-")||zp("~")||zp("!"))e=wp(),t=Jp(),r=e.value,n=t,(i=new Dd(Hd)).operator=r,i.argument=n,i.prefix=!0,t=i;else{if(Rp("delete")||Rp("void")||Rp("typeof"))throw new Error(ap);t=Xp()}}return t}function Yp(e){var t=0;if(e.type!==Bd&&e.type!==jd)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Kp(){var e,t;return e=function(){var e,t,r,n,i,a,o,s,u,f;if(e=hd,u=Jp(),0===(i=Yp(n=hd)))return u;for(n.prec=i,wp(),t=[e,hd],a=[u,n,o=Jp()];(i=Yp(hd))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,u=a.pop(),t.pop(),r=Dp(s,u,o),a.push(r);(n=wp()).prec=i,a.push(n),t.push(hd),r=Jp(),a.push(r)}for(r=a[f=a.length-1],t.pop();f>1;)t.pop(),r=Dp(a[f-1].value,a[f-2],r),f-=2;return r}(),zp("?")&&(wp(),t=Kp(),Pp(":"),e=function(e,t,r){var n=new Dd(Id);return n.test=e,n.consequent=t,n.alternate=r,n}(e,t,Kp())),e}function Qp(){var e=Kp();if(zp(","))throw new Error(ap);return e}var Zp={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function em(e){function t(t,r,n){return function(i){return function(t,r,n,i){var a=e(r[0]);return n&&(a=n+"("+a+")",0===n.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+t+(i<0?"":0===i?"()":"("+r.slice(1).map(e).join(",")+")")}(t,i,r,n)}}var r="new Date";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&k("Missing arguments to clamp function."),t.length>3&&k("Too many arguments to clamp function.");var r=t.map(e);return"Math.max("+r[1]+", Math.min("+r[2]+","+r[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:t("getDate",r,0),day:t("getDay",r,0),year:t("getFullYear",r,0),month:t("getMonth",r,0),hours:t("getHours",r,0),minutes:t("getMinutes",r,0),seconds:t("getSeconds",r,0),milliseconds:t("getMilliseconds",r,0),time:t("getTime",r,0),timezoneoffset:t("getTimezoneOffset",r,0),utcdate:t("getUTCDate",r,0),utcday:t("getUTCDay",r,0),utcyear:t("getUTCFullYear",r,0),utcmonth:t("getUTCMonth",r,0),utchours:t("getUTCHours",r,0),utcminutes:t("getUTCMinutes",r,0),utcseconds:t("getUTCSeconds",r,0),utcmilliseconds:t("getUTCMilliseconds",r,0),length:t("length",null,-1),indexof:t("indexOf",null),lastindexof:t("lastIndexOf",null),slice:t("slice",null),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase","String",0),lower:t("toLowerCase","String",0),substring:t("substring","String"),split:t("split","String"),replace:t("replace","String"),regexp:"RegExp",test:t("test","RegExp"),if:function(t){t.length<3&&k("Missing arguments to if function."),t.length>3&&k("Too many arguments to if function.");var r=t.map(e);return"("+r[0]+"?"+r[1]+":"+r[2]+")"}}}const tm="intersect",rm="union";var nm="E",im="R",am="R-E",om="R-LE",sm="R-RE",um="index:unit";function fm(e,t){for(var r,n,i=t.fields,a=t.values,o=i.length,s=0;s<o;++s)if((n=i[s]).getter=C.getter||C(n.field),_e(r=n.getter(e))&&(r=W(r)),_e(a[s])&&(a[s]=W(a[s])),_e(a[s][0])&&(a[s]=a[s].map(W)),n.type===nm){if(A(a[s])?a[s].indexOf(r)<0:r!==a[s])return!1}else if(n.type===im){if(!xe(r,a[s]))return!1}else if(n.type===sm){if(!xe(r,a[s],!0,!1))return!1}else if(n.type===am){if(!xe(r,a[s],!1,!1))return!1}else if(n.type===om&&!xe(r,a[s],!1,!0))return!1;return!0}var lm={E_union:function(e,t){if(!e.length)return t;for(var r=0,n=t.length;r<n;++r)e.indexOf(t[r])<0&&e.push(t[r]);return e},E_intersect:function(e,t){return e.length?e.filter(function(e){return t.indexOf(e)>=0}):t},R_union:function(e,t){var r=W(t[0]),n=W(t[1]);return r>n&&(r=t[1],n=t[0]),e.length?(e[0]>r&&(e[0]=r),e[1]<n&&(e[1]=n),e):[r,n]},R_intersect:function(e,t){var r=W(t[0]),n=W(t[1]);return r>n&&(r=t[1],n=t[0]),e.length?n<e[0]||e[1]<r?[]:(e[0]<r&&(e[0]=r),e[1]>n&&(e[1]=n),e):[r,n]}};const cm=":",dm="@";function pm(e,t,r,n){t[0].type!==yd&&k("First argument to selection functions must be a string literal.");const i=t[0].value,a=t.length>=2&&U(t).value,o=dm+"unit",s=cm+i;a!==tm||n.hasOwnProperty(o)||(n[o]=r.getData(i).indataRef(r,"unit")),n.hasOwnProperty(s)||(n[s]=r.getData(i).tuplesRef())}function mm(e){const t=this.context.data[e];return t?t.values.value:[]}const hm={};function gm(e,t,r){let n=e+":"+r,i=hm[n];return i&&i[0]===t||(hm[n]=i=[t,t(r)]),i[1]}function ym(e,t){return gm("timeFormat",a.a,t)(e)}var bm=new Date(2e3,0,1);function vm(e,t,r){return bm.setMonth(e),bm.setDate(t),ym(bm,r)}function Om(e,t){let r;return ce(e)?e:F(e)?(r=t.scales[e])&&r.value:void 0}function $m(e,t){return function(r,n,i){if(r){const t=Om(r,(i||this).context);return t&&t.path[e](n)}return t(n)}}const xm=$m("area",m.c),km=$m("bounds",m.h),_m=$m("centroid",m.i);function Am(e,t,r){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(r)))}catch(t){e.warn(t)}return r[r.length-1]}function wm(e,t){return e===t||e!=e&&t!=t||!(!A(e)||!A(t)||e.length!==t.length)&&function(e,t){for(let r=0,n=e.length;r<n;++r)if(!wm(e[r],t[r]))return!1;return!0}(e,t)}function Fm(e){return function(t){for(let r in e)if(!wm(t[r],e[r]))return!1;return!0}}const Dm={};function Cm(e){return e.data}function Em(e,t){const r=mm.call(t,e);return r.root&&r.root.lookup||Dm}const Sm="undefined"!=typeof window&&window||null;const jm=":",Mm="@",qm="%",Bm="$";function Pm(e,t,r,n){t[0].type!==yd&&k("First argument to data functions must be a string literal.");const i=t[0].value,a=jm+i;n.hasOwnProperty(a)||(n[a]=r.getData(i).tuplesRef())}function zm(e,t,r,n){if(t[0].type===yd)Rm(r,n,t[0].value);else if(t[0].type===vd)for(e in r.scales)Rm(r,n,e)}function Rm(e,t,r){const n=qm+r;if(!t.hasOwnProperty(n))try{t[n]=e.scaleRef(r)}catch(e){}}const Tm={random:function(){return gr()},isArray:A,isBoolean:ke,isDate:_e,isNumber:Ae,isObject:w,isRegExp:we,isString:F,isTuple:Ne,toBoolean:je,toDate:qe,toNumber:W,toString:Be,pad:Ee,peek:U,truncate:ze,rgb:b.f,lab:b.e,hcl:b.c,hsl:b.d,sequence:o.m,format:function(e,t){return gm("format",d.a,t)(e)},utcFormat:function(e,t){return gm("utcFormat",a.d,t)(e)},utcParse:function(e,t){return gm("utcParse",a.e,t)(e)},timeFormat:ym,timeParse:function(e,t){return gm("timeParse",a.c,t)(e)},monthFormat:function(e){return vm(e,1,"%B")},monthAbbrevFormat:function(e){return vm(e,1,"%b")},dayFormat:function(e){return vm(0,2+e,"%A")},dayAbbrevFormat:function(e){return vm(0,2+e,"%a")},quarter:se,utcquarter:ue,warn:function(){return Am(this.context.dataflow,"warn",arguments)},info:function(){return Am(this.context.dataflow,"info",arguments)},debug:function(){return Am(this.context.dataflow,"debug",arguments)},extent:ge,inScope:function(e){let t=this.context.group,r=!1;if(t)for(;e;){if(e===t){r=!0;break}e=e.mark.group}return r},intersect:function(e,t,r){if(!e)return[];const[n,i]=e,a=(new ki).set(n[0],n[1],i[0],i[1]);return Ns(r||this.context.dataflow.scenegraph().root,a,function(e){let t=null;if(e){const r=fe(e.marktype),n=fe(e.markname);t=(e=>(!r.length||r.some(t=>e.marktype===t))&&(!n.length||n.some(t=>e.name===t)))}return t}(t))},clampRange:le,pinchDistance:function(e){const t=e.touches,r=t[0].clientX-t[1].clientX,n=t[0].clientY-t[1].clientY;return Math.sqrt(r*r+n*n)},pinchAngle:function(e){const t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){return Sm?Sm.screen:{}},containerSize:function(){const e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){return Sm?[Sm.innerWidth,Sm.innerHeight]:[void 0,void 0]},span:Se,merge:function(){var e=[].slice.call(arguments);return e.unshift({}),he.apply(null,e)},flush:Oe,bandspace:function(e,t,r){return ju(e||0,t||0,r||0)},inrange:xe,setdata:function(e,t){const r=this.context.dataflow,n=this.context.data[e].input;return r.pulse(n,r.changeset().remove(B).insert(t)),1},pathShape:function(e){let t=null;return function(r){return r?Yi(r,t=t||Ti(e)):e}},panLinear:Q,panLog:Z,panPow:ee,panSymlog:te,zoomLinear:ne,zoomLog:ie,zoomPow:ae,zoomSymlog:oe,encode:function(e,t,r){if(e){const r=this.context.dataflow,n=e.mark.source;r.pulse(n,r.changeset().encode(e,t))}return void 0!==r?r:e},modify:function(e,t,r,n,i,a){let o,s,u=this.context.dataflow,f=this.context.data[e],l=f.input,c=f.changes,d=u.stamp();if(!1===u._trigger||!(l.value.length||t||n))return 0;if((!c||c.stamp<d)&&(f.changes=c=u.changeset(),c.stamp=d,u.runAfter(function(){f.modified=!0,u.pulse(l,c).run()},!0,1)),r&&(o=!0===r?B:A(r)||Ne(r)?r:Fm(r),c.remove(o)),t&&c.insert(t),n&&(o=Fm(n),l.value.some(o)?c.remove(o):c.insert(n)),i)for(s in a)c.modify(i,s,a[s]);return 1}},Im=["view","item","group","xy","x","y"],Vm="event.vega.",Lm="this.",Nm={};function Um(e,t,r){return 1===arguments.length?Tm[e]:(Tm[e]=t,r&&(Nm[e]=r),Gm&&(Gm.functions[e]=Lm+e),this)}Um("bandwidth",function(e,t){const r=Om(e,(t||this).context);return r&&r.bandwidth?r.bandwidth():0},zm),Um("copy",function(e,t){const r=Om(e,(t||this).context);return r?r.copy():void 0},zm),Um("domain",function(e,t){const r=Om(e,(t||this).context);return r?r.domain():[]},zm),Um("range",function(e,t){const r=Om(e,(t||this).context);return r&&r.range?r.range():[]},zm),Um("invert",function(e,t,r){const n=Om(e,(r||this).context);return n?A(t)?(n.invertRange||n.invert)(t):(n.invert||n.invertExtent)(t):void 0},zm),Um("scale",function(e,t,r){const n=Om(e,(r||this).context);return n?n(t):void 0},zm),Um("gradient",function(e,t,r,n,i){e=Om(e,(i||this).context);const a=wi(t,r);let o=e.domain(),s=o[0],u=U(o),f=j;return u-s?f=yf(e,s,u):e=(e.interpolator?lf("sequential")().interpolator(e.interpolator()):lf("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,u=1]),e.ticks&&(s!==(o=e.ticks(+n||15))[0]&&o.unshift(s),u!==U(o)&&o.push(u)),o.forEach(t=>a.stop(f(t),e(t))),a},zm),Um("geoArea",xm,zm),Um("geoBounds",km,zm),Um("geoCentroid",_m,zm),Um("geoShape",function(e,t,r){const n=Om(e,(r||this).context);return function(e){return n?n.path.context(e)(t):""}},zm),Um("indata",function(e,t,r){const n=this.context.data[e]["index:"+t],i=n?n.value.get(r):void 0;return i?i.count:i},function(e,t,r,n){t[0].type!==yd&&k("First argument to indata must be a string literal."),t[1].type!==yd&&k("Second argument to indata must be a string literal.");const i=t[0].value,a=t[1].value,o=Mm+a;n.hasOwnProperty(o)||(n[o]=r.getData(i).indataRef(r,a))}),Um("data",mm,Pm),Um("treePath",function(e,t,r){const n=Em(e,this),i=n[t],a=n[r];return i&&a?i.path(a).map(Cm):void 0},Pm),Um("treeAncestors",function(e,t){const r=Em(e,this)[t];return r?r.ancestors().map(Cm):void 0},Pm),Um("vlSelectionTest",function(e,t,r){for(var n,i,a,o,s,u=this.context.data[e],f=u?u.values.value:[],l=u?u[um]&&u[um].value:void 0,c=r===tm,d=f.length,p=0;p<d;++p)if(n=f[p],l&&c){if(-1===(a=(i=i||{})[o=n.unit]||0))continue;if(s=fm(t,n),i[o]=s?-1:++a,s&&1===l.size)return!0;if(!s&&a===l.get(o).count)return!1}else if(c^(s=fm(t,n)))return s;return d&&c},pm),Um("vlSelectionResolve",function(e,t){for(var r,n,i,a,o,s,u,f,l,c,d,p=this.context.data[e],m=p?p.values.value:[],h={},g={},y=m.length,b=0;b<y;++b)for(a=(r=m[b]).unit,n=r.fields,i=r.values,c=0,d=n.length;c<d;++c)o=n[c],u=(s=h[o.field]||(h[o.field]={}))[a]||(s[a]=[]),g[o.field]=f=o.type.charAt(0),l=lm[f+"_union"],s[a]=l(u,fe(i[c]));return t=t||rm,Object.keys(h).forEach(function(e){h[e]=Object.keys(h[e]).map(function(t){return h[e][t]}).reduce(function(r,n){return void 0===r?n:lm[g[e]+"_"+t](r,n)})}),h},pm);const Wm={blacklist:["_"],whitelist:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_["+D(Bm+e)+"]"},functions:function(e){const t=em(e);Im.forEach(e=>t[e]=Vm+e);for(let e in Tm)t[e]=Lm+e;return t},constants:Zp,visitors:Nm};var Gm=function(e){var t=(e=e||{}).whitelist?Pe(e.whitelist):{},r=e.blacklist?Pe(e.blacklist):{},n=e.constants||Zp,i=(e.functions||em)(c),a=e.globalvar,o=e.fieldvar,s={},u={},f=0,l=ce(a)?a:function(e){return a+'["'+e+'"]'};function c(e){if(F(e))return e;var t=d[e.type];return null==t&&k("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var i=e.name;return f>0?i:r.hasOwnProperty(i)?k("Illegal identifier: "+i):n.hasOwnProperty(i)?n[i]:t.hasOwnProperty(i)?i:(s[i]=1,l(i))},MemberExpression:function(e){var t=!e.computed,r=c(e.object);t&&(f+=1);var n=c(e.property);return r===o&&(u[n]=1),t&&(f-=1),r+(t?"."+n:"["+n+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&k("Illegal callee type: "+e.callee.type);var t=e.callee.name,r=e.arguments,n=i.hasOwnProperty(t)&&i[t];return n||k("Unrecognized function: "+t),ce(n)?n(r):n+"("+r.map(c).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(c).join(",")+"]"},BinaryExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+c(e.argument)+")"},ConditionalExpression:function(e){return"("+c(e.test)+"?"+c(e.consequent)+":"+c(e.alternate)+")"},LogicalExpression:function(e){return"("+c(e.left)+e.operator+c(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(c).join(",")+"}"},Property:function(e){f+=1;var t=c(e.key);return f-=1,t+":"+c(e.value)}};function p(e){var t={code:c(e),globals:Object.keys(s),fields:Object.keys(u)};return s={},u={},t}return p.functions=i,p.constants=n,p}(Wm);function Hm(e,t,r){";"!==t[t.length-1]&&(t="return("+t+");");var n=Function.apply(null,e.concat(t));return r&&r.functions?n.bind(r.functions):n}function Xm(e,t){return Hm(["event"],e,t)}function Jm(e,t){return Hm(["item","_"],e,t)}function Ym(e,t,r){var n,i;for(n in r=r||{},e)i=e[n],r[n]=A(i)?i.map(function(e){return Km(e,t,r)}):Km(i,t,r);return r}function Km(e,t,r){if(!e||!w(e))return e;for(var n,i=0,a=Qm.length;i<a;++i)if(n=Qm[i],e.hasOwnProperty(n.key))return n.parse(e,t,r);return e}var Qm=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||k("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var r="k:"+e.$key+"_"+!!e.$flat;return t.fn[r]||(t.fn[r]=Fe(e.$key,e.$flat))}},{key:"$expr",parse:function(e,t,r){e.$params&&Ym(e.$params,t,r);var n="e:"+e.$expr+"_"+e.$name;return t.fn[n]||(t.fn[n]=O(function(e,t){return Hm(["datum","_"],e,t)}(e.$expr,t),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var r="f:"+e.$field+"_"+e.$name;return t.fn[r]||(t.fn[r]=C(e.$field,e.$name))}},{key:"$encode",parse:function(e,t){var r,n,i=e.$encode,a={};for(r in i)n=i[r],a[r]=O(Jm(n.$expr,t),n.$fields),a[r].output=n.$output;return a}},{key:"$compare",parse:function(e,t){var r="c:"+e.$compare+"_"+e.$order,n=fe(e.$compare).map(function(e){return e&&e.$tupleid?Ue:e});return t.fn[r]||(t.fn[r]=de(n,e.$order))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var r=e.$subflow;return function(e,n,i){var a=rh(r,t.fork()),o=a.get(r.operators[0].id),s=a.signals.parent;return s&&s.set(i),o}}},{key:"$tupleid",parse:function(){return Ue}}];function Zm(e){return(e+"").toLowerCase()}function eh(e,t){"operator"!==Zm(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?function(e,t){return Hm(["_"],e,t)}(e.update,t):null)}function th(e,t){var r=w(r=e.source)?r.$ref:r,n=t.get(r),i=null,a=e.update,o=void 0;n||k("Source not defined: "+e.source),i=e.target&&e.target.$expr?Xm(e.target.$expr,t):t.get(e.target),a&&a.$expr&&(a.$params&&(o=Ym(a.$params,t)),a=function(e,t){return Hm(["_","event"],e,t)}(a.$expr,t)),t.update(e,n,i,a,o)}function rh(e,t){var r=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),r.forEach(function(e){eh(e,t)}),r.forEach(function(e){!function(e,t){if(e.params){var r=t.get(e.id);r||k("Invalid operator id: "+e.id),t.dataflow.connect(r,r.parameters(Ym(e.params,t),e.react,e.initonly))}}(e,t)}),(e.streams||[]).forEach(function(e){!function(e,t){var r,n=null!=e.filter?Xm(e.filter,t):void 0,i=null!=e.stream?t.get(e.stream):void 0;e.source?i=t.events(e.source,e.type,n):e.merge&&(i=(r=e.merge.map(t.get.bind(t)))[0].merge.apply(r[0],r.slice(1))),e.between&&(r=e.between.map(t.get.bind(t)),i=i.between(r[0],r[1])),e.filter&&(i=i.filter(n)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&k("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),t.stream(e,i)}(e,t)}),(e.updates||[]).forEach(function(e){th(e,t)}),t.resolve()}var nh={skip:!0};function ih(e,t,r){return new ah(e,t,r)}function ah(e,t,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},r&&(this.functions=Object.create(r),this.functions.context=this)}function oh(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.functions=e.functions,this.events=e.events,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}ah.prototype=oh.prototype={fork:function(){var e=new oh(this);return(this.subcontext||(this.subcontext=[])).push(e),e},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var r,n=this,i=n.dataflow;if(n.set(e.id,t),"collect"===Zm(e.type)&&(r=e.value)&&(r.$ingest?i.ingest(t,r.$ingest,r.$format):r.$request?i.preload(t,r.$request,r.$format):i.pulse(t,i.changeset().insert(r))),e.root&&(n.root=t),e.parent){var a=n.get(e.parent.$ref);a?(i.connect(a,[t]),t.targets().add(a)):(n.unresolved=n.unresolved||[]).push(function(){a=n.get(e.parent.$ref),i.connect(a,[t]),t.targets().add(a)})}if(e.signal&&(n.signals[e.signal]=t),e.scale&&(n.scales[e.scale]=t),e.data)for(var o in e.data)r=n.data[o]||(n.data[o]={}),e.data[o].forEach(function(e){r[e]=t})},resolve:function(){return(this.unresolved||[]).forEach(function(e){e()}),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[Zm(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,r,n,i){this.dataflow.on(t,r,n,i,e.options)},getState:function(e){var t=this,r={};if(e.signals){var n=r.signals={};Object.keys(t.signals).forEach(function(r){var i=t.signals[r];e.signals(r,i)&&(n[r]=i.value)})}if(e.data){var i=r.data={};Object.keys(t.data).forEach(function(r){var n=t.data[r];e.data(r,n)&&(i[r]=n.input.value)})}return t.subcontext&&!1!==e.recurse&&(r.subcontext=t.subcontext.map(function(t){return t.getState(e)})),r},setState:function(e){var t=this,r=t.dataflow,n=e.data,i=e.signals;Object.keys(i||{}).forEach(function(e){r.update(t.signals[e],i[e],nh)}),Object.keys(n||{}).forEach(function(e){r.pulse(t.data[e].input,r.changeset().remove(B).insert(n[e]))}),(e.subcontext||[]).forEach(function(e,r){var n=t.subcontext[r];n&&n.setState(e)})}};var sh="width",uh="height",fh="padding",lh={skip:!0};function ch(e,t){var r=e.autosize(),n=e.padding();return t-(r&&r.contains===fh?n.left+n.right:0)}function dh(e,t){var r=e.autosize(),n=e.padding();return t-(r&&r.contains===fh?n.top+n.bottom:0)}function ph(e,t){return t.modified&&A(t.input.value)&&e.indexOf("_:vega:_")}function mh(e,t){return!("parent"===e||t instanceof rr.proxy)}function hh(e,t,r,n){var i=e.element();i&&i.setAttribute("title",function(e){return null==e?"":A(e)?gh(e):w(e)&&!_e(e)?(t=e,Object.keys(t).map(function(e){var r=t[e];return e+": "+(A(r)?gh(r):yh(r))}).join("\n")):e+"";var t}(n))}function gh(e){return"["+e.map(yh).join(", ")+"]"}function yh(e){return A(e)?"[…]":w(e)&&!_e(e)?"{…}":e}function bh(e,t){t=t||{},Kt.call(this),this.loader(t.loader||this._loader),this.logLevel(t.logLevel||0),this._el=null,this._elBind=null,this._renderType=t.renderer||Is.Canvas,this._scenegraph=new No;var r=this._scenegraph.root;this._renderer=null,this._tooltip=t.tooltip||hh,this._redraw=!0,this._handler=(new is).scene(r),this._preventDefault=!1,this._timers=[],this._eventListeners=[],this._resizeListeners=[];var n,i,a=function(e,t,r){return rh(t,ih(e,rr,r||Tm))}(this,e,t.functions);this._runtime=a,this._signals=a.signals,this._bind=(e.bindings||[]).map(function(e){return{state:null,param:he({},e)}}),a.root&&a.root.set(r),r.source=a.data.root.input,this.pulse(a.data.root.input,this.changeset().insert(r.items)),this._background=a.background||null,this._eventConfig=(n=a.eventConfig,(i=(n=he({},n)).defaults)&&(A(i.prevent)&&(i.prevent=Pe(i.prevent)),A(i.allow)&&(i.allow=Pe(i.allow))),n),this._width=this.width(),this._height=this.height(),this._viewWidth=ch(this,this._width),this._viewHeight=dh(this,this._height),this._origin=[0,0],this._resize=0,this._autosize=1,function(e){var t=e._signals,r=t[sh],n=t[uh],i=t[fh];function a(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,function(t){e._width=t.size,e._viewWidth=ch(e,t.size),a()},{size:r}),e._resizeHeight=e.add(null,function(t){e._height=t.size,e._viewHeight=dh(e,t.size),a()},{size:n});var o=e.add(null,a,{pad:i});e._resizeWidth.rank=r.rank+1,e._resizeHeight.rank=n.rank+1,o.rank=i.rank+1}(this),Bc(this)}var vh=$e(bh,Kt);function Oh(e,t){return e._signals.hasOwnProperty(t)?e._signals[t]:k("Unrecognized signal name: "+D(t))}function $h(e,t){var r=(e._targets||[]).filter(function(e){var r=e._update;return r&&r.handler===t});return r.length?r[0]:null}function xh(e,t,r,n){var i=$h(r,n);return i||((i=ud(this,function(){n(t,r.value)})).handler=n,e.on(r,null,i)),e}function kh(e,t,r){var n=$h(t,r);return n&&t._targets.remove(n),e}function _h(e){return+e||0}vh.evaluate=async function(e,t,r){if(await Kt.prototype.evaluate.call(this,e,t),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=Ic(n=this),a=Rc(n),o=Tc(n),n._renderer.background(n._background),n._renderer.resize(a,o,i),n._handler.origin(i),n._resizeListeners.forEach(function(e){try{e(a,o)}catch(e){n.error(e)}})),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(e){this.error(e)}var n,i,a,o;return r&&Ie(this,r),this},vh.dirty=function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},vh.container=function(){return this._el},vh.scenegraph=function(){return this._scenegraph},vh.origin=function(){return this._origin.slice()},vh.signal=function(e,t,r){var n=Oh(this,e);return 1===arguments.length?n.value:this.update(n,t,r)},vh.background=function(e){return arguments.length?(this._background=e,this._resize=1,this):this._background},vh.width=function(e){return arguments.length?this.signal("width",e):this.signal("width")},vh.height=function(e){return arguments.length?this.signal("height",e):this.signal("height")},vh.padding=function(e){return arguments.length?this.signal("padding",e):this.signal("padding")},vh.autosize=function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},vh.renderer=function(e){return arguments.length?(Ls(e)||k("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},vh.tooltip=function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},vh.loader=function(e){return arguments.length?(e!==this._loader&&(Kt.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},vh.resize=function(){return this._autosize=1,this.touch(Oh(this,"autosize"))},vh._resetRenderer=function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},vh._resizeView=function(e,t,r,n,i,a){this.runAfter(function(o){var s=0;o._autosize=0,o.width()!==r&&(s=1,o.signal(sh,r,lh),o._resizeWidth.skip(!0)),o.height()!==n&&(s=1,o.signal(uh,n,lh),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===i[0]&&o._origin[1]===i[1]||(o._resize=1,o._origin=i),s&&o.run("enter"),a&&o.runAfter(e=>e.resize())},!1,1)},vh.addEventListener=function(e,t,r){var n=t;return r&&!1===r.trap||((n=ud(this,t)).raw=t),this._handler.on(e,n),this},vh.removeEventListener=function(e,t){for(var r,n,i=this._handler.handlers(e),a=i.length;--a>=0;)if(n=i[a].type,r=i[a].handler,e===n&&(t===r||t===r.raw)){this._handler.off(n,r);break}return this},vh.addResizeListener=function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},vh.removeResizeListener=function(e){var t=this._resizeListeners,r=t.indexOf(e);return r>=0&&t.splice(r,1),this},vh.addSignalListener=function(e,t){return xh(this,e,Oh(this,e),t)},vh.removeSignalListener=function(e,t){return kh(this,Oh(this,e),t)},vh.addDataListener=function(e,t){return xh(this,e,Pc(this,e).values,t)},vh.removeDataListener=function(e,t){return kh(this,Pc(this,e).values,t)},vh.preventDefault=function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},vh.timer=function(e,t){this._timers.push(Object(v.a)(function(t){e({timestamp:Date.now(),elapsed:t})},t))},vh.events=function(e,t,r){var n,i=this,a=new st(r),o=function(r,n){i.runAsync(null,()=>{e===Lc&&function(e,t){var r=e._eventConfig.defaults,n=r&&r.prevent,i=r&&r.allow;return!1!==n&&!0!==i&&(!0===n||!1===i||(n?n[t]:i?!i[t]:e.preventDefault()))}(i,t)&&r.preventDefault(),a.receive(Vc(i,r,n))})};if(e===Nc)i.timer(o,t);else if(e===Lc)i.addEventListener(t,o,Wc);else if(e===Uc?"undefined"!=typeof window&&(n=[window]):"undefined"!=typeof document&&(n=document.querySelectorAll(e)),n){for(var s=0,u=n.length;s<u;++s)n[s].addEventListener(t,o);i._eventListeners.push({type:t,sources:n,handler:o})}else i.warn("Can not resolve event source: "+e);return a},vh.finalize=function(){var e,t,r,n=this._tooltip,i=this._timers,a=this._eventListeners;for(e=i.length;--e>=0;)i[e].stop();for(e=a.length;--e>=0;)for(t=(r=a[e]).sources.length;--t>=0;)r.sources[t].removeEventListener(r.type,r.handler);return n&&n.call(this,this._handler,null,null,null),this},vh.hover=function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",Gc),Hc,Xc(e)),this.on(this.events("view","mouseout",Gc),Hc,Xc(t)),this},vh.data=function(e){return Pc(this,e).values.value},vh.change=zc,vh.insert=function(e,t){return zc.call(this,e,Ke().insert(t))},vh.remove=function(e,t){return zc.call(this,e,Ke().remove(t))},vh.scale=function(e){var t=this._runtime.scales;return t.hasOwnProperty(e)||k("Unrecognized scale or projection: "+e),t[e].value},vh.initialize=function(e,t){var r,n,i=this,a=i._renderType,o=Ls(a);return e=i._el=e?fd(i,e):null,o||i.error("Unrecognized renderer type: "+a),r=o.handler||is,n=e?o.renderer:o.headless,i._renderer=n?sd(i,i._renderer,e,n):null,i._handler=function(e,t,r,n){var i=new n(e.loader(),ud(e,e.tooltip())).scene(e.scenegraph().root).initialize(r,Ic(e),e);return t&&t.handlers().forEach(function(e){i.on(e.type,e.handler)}),i}(i,i._handler,e,r),i._redraw=!0,e&&(t=t?i._elBind=fd(i,t):e.appendChild(Jc("div",{class:"vega-bindings"})),i._bind.forEach(function(e){e.param.element&&(e.element=fd(i,e.param.element))}),i._bind.forEach(function(e){ed(i,e.element||t,e)})),i},vh.toImageURL=async function(e,t){e!==Is.Canvas&&e!==Is.SVG&&e!==Is.PNG&&k("Unrecognized image type: "+e);const r=await ld(this,e,t);return e===Is.SVG?(n=r.svg(),i=new Blob([n],{type:"image/svg+xml"}),window.URL.createObjectURL(i)):r.canvas().toDataURL("image/png");var n,i},vh.toCanvas=async function(e,t){return(await ld(this,Is.Canvas,e,t)).canvas()},vh.toSVG=async function(e){return(await ld(this,Is.SVG,e)).svg()},vh.getState=function(e){return this._runtime.getState(e||{data:ph,signals:mh,recurse:!0})},vh.setState=function(e){return this.runAsync(null,t=>{t._trigger=!1,t._runtime.setState(e)},e=>{e._trigger=!0}),this};var Ah="outer",wh=["value","update","init","react","bind"];function Fh(e,t){k(e+' for "outer" push: '+D(t))}function Dh(e,t){var r=e.name;if(e.push===Ah)t.signals[r]||Fh("No prior signal definition",r),wh.forEach(function(t){void 0!==e[t]&&Fh("Invalid property ",t)});else{var n=t.addSignal(r,e.value);!1===e.react&&(n.react=!1),e.bind&&t.addBinding(r,e.bind)}}function Ch(e,t,r){var n,i,a={};try{n=function(e){pd=0,md=(dd=e).length,hd=null,Fp();var t=Qp();if(hd.type!==Ed)throw new Error("Unexpect token after expression.");return t}(e=F(e)?e:D(e)+"")}catch(t){k("Expression parse error: "+e)}return n.visit(function(e){if(e.type===xd){var r=e.callee.name,n=Wm.visitors[r];n&&n(r,e.arguments,t,a)}}),(i=Gm(n)).globals.forEach(function(e){var r=Bm+e;!a.hasOwnProperty(r)&&t.getSignal(e)&&(a[r]=t.signalRef(e))}),{$expr:r?r+"return("+i.code+");":i.code,$fields:i.fields,$params:a}}function Eh(e,t,r,n){this.id=-1,this.type=e,this.value=t,this.params=r,n&&(this.parent=n)}function Sh(e,t,r,n){return new Eh(e,t,r,n)}function jh(e,t){return Sh("operator",e,t)}function Mh(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}var qh={$tupleid:1,toString:function(){return":_tupleid_:"}};function Bh(e,t){return t?{$field:e,$name:t}:{$field:e}}var Ph=Bh("key");function zh(e,t){return{$compare:e,$order:t}}var Rh="descending";function Th(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var Ih="scope",Vh="view";function Lh(e){return e&&e.signal}function Nh(e){if(Lh(e))return!0;if(w(e))for(var t in e)if(Nh(e[t]))return!0;return!1}function Uh(e,t){return null!=e?e:t}function Wh(e){return e&&e.signal||e}var Gh="timer";function Hh(e,t){return(e.merge?Xh:e.stream?Jh:e.type?Yh:k("Invalid stream specification: "+D(e)))(e,t)}function Xh(e,t){var r=Kh({merge:e.merge.map(function(e){return Hh(e,t)})},e,t);return t.addStream(r).id}function Jh(e,t){var r=Kh({stream:Hh(e.stream,t)},e,t);return t.addStream(r).id}function Yh(e,t){var r,n,i;return e.type===Gh?(r=t.event(Gh,e.throttle),e={between:e.between,filter:e.filter}):r=t.event((i=e.source)===Ih?Vh:i||Vh,e.type),n=Kh({stream:r},e,t),1===Object.keys(n).length?r:t.addStream(n).id}function Kh(e,t,r){var n,i,a,o,s=t.between;return s&&(2!==s.length&&k('Stream "between" parameter must have 2 entries: '+D(t)),e.between=[Hh(s[0],r),Hh(s[1],r)]),s=t.filter?fe(t.filter):[],(t.marktype||t.markname||t.markrole)&&s.push((n=t.marktype,i=t.markname,a=t.markrole,(o="event.item")+(n&&"*"!==n?"&&"+o+".mark.marktype==='"+n+"'":"")+(a?"&&"+o+".mark.role==='"+a+"'":"")+(i?"&&"+o+".mark.name==='"+i+"'":""))),t.source===Ih&&s.push("inScope(event.item)"),s.length&&(e.filter=Ch("("+s.join(")&&(")+")").$expr),null!=(s=t.throttle)&&(e.throttle=+s),null!=(s=t.debounce)&&(e.debounce=+s),t.consume&&(e.consume=!0),e}var Qh,Zh,eg="view",tg="[",rg="]",ng="{",ig="}",ag=":",og=",",sg="@",ug=">",fg=/[[\]{}]/,lg={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function cg(e,t,r,n,i){for(var a,o=0,s=e.length;t<s;++t){if(a=e[t],!o&&a===r)return t;i&&i.indexOf(a)>=0?--o:n&&n.indexOf(a)>=0&&++o}return t}function dg(e){for(var t=[],r=0,n=e.length,i=0;i<n;)i=cg(e,i,og,tg+ng,rg+ig),t.push(e.substring(r,i).trim()),r=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function pg(e){return"["===e[0]?function(e){var t,r,n=e.length,i=1;if((i=cg(e,i,rg,tg,rg))===n)throw"Empty between selector: "+e;if(2!==(t=dg(e.substring(1,i))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(i+1).trim())[0]!==ug)throw"Expected '>' after between selector: "+e;if(t=t.map(pg),(r=pg(e.slice(1).trim())).between)return{between:t,stream:r};r.between=t;return r}(e):function(e){var t,r,n={source:Qh},i=[],a=[0,0],o=0,s=0,u=e.length,f=0;if(e[u-1]===ig){if(!((f=e.lastIndexOf(ng))>=0))throw"Unmatched right brace: "+e;try{a=function(e){var t=e.split(og);if(!e.length||t.length>2)throw e;return t.map(function(t){var r=+t;if(r!=r)throw e;return r})}(e.substring(f+1,u-1))}catch(t){throw"Invalid throttle specification: "+e}e=e.slice(0,f).trim(),u=e.length,f=0}if(!u)throw e;e[0]===sg&&(o=++f);(t=cg(e,f,ag))<u&&(i.push(e.substring(s,t).trim()),s=f=++t);if((f=cg(e,f,tg))===u)i.push(e.substring(s,u).trim());else if(i.push(e.substring(s,f).trim()),r=[],(s=++f)===u)throw"Unmatched left bracket: "+e;for(;f<u;){if((f=cg(e,f,rg))===u)throw"Unmatched left bracket: "+e;if(r.push(e.substring(s,f).trim()),f<u-1&&e[++f]!==tg)throw"Expected left bracket: "+e;s=++f}if(!(u=i.length)||fg.test(i[u-1]))throw"Invalid event selector: "+e;u>1?(n.type=i[1],o?n.markname=i[0].slice(1):(l=i[0],Zh.hasOwnProperty(l)?n.marktype=i[0]:n.source=i[0])):n.type=i[0];var l;"!"===n.type.slice(-1)&&(n.consume=!0,n.type=n.type.slice(0,-1));null!=r&&(n.filter=r);a[0]&&(n.throttle=a[0]);a[1]&&(n.debounce=a[1]);return n}(e)}var mg="var datum=event.item&&event.item.datum;";function hg(e,t,r){var n,i,a=e.events,o=e.update,s=e.encode,u=[];a||k("Signal update missing events specification."),F(a)&&(a=function(e,t,r){return Qh=t||eg,Zh=r||lg,dg(e.trim()).map(pg)}(a,t.isSubscope()?Ih:Vh)),(a=fe(a).filter(function(e){return e.signal||e.scale?(u.push(e),0):1})).length&&u.push(a.length>1?{merge:a}:a[0]),null!=s&&(o&&k("Signal encode and update are mutually exclusive."),o="encode(item(),"+D(s)+")"),n=F(o)?Ch(o,t,mg):null!=o.expr?Ch(o.expr,t,mg):null!=o.value?o.value:null!=o.signal?{$expr:"_.value",$params:{value:t.signalRef(o.signal)}}:k("Invalid signal update specification."),i={target:r,update:n},e.force&&(i.options={force:!0}),u.forEach(function(e){t.addUpdate(he(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Hh(e,t)}}(e,t),i))})}function gg(e){return function(t,r,n){return Sh(e,r,t||void 0,n)}}var yg=gg("aggregate"),bg=gg("axisticks"),vg=gg("bound"),Og=gg("collect"),$g=gg("compare"),xg=gg("datajoin"),kg=gg("encode"),_g=gg("expression"),Ag=gg("facet"),wg=gg("field"),Fg=gg("key"),Dg=gg("legendentries"),Cg=gg("load"),Eg=gg("mark"),Sg=gg("multiextent"),jg=gg("multivalues"),Mg=gg("overlap"),qg=gg("params"),Bg=gg("prefacet"),Pg=gg("projection"),zg=gg("proxy"),Rg=gg("relay"),Tg=gg("render"),Ig=gg("scale"),Vg=gg("sieve"),Lg=gg("sortitems"),Ng=gg("viewlayout"),Ug=gg("values"),Wg=0;function Gg(e,t){var r=e.type||"linear";(function(e){switch(e){case Mu:case qu:case Bu:case Pu:case zu:case Ru:case Tu:case Iu:case Vu:case Nu:case Uu:case Wu:case Gu:case Hu:case Xu:case Ju:return!0}return!1})(r)||k("Unrecognized scale type: "+D(r)),t.addScale(e.name,{type:r,domain:void 0})}function Hg(e,t){var r,n,i=t.getScale(e.name).params;for(r in i.domain=Kg(e.domain,e,t),null!=e.range&&(i.range=function e(t,r,n){var i=t.range,a=r.config.range;if(i.signal)return r.signalRef(i.signal);if(F(i)){if(a&&a.hasOwnProperty(i))return t=he({},t,{range:a[i]}),e(t,r,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=tf(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:k("Unrecognized scale range value: "+D(i))}else{if(i.scheme)return n.scheme=A(i.scheme)?Jg(i.scheme,r):Xg(i.scheme,r),i.extent&&(n.schemeExtent=Jg(i.extent,r)),void(i.count&&(n.schemeCount=Xg(i.count,r)));if(i.step)return void(n.rangeStep=Xg(i.step,r));if(tf(t.type)&&!A(i))return Kg(i,t,r);A(i)||k("Unsupported range type: "+D(i))}return i.map(function(e){return Xg(e,r)})}(e,t,i)),null!=e.interpolate&&function(e,t){t.interpolate=Xg(e.type||e),null!=e.gamma&&(t.interpolateGamma=Xg(e.gamma))}(e.interpolate,i),null!=e.nice&&(i.nice=w(n=e.nice)?{interval:Xg(n.interval),step:Xg(n.step)}:Xg(n)),null!=e.bins&&(i.bins=function(e,t){return e.signal||A(e)?Jg(e,t):t.objectProperty(e)}(e.bins,t)),e)i.hasOwnProperty(r)||"name"===r||(i[r]=Xg(e[r],t))}function Xg(e,t){return w(e)?e.signal?t.signalRef(e.signal):k("Unsupported object: "+D(e)):e}function Jg(e,t){return e.signal?t.signalRef(e.signal):e.map(function(e){return Xg(e,t)})}function Yg(e){k("Can not find data set: "+D(e))}function Kg(e,t,r){if(e)return e.signal?r.signalRef(e.signal):(A(e)?function(e,t,r){return e.map(function(e){return Xg(e,r)})}:e.fields?function(e,t,r){var n=e.data,i=e.fields.reduce(function(e,t){return t=F(t)?{data:n,field:t}:A(t)||t.signal?function(e,t){var r="_:vega:_"+Wg++,n=Og({});if(A(e))n.value={$ingest:e};else if(e.signal){var i="setdata("+D(r)+","+e.signal+")";n.params.input=t.signalRef(i)}return t.addDataPipeline(r,[n,Vg({})]),{data:r,field:"data"}}(t,r):t,e.push(t),e},[]);return(tf(t.type)?function(e,t,r){var n,i,a,o;return n=r.map(function(e){var r=t.getData(e.data);return r||Yg(e.data),r.countsRef(t,e.field)}),i=t.add(yg({groupby:Ph,ops:["sum"],fields:[t.fieldRef("count")],as:["count"],pulse:n})),a=t.add(Og({pulse:Mh(i)})),o=t.add(Ug({field:Ph,sort:t.sortRef(Qg(e.sort,!0)),pulse:Mh(a)})),Mh(o)}:Ku(t.type)?function(e,t,r){var n=r.map(function(e){var r=t.getData(e.data);return r||Yg(e.data),r.domainRef(t,e.field)});return Mh(t.add(jg({values:n})))}:function(e,t,r){var n=r.map(function(e){var r=t.getData(e.data);return r||Yg(e.data),r.extentRef(t,e.field)});return Mh(t.add(Sg({extents:n})))})(e,r,i)}:function(e,t,r){var n=r.getData(e.data);n||Yg(e.data);return tf(t.type)?n.valuesRef(r,e.field,Qg(e.sort,!1)):Ku(t.type)?n.domainRef(r,e.field):n.extentRef(r,e.field)})(e,t,r);null==t.domainMin&&null==t.domainMax||k("No scale domain defined for domainMin/domainMax to override.")}function Qg(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field?k("Multiple domain scales can not sort by field."):t&&e.op&&"count"!==e.op&&k("Multiple domain scales support op count only."):k("No field provided for sort aggregate op: "+e.op):w(e)?e.field="key":e={field:"key"}),e}function Zg(e,t,r){return A(e)?e.map(function(e){return Zg(e,t,r)}):w(e)?e.signal?r.signalRef(e.signal):"fit"===t?e:k("Unsupported parameter object: "+D(e)):e}var ey="top",ty="left",ry="right",ny="bottom",iy="vertical",ay="start",oy="end",sy="index",uy="label",fy="offset",ly="perc",cy="perc2",dy="size",py="value",my="guide-label",hy="guide-title",gy="group-title",yy="symbol",by="gradient",vy="discrete",Oy=["size","shape","fill","stroke","strokeWidth","strokeDash","opacity"],$y={name:1,interactive:1},xy=Pe(["rule"]),ky=Pe(["group","image","rect"]);function _y(e,t,r,n){var i=Ch(e,t);return i.$fields.forEach(function(e){n[e]=1}),he(r,i.$params),i.$expr}function Ay(e,t,r,n){return function e(t,r,n,i){var a,o,s;if(t.signal)a="datum",s=_y(t.signal,r,n,i);else if(t.group||t.parent){for(o=Math.max(1,t.level||1),a="item";o-- >0;)a+=".mark.group";t.parent?(s=t.parent,a+=".datum"):s=t.group}else t.datum?(a="datum",s=t.datum):k("Invalid field reference: "+D(t));t.signal||(F(s)?(i[s]=1,s=_(s).map(D).join("][")):s=e(s,r,n,i));return a+"["+s+"]"}(w(e)?e:{datum:e},t,r,n)}function wy(e,t,r,n,i){var a,o,s,u=Fy(e.scale,r,n,i);return null!=e.range?(o=u+".range()",t=0===(a=+e.range)?o+"[0]":"($="+o+","+(1===a?"$[$.length-1]":"$[0]+"+a+"*($[$.length-1]-$[0])")+")"):(void 0!==t&&(t=u+"("+t+")"),e.band&&(s=function(e,t){if(!F(e))return-1;var r=t.scaleType(e);return"band"===r||"point"===r?1:0}(e.scale,r))&&(a=(o=u+".bandwidth")+"()"+(1===(a=+e.band)?"":"*"+a),s<0&&(a="("+o+"?"+a+":0)"),t=(t?t+"+":"")+a,e.extra&&(t="(datum.extra?"+u+"(datum.extra.value):"+t+")")),null==t&&(t="0")),t}function Fy(e,t,r,n){var i;if(F(e))i=qm+e,r.hasOwnProperty(i)||(r[i]=t.scaleRef(e)),i=D(i);else{for(i in t.scales)r[qm+i]=t.scaleRef(i);i=D(qm)+"+"+(e.signal?"("+_y(e.signal,t,r,n)+")":Ay(e,t,r,n))}return"_["+i+"]"}function Dy(e,t,r,n){return w(e)?"("+Cy(null,e,t,r,n)+")":e}function Cy(e,t,r,n,i){if(null!=t.gradient)return function(e,t,r,n){return"this.gradient("+Fy(e.gradient,t,r,n)+","+D(e.start)+","+D(e.stop)+","+D(e.count)+")"}(t,r,n,i);var a=t.signal?_y(t.signal,r,n,i):t.color?function(e,t,r,n){function i(e,i,a,o){return"this."+e+"("+[Cy(null,i,t,r,n),Cy(null,a,t,r,n),Cy(null,o,t,r,n)].join(",")+").toString()"}return e.c?i("hcl",e.h,e.c,e.l):e.h||e.s?i("hsl",e.h,e.s,e.l):e.l||e.a?i("lab",e.l,e.a,e.b):e.r||e.g||e.b?i("rgb",e.r,e.g,e.b):null}(t.color,r,n,i):null!=t.field?Ay(t.field,r,n,i):void 0!==t.value?D(t.value):void 0;return null!=t.scale&&(a=wy(t,a,r,n,i)),void 0===a&&(a=null),null!=t.exponent&&(a="Math.pow("+a+","+Dy(t.exponent,r,n,i)+")"),null!=t.mult&&(a+="*"+Dy(t.mult,r,n,i)),null!=t.offset&&(a+="+"+Dy(t.offset,r,n,i)),t.round&&(a="Math.round("+a+")"),a}function Ey(e,t,r){return e+"["+D(t)+"]="+r+";"}function Sy(e,t,r,n,i){var a="";return t.forEach(function(e){var t=Cy(0,e,r,n,i);a+=e.test?_y(e.test,r,n,i)+"?"+t+":":t}),":"===U(a)&&(a+="null"),Ey("o",e,a)}function jy(e,t,r,n){var i,a,o={},s="var o=item,datum=o.datum,$;";for(i in e)a=e[i],A(a)?s+=Sy(i,a,n,r,o):s+=Ey("o",i,Cy(0,a,n,r,o));return s+=function(e,t){var r="";return xy[t]?r:(e.x2&&(e.x?(ky[t]&&(r+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),r+="o.width=o.x2-o.x;"):r+="o.x=o.x2-(o.width||0);"),e.xc&&(r+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(ky[t]&&(r+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),r+="o.height=o.y2-o.y;"):r+="o.y=o.y2-(o.height||0);"),e.yc&&(r+="o.y=o.yc-(o.height||0)/2;"),r)}(e,t),{$expr:s+="return 1;",$fields:Object.keys(o),$output:Object.keys(e)}}var My="mark",qy="frame",By="scope",Py="axis",zy="axis-domain",Ry="axis-grid",Ty="axis-label",Iy="axis-tick",Vy="axis-title",Ly="legend",Ny="legend-band",Uy="legend-entry",Wy="legend-gradient",Gy="legend-label",Hy="legend-symbol",Xy="legend-title",Jy="title";function Yy(e){return w(e)?he({},e):{value:e}}function Ky(e,t,r,n){return null!=r?(w(r)&&!A(r)?e.update[t]=r:e[n||"enter"][t]={value:r},1):0}function Qy(e,t,r){for(var n in t)r&&r.hasOwnProperty(n)||(e[n]=he(e[n]||{},t[n]));return e}function Zy(e,t,r,n,i,a){var o,s;for(s in(a=a||{}).encoders={$encode:o={}},e=function(e,t,r,n,i){var a,o,s={};"legend"!=r&&0!==String(r).indexOf("axis")||(r=null);for(a in o=r===qy?i.group:r===My?he({},i.mark,i[t]):null)tb(a,e)||("fill"===a||"stroke"===a)&&(tb("fill",e)||tb("stroke",e))||(s[a]=eb(o[a]));return fe(n).forEach(function(t){var r=i.style&&i.style[t];for(var n in r)tb(n,e)||(s[n]=eb(r[n]))}),(e=he({},e)).enter=he(s,e.enter),e}(e,t,r,n,i.config))o[s]=jy(e[s],t,a,i);return a}function eb(e){return e&&e.signal?{signal:e.signal}:{value:e}}function tb(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}function rb(e,t,r,n,i,a,o){return{type:e,name:o?o.name:void 0,role:t,style:o&&o.style||r,key:n,from:i,interactive:!(!o||!o.interactive),encode:Qy(a,o,$y)}}function nb(e,t,r){return Uh(t[e],r[e])}function ib(e,t){return Uh(e.direction,t)===iy}function ab(e,t){return Uh(e.gradientLength,t.gradientLength||t.gradientWidth)}function ob(e,t){return Uh(e.gradientThickness,t.gradientThickness||t.gradientHeight)}function sb(e,t){return Uh(e.columns,Uh(t.columns,+ib(e,t.symbolDirection)))}function ub(e,t){var r=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return r&&r.signal?r:r?r.value:null}var fb="group",lb="rect",cb="rule",db="symbol",pb="text";function mb(e,t,r,n){var i,a,o,s,u,f,l={value:0},c=ib(e,r.gradientDirection),d=ob(e,r),p=ab(e,r);return c?(o=[0,1],s=[0,0],u=d,f=p):(o=[0,0],s=[1,0],u=p,f=d),Ky(i={enter:a={opacity:l,x:l,y:l,width:Yy(u),height:Yy(f)},update:he({},a,{opacity:{value:1},fill:{gradient:t,start:o,stop:s}}),exit:{opacity:l}},"stroke",nb("gradientStrokeColor",e,r)),Ky(i,"strokeWidth",nb("gradientStrokeWidth",e,r)),Ky(i,"opacity",nb("gradientOpacity",e,r),"update"),rb(lb,Wy,null,void 0,void 0,i,n)}function hb(e,t,r,n,i){var a,o,s,u,f,l,c={value:0},d=ib(e,r.gradientDirection),p=ob(e,r),m=ab(e,r),h="";return d?(s="y",f="y2",u="x",l="width",h="1-"):(s="x",f="x2",u="y",l="height"),(o={opacity:c,fill:{scale:t,field:py}})[s]={signal:h+"datum."+ly,mult:m},o[u]=c,o[f]={signal:h+"datum."+cy,mult:m},o[l]=Yy(p),Ky(a={enter:o,update:he({},o,{opacity:{value:1}}),exit:{opacity:c}},"stroke",nb("gradientStrokeColor",e,r)),Ky(a,"strokeWidth",nb("gradientStrokeWidth",e,r)),Ky(a,"opacity",nb("gradientOpacity",e,r),"update"),rb(lb,Ny,null,py,i,a,n)}var gb="datum."+ly+'<=0?"left":datum.'+ly+'>=1?"right":"center"',yb="datum."+ly+'<=0?"bottom":datum.'+ly+'>=1?"top":"middle"';function bb(e,t,r,n){var i,a,o,s,u,f={value:0},l=ib(e,t.gradientDirection),c=Yy(ob(e,t)),d=ab(e,t),p=nb("labelOverlap",e,t),m=nb("labelSeparation",e,t),h="";return Ky(i={enter:a={opacity:f},update:o={opacity:{value:1},text:{field:uy}},exit:{opacity:f}},"fill",nb("labelColor",e,t)),Ky(i,"font",nb("labelFont",e,t)),Ky(i,"fontSize",nb("labelFontSize",e,t)),Ky(i,"fontStyle",nb("labelFontStyle",e,t)),Ky(i,"fontWeight",nb("labelFontWeight",e,t)),Ky(i,"fillOpacity",nb("labelOpacity",e,t)),Ky(i,"limit",Uh(e.labelLimit,t.gradientLabelLimit)),l?(a.align={value:"left"},a.baseline=o.baseline={signal:yb},s="y",u="x",h="1-"):(a.align=o.align={signal:gb},a.baseline={value:"top"},s="x",u="y"),a[s]=o[s]={signal:h+"datum."+ly,mult:d},a[u]=o[u]=c,c.offset=Uh(e.labelOffset,t.gradientLabelOffset)||0,e=rb(pb,Gy,my,py,n,i,r),p&&(e.overlap={separation:m,method:p,order:"datum."+sy}),e}function vb(e,t,r,n,i,a,o,s){return{type:fb,name:r,role:e,style:t,from:n,interactive:i||!1,encode:a,marks:o,layout:s}}var Ob={value:0};function $b(e,t,r,n,i){var a,o,s,u,f,l,c,d=r.entries,p=!(!d||!d.interactive),m=d?d.name:void 0,h=nb("clipHeight",e,t),g=nb("symbolOffset",e,t),y={data:"value"},b={},v=i+"?datum."+fy+":datum."+dy,O=h?Yy(h):{field:dy},$="datum."+sy,x="max(1,"+i+")";return O.mult=.5,b={enter:a={opacity:Ob,x:{signal:v,mult:.5,offset:g},y:O},update:o={opacity:{value:1},x:a.x,y:a.y},exit:{opacity:Ob}},e.fill||(Ky(b,"fill",t.symbolBaseFillColor),Ky(b,"stroke",t.symbolBaseStrokeColor)),Ky(b,"shape",nb("symbolType",e,t)),Ky(b,"size",nb("symbolSize",e,t)),Ky(b,"strokeWidth",nb("symbolStrokeWidth",e,t)),Ky(b,"fill",nb("symbolFillColor",e,t)),Ky(b,"stroke",nb("symbolStrokeColor",e,t)),Ky(b,"opacity",nb("symbolOpacity",e,t),"update"),Oy.forEach(function(t){e[t]&&(o[t]=a[t]={scale:e[t],field:py})}),u=rb(db,Hy,null,py,y,b,r.symbols),h&&(u.clip=!0),(s=Yy(g)).offset=nb("labelOffset",e,t),Ky(b={enter:a={opacity:Ob,x:{signal:v,offset:s},y:O},update:o={opacity:{value:1},text:{field:uy},x:a.x,y:a.y},exit:{opacity:Ob}},"align",nb("labelAlign",e,t)),Ky(b,"baseline",nb("labelBaseline",e,t)),Ky(b,"fill",nb("labelColor",e,t)),Ky(b,"font",nb("labelFont",e,t)),Ky(b,"fontSize",nb("labelFontSize",e,t)),Ky(b,"fontStyle",nb("labelFontStyle",e,t)),Ky(b,"fontWeight",nb("labelFontWeight",e,t)),Ky(b,"limit",nb("labelLimit",e,t)),Ky(b,"fillOpacity",nb("labelOpacity",e,t)),f=rb(pb,Gy,my,py,y,b,r.labels),b={enter:{noBound:{value:!0},width:Ob,height:h?Yy(h):Ob,opacity:Ob},exit:{opacity:Ob},update:o={opacity:{value:1},row:{signal:null},column:{signal:null}}},ib(e,t.symbolDirection)?(l="ceil(item.mark.items.length/"+x+")",o.row.signal=$+"%"+l,o.column.signal="floor("+$+"/"+l+")",c={field:["row",$]}):(o.row.signal="floor("+$+"/"+x+")",o.column.signal=$+"%"+x,c={field:$}),o.column.signal=i+"?"+o.column.signal+":"+$,(e=vb(By,null,m,n={facet:{data:n,name:"value",groupby:sy}},p,Qy(b,d,$y),[u,f])).sort=c,e}function xb(e,t){var r;return w(e)&&(e.signal?r=e.signal:e.path?r="pathShape("+kb(e.path)+")":e.sphere&&(r="geoShape("+kb(e.sphere)+', {type: "Sphere"})')),r?t.signalRef(r):!!e}function kb(e){return w(e)&&e.signal?e.signal:D(e)}function _b(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")?e.type===fb?By:t||My:t}function Ab(e){return{marktype:e.type,name:e.name||void 0,role:e.role||_b(e),zindex:+e.zindex||void 0}}function wb(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function Fb(e,t){var r=nr(e.type);r||k("Unrecognized transform type: "+D(e.type));var n=Sh(r.type.toLowerCase(),null,Db(r,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(n)),n.metadata=r.metadata||{},n}function Db(e,t,r){var n,i,a,o={};for(i=0,a=e.params.length;i<a;++i)o[(n=e.params[i]).name]=Cb(n,t,r);return o}function Cb(e,t,r){var n=e.type,i=t[e.name];return"index"===n?function(e,t,r){F(t.from)||k('Lookup "from" parameter must be a string literal.');return r.getData(t.from).lookupRef(r,t.key)}(0,t,r):void 0!==i?"param"===n?function(e,t,r){var n=t[e.name];return e.array?(A(n)||k("Expected an array of sub-parameters. Instead: "+D(n)),n.map(function(t){return Sb(e,t,r)})):Sb(e,n,r)}(e,t,r):"projection"===n?r.projectionRef(t[e.name]):e.array&&!Lh(i)?i.map(function(t){return Eb(e,t,r)}):Eb(e,i,r):void(e.required&&k("Missing required "+D(t.type)+" parameter: "+D(e.name)))}function Eb(e,t,r){var n=e.type;if(Lh(t))return jb(n)?k("Expression references can not be signals."):Mb(n)?r.fieldRef(t):qb(n)?r.compareRef(t):r.signalRef(t.signal);var i,a=e.expr||Mb(n);return a&&((i=t)&&i.expr)?r.exprRef(t.expr,t.as):a&&function(e){return e&&e.field}(t)?Bh(t.field,t.as):jb(n)?Ch(t,r):function(e){return"data"===e}(n)?Mh(r.getData(t).values):Mb(n)?Bh(t):qb(n)?r.compareRef(t):t}function Sb(e,t,r){var n,i,a,o,s;for(o=0,s=e.params.length;o<s;++o){for(a in(i=e.params[o]).key)if(i.key[a]!==t[a]){i=null;break}if(i)break}return i||k("Unsupported parameter: "+D(t)),n=he(Db(i,t,r),i.key),Mh(r.add(qg(n)))}function jb(e){return"expr"===e}function Mb(e){return"field"===e}function qb(e){return"compare"===e}function Bb(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:Mh(t.getData(e.data).output)}function Pb(e,t,r,n,i){this.scope=e,this.input=t,this.output=r,this.values=n,this.aggregate=i,this.index={}}Pb.fromEntries=function(e,t){var r=t.length,n=1,i=t[0],a=t[r-1],o=t[r-2],s=null;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);n<r;++n)t[n].params.pulse=Mh(t[n-1]),e.add(t[n]),"aggregate"===t[n].type&&(s=t[n]);return new Pb(e,i,o,a,s)};var zb=Pb.prototype;function Rb(e){return F(e)?e:null}function Tb(e,t,r){var n,i=Th(r.op,r.field);if(t.ops){for(var a=0,o=t.as.length;a<o;++a)if(t.as[a]===i)return}else t.ops=["count"],t.fields=[null],t.as=["count"];r.op&&(t.ops.push((n=r.op.signal)?e.signalRef(n):r.op),t.fields.push(e.fieldRef(r.field)),t.as.push(i))}function Ib(e,t,r,n,i,a,o){var s,u,f=t[r]||(t[r]={}),l=function(e){return w(e)?(e.order===Rh?"-":"+")+Th(e.op,e.field):""}(a),c=Rb(i);if(null!=c&&(e=t.scope,s=f[c+=l?"|"+l:""]),!s){var d=a?{field:Ph,pulse:t.countsRef(e,i,a)}:{field:e.fieldRef(i),pulse:Mh(t.output)};l&&(d.sort=e.sortRef(a)),u=e.add(Sh(n,void 0,d)),o&&(t.index[i]=u),s=Mh(u),null!=c&&(f[c]=s)}return s}function Vb(e,t,r){var n,i=e.remove,a=e.insert,o=e.toggle,s=e.modify,u=e.values,f=t.add(jh());n=Ch("if("+e.trigger+',modify("'+r+'",'+[a,i,o,s,u].map(function(e){return null==e?"null":e}).join(",")+"),0)",t),f.update=n.$expr,f.params=n.$params}function Lb(e,t){var r,n,i,a,o,s,u,f,l,c,d,p,m,h=_b(e),g=e.type===fb,y=e.from&&e.from.facet,b=e.layout||h===By||h===qy,v=h===My||b||y,O=e.overlap;i=function(e,t,r){var n,i,a,o,s;return e?(n=e.facet)&&(t||k("Only group marks can be faceted."),null!=n.field?o=s=Bb(n,r):(e.data?s=Mh(r.getData(e.data).aggregate):((a=Fb(he({type:"aggregate",groupby:fe(n.groupby)},n.aggregate),r)).params.key=r.keyRef(n.groupby),a.params.pulse=Bb(n,r),o=s=Mh(r.add(a))),i=r.keyRef(n.groupby,!0))):o=Mh(r.add(Og(null,[{}]))),o||(o=Bb(e,r)),{key:i,pulse:o,parent:s}}(e.from,g,t),l=Mh(n=t.add(xg({key:i.key||(e.key?Bh(e.key):void 0),pulse:i.pulse,clean:!g}))),n=a=t.add(Og({pulse:l})),n=t.add(Eg({markdef:Ab(e),interactive:wb(e.interactive,t),clip:xb(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:Mh(n)})),c=Mh(n),(n=t.add(kg(Zy(e.encode,e.type,h,e.style,t,{pulse:c})))).params.parent=t.encode(),e.transform&&e.transform.forEach(function(e){var r=Fb(e,t);(r.metadata.generates||r.metadata.changes)&&k("Mark transforms should not generate new data."),r.params.pulse=Mh(n),t.add(n=r)}),e.sort&&(n=t.add(Lg({sort:t.compareRef(e.sort,!0),pulse:Mh(n)}))),d=Mh(n),(y||b)&&(p=Mh(b=t.add(Ng({layout:t.objectProperty(e.layout),legendMargin:t.config.legendMargin,mark:c,pulse:d})))),m=Mh(o=t.add(vg({mark:c,pulse:p||d}))),g&&(v&&((r=t.operators).pop(),b&&r.pop()),t.pushState(d,p||m,l),y?function(e,t,r){var n,i,a,o,s=e.from.facet,u=s.name,f=Bb(s,t);s.name||k("Facet must have a name: "+D(s)),s.data||k("Facet must reference a data set: "+D(s)),s.field?o=t.add(Bg({field:t.fieldRef(s.field),pulse:f})):s.groupby?o=t.add(Ag({key:t.keyRef(s.groupby),group:Mh(t.proxy(r.parent)),pulse:f})):k("Facet must specify groupby or field: "+D(s)),i=(n=t.fork()).add(Og()),a=n.add(Vg({pulse:Mh(i)})),n.addData(u,new Pb(n,i,i,a)),n.addSignal("parent",null),o.params.subflow={$subflow:rv(e,n).toRuntime()}}(e,t,i):v?function(e,t,r){var n=t.add(Bg({pulse:r.pulse})),i=t.fork();i.add(Vg()),i.addSignal("parent",null),n.params.subflow={$subflow:rv(e,i).toRuntime()}}(e,t,i):rv(e,t),t.popState(),v&&(b&&r.push(b),r.push(o))),O&&(m=function(e,t,r){var n,i=e.method,a=e.bound,o=e.separation,s={separation:Lh(o)?r.signalRef(o.signal):o,method:Lh(i)?r.signalRef(i.signal):i,pulse:t};e.order&&(s.sort=r.compareRef({field:e.order}));a&&(n=a.tolerance,s.boundTolerance=Lh(n)?r.signalRef(n.signal):+n,s.boundScale=r.scaleRef(a.scale),s.boundOrient=a.orient);return Mh(r.add(Mg(s)))}(O,m,t)),s=t.add(Tg({pulse:m})),u=t.add(Vg({pulse:Mh(s)},void 0,t.parent())),null!=e.name&&(f=e.name,t.addData(f,new Pb(t,a,s,u)),e.on&&e.on.forEach(function(e){(e.insert||e.remove||e.toggle)&&k("Marks only support modify triggers."),Vb(e,t,f)}))}function Nb(e,t){var r,n,i,a,o,s,u,f,l,c=t.config.legend,d=e.encode||{},p=d.legend||{},m=p.name||void 0,h=p.interactive,g=p.style,y=Oy.reduce(function(t,r){return t||e[r]},0);return y||k("Missing valid scale for legend."),o=function(e,t){var r=e.type||yy;e.type||1!==function(e){return Oy.reduce(function(t,r){return t+(e[r]?1:0)},0)}(e)||!e.fill&&!e.stroke||(r=ef(t)?by:rf(t)?vy:yy);return r!==by?r:rf(t)?vy:by}(e,t.scaleType(y)),s={orient:nb("orient",e,c),title:null!=e.title,type:o},u=Mh(t.add(Og(null,[s]))),p=Qy(function(e,t){var r={enter:{},update:{}};return Ky(r,"offset",nb("offset",e,t)),Ky(r,"padding",nb("padding",e,t)),Ky(r,"titlePadding",nb("titlePadding",e,t)),Ky(r,"fill",nb("fillColor",e,t)),Ky(r,"stroke",nb("strokeColor",e,t)),Ky(r,"cornerRadius",nb("cornerRadius",e,t)),Ky(r,"strokeWidth",t.strokeWidth),Ky(r,"strokeDash",t.strokeDash),r}(e,c),p,$y),r={enter:{x:{value:0},y:{value:0}}},f=Mh(t.add(Dg(i={type:o,scale:t.scaleRef(y),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatSpecifier:t.property(e.format)}))),o===by?(a=[mb(e,y,c,d.gradient),bb(e,c,d.labels,f)],i.count=i.count||t.signalRef("max(2,2*floor(("+Wh(ab(e,c))+")/100))")):o===vy?a=[hb(e,y,c,d.gradient,f),bb(e,c,d.labels,f)]:(n=function(e,t){return{align:nb("gridAlign",e,t),center:{row:!0,column:!1},columns:sb(e,t),padding:{row:nb("rowPadding",e,t),column:nb("columnPadding",e,t)}}}(e,c),a=[$b(e,c,d,f,Wh(n.columns))],i.size=function(e,t,r){var n=Wh(Ub("size",e,r)),i=Wh(Ub("strokeWidth",e,r)),a=Wh(function(e,t,r){return ub("fontSize",e)||function(e,t,r){var n=t.config.style[r];return n&&n[e]}("fontSize",t,r)}(r[1].encode,t,my));return Ch(`max(ceil(sqrt(${n}) + ${i}), ${a})`,t)}(e,t,a[0].marks)),a=[vb(Uy,null,null,u,h,r,a,n)],s.title&&a.push(function(e,t,r,n){var i,a,o={value:0};return Ky(i={enter:a={opacity:o,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},update:{opacity:{value:1},text:Yy(e.title),x:a.x,y:a.y},exit:{opacity:o}},"align",nb("titleAlign",e,t)),Ky(i,"baseline",nb("titleBaseline",e,t)),Ky(i,"fill",nb("titleColor",e,t)),Ky(i,"font",nb("titleFont",e,t)),Ky(i,"fontSize",nb("titleFontSize",e,t)),Ky(i,"fontStyle",nb("titleFontStyle",e,t)),Ky(i,"fontWeight",nb("titleFontWeight",e,t)),Ky(i,"limit",nb("titleLimit",e,t)),Ky(i,"fillOpacity",nb("titleOpacity",e,t)),rb(pb,Xy,hy,null,n,i,r)}(e,c,d.title,u)),l=vb(Ly,g,m,u,h,p,a),e.zindex&&(l.zindex=e.zindex),Lb(l,t)}function Ub(e,t,r){return t[e]?'scale("'+t[e]+'",datum)':ub(e,r[0].encode)}function Wb(e,t,r){return'item.anchor==="'+ay+'"?'+e+':item.anchor==="'+oy+'"?'+t+":"+r}zb.countsRef=function(e,t,r){var n,i,a,o=this.counts||(this.counts={}),s=Rb(t);return null!=s&&(e=this.scope,n=o[s]),n?r&&r.field&&Tb(e,n.agg.params,r):(a={groupby:e.fieldRef(t,"key"),pulse:Mh(this.output)},r&&r.field&&Tb(e,a,r),i=e.add(yg(a)),n=e.add(Og({pulse:Mh(i)})),n={agg:i,ref:Mh(n)},null!=s&&(o[s]=n)),n.ref},zb.tuplesRef=function(){return Mh(this.values)},zb.extentRef=function(e,t){return Ib(e,this,"extent","extent",t,!1)},zb.domainRef=function(e,t){return Ib(e,this,"domain","values",t,!1)},zb.valuesRef=function(e,t,r){return Ib(e,this,"vals","values",t,r||!0)},zb.lookupRef=function(e,t){return Ib(e,this,"lookup","tupleindex",t,!1)},zb.indataRef=function(e,t){return Ib(e,this,"indata","tupleindex",t,!0,!0)};var Gb=Wb(D(ty),D(ry),D("center")),Hb=Wb('+(item.orient==="'+ry+'")','+(item.orient!=="'+ty+'")',"0.5");function Xb(e,t){e=F(e)?{text:e}:e;var r,n,i,a=t.config.title,o=he({},e.encode);return r={orient:nb("orient",e,a)},n=Mh(t.add(Og(null,[r]))),o.name=e.name,o.interactive=e.interactive,i=function(e,t,r,n){var i,a,o,s,u,f={value:0},l=e.text,c=nb("orient",e,t),d=nb("anchor",e,t),p=c===ty||c===ey?-1:1,m=c===ey||c===ny,h={group:m?"width":"height"};s={field:h,mult:{signal:Hb}},u=p<0?f:m?{field:{group:"height"}}:{field:{group:"width"}},i={enter:a={opacity:f},update:o={opacity:{value:1},text:Yy(l),anchor:Yy(d),orient:Yy(c),extent:{field:h},align:{signal:Gb}},exit:{opacity:f}},m?(o.x=s,o.y=u,a.angle=f,a.baseline={value:c===ey?ny:ey}):(o.x=u,o.y=s,a.angle={value:90*p},a.baseline={value:ny});return Ky(i,"align",nb("align",e,t),"update"),Ky(i,"angle",nb("angle",e,t)),Ky(i,"baseline",nb("baseline",e,t)),Ky(i,"fill",nb("color",e,t)),Ky(i,"font",nb("font",e,t)),Ky(i,"fontSize",nb("fontSize",e,t)),Ky(i,"fontStyle",nb("fontStyle",e,t)),Ky(i,"fontWeight",nb("fontWeight",e,t)),Ky(i,"frame",nb("frame",e,t)),Ky(i,"limit",nb("limit",e,t)),Ky(i,"offset",nb("offset",e,t)||0),rb(pb,Jy,e.style||gy,null,n,i,r)}(e,a,o,n),e.zindex&&(i.zindex=e.zindex),Lb(i,t)}function Jb(e,t){var r=[];e.transform&&e.transform.forEach(function(e){r.push(Fb(e,t))}),e.on&&e.on.forEach(function(r){Vb(r,t,e.name)}),t.addDataPipeline(e.name,function(e,t,r){var n,i,a,o,s,u=[],f=null,l=!1,c=!1;e.values?Nh(e.values)||Nh(e.format)?(u.push(Kb(t,e)),u.push(f=Yb())):u.push(f=Yb({$ingest:e.values,$format:e.format})):e.url?Nh(e.url)||Nh(e.format)?(u.push(Kb(t,e)),u.push(f=Yb())):u.push(f=Yb({$request:e.url,$format:e.format})):e.source&&(f=n=fe(e.source).map(function(e){return Mh(t.getData(e).output)}),u.push(null));for(i=0,a=r.length;i<a;++i)o=r[i],s=o.metadata,f||s.source||u.push(f=Yb()),u.push(o),s.generates&&(c=!0),s.modifies&&!c&&(l=!0),s.source?f=o:s.changes&&(f=null);n&&(a=n.length-1,u[0]=Rg({derive:l,pulse:a?n:n[0]}),(l||a)&&u.splice(1,0,Yb()));f||u.push(Yb());return u.push(Vg({})),u}(e,t,r))}function Yb(e){var t=Og({},e);return t.metadata={source:!0},t}function Kb(e,t){return Cg({url:t.url?e.property(t.url):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}function Qb(e,t){return{scale:e.scale,range:t}}function Zb(e,t,r,n){var i,a,o,s,u,f,l,c,d,p=e.orient,m=e.gridScale,h=p===ty||p===ey?1:-1,g=function(e,t){if(1===t);else if(w(e)){for(var r=e=he({},e);null!=r.mult;){if(!w(r.mult))return r.mult*=t,e;r=r.mult=he({},r.mult)}r.mult=t}else e=t*(e||0);return e}(e.offset,h),y={value:0};return Ky(i={enter:a={opacity:y},update:s={opacity:{value:1}},exit:o={opacity:y}},"stroke",nb("gridColor",e,t)),Ky(i,"strokeDash",nb("gridDash",e,t)),Ky(i,"strokeOpacity",nb("gridOpacity",e,t)),Ky(i,"strokeWidth",nb("gridWidth",e,t)),u={scale:e.scale,field:py,band:nb("bandPosition",e,t),round:nb("tickRound",e,t),extra:nb("tickExtra",e,t),offset:nb("tickOffset",e,t)},p===ey||p===ny?(f="x",l="y",d="height"):(f="y",l="x",d="width"),c=l+"2",s[f]=a[f]=o[f]=u,m?(s[l]=a[l]={scale:m,range:0,mult:h,offset:g},s[c]=a[c]={scale:m,range:1,mult:h,offset:g}):(s[l]=a[l]={value:0,offset:g},s[c]=a[c]={signal:d,mult:h,offset:g}),rb(cb,Ry,null,py,n,i,r)}function ev(e,t,r,n,i){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+r+","+n+","+i+")"}}function tv(e,t){var r,n,i,a,o,s,u=function(e,t){var r=t.config,n=e.orient,i=n===ey||n===ny?r.axisX:r.axisY,a=r["axis"+n[0].toUpperCase()+n.slice(1)],o="band"===t.scaleType(e.scale)&&r.axisBand;return i||a||o?he({},r.axis,i,a,o):r.axis}(e,t),f=e.encode||{},l=f.axis||{},c=l.name||void 0,d=l.interactive,p=l.style;return r={orient:e.orient,ticks:!!nb("ticks",e,u),labels:!!nb("labels",e,u),grid:!!nb("grid",e,u),domain:!!nb("domain",e,u),title:!!Uh(e.title,!1)},n=Mh(t.add(Og({},[r]))),l=Qy({update:{range:{signal:'abs(span(range("'+e.scale+'")))'},offset:Yy(Uh(e.offset,0)),position:Yy(Uh(e.position,0)),titlePadding:Yy(nb("titlePadding",e,u)),minExtent:Yy(nb("minExtent",e,u)),maxExtent:Yy(nb("maxExtent",e,u))}},f.axis,$y),i=Mh(t.add(bg({scale:t.scaleRef(e.scale),extra:t.property(nb("tickExtra",e,u)),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatSpecifier:t.property(e.format)}))),s=[],r.grid&&s.push(Zb(e,u,f.grid,i)),r.ticks&&(a=nb("tickSize",e,u),s.push(function(e,t,r,n,i){var a,o,s,u,f,l,c=e.orient,d=c===ty||c===ey?-1:1,p={value:0};return Ky(a={enter:o={opacity:p},update:u={opacity:{value:1}},exit:s={opacity:p}},"stroke",nb("tickColor",e,t)),Ky(a,"strokeOpacity",nb("tickOpacity",e,t)),Ky(a,"strokeWidth",nb("tickWidth",e,t)),(f=Yy(i)).mult=d,l={scale:e.scale,field:py,band:nb("bandPosition",e,t),round:nb("tickRound",e,t),extra:nb("tickExtra",e,t),offset:nb("tickOffset",e,t)},c===ey||c===ny?(u.y=o.y=p,u.y2=o.y2=f,u.x=o.x=s.x=l):(u.x=o.x=p,u.x2=o.x2=f,u.y=o.y=s.y=l),rb(cb,Iy,null,py,n,a,r)}(e,u,f.ticks,i,a))),r.labels&&(a=r.ticks?a:0,s.push(function(e,t,r,n,i){var a,o,s,u,f,l,c,d,p,m,h=e.orient,g=h===ty||h===ey?-1:1,y=h===ey||h===ny,b=e.scale,v=Wh(nb("labelFlush",e,t)),O=Wh(nb("labelFlushOffset",e,t)),$=0===v||!!v,x=nb("labelAlign",e,t),k=nb("labelBaseline",e,t),_={value:0};return(s=Yy(i)).mult=g,s.offset=Yy(nb("labelPadding",e,t)||0),s.offset.mult=g,u={scale:b,field:py,band:.5,offset:nb("tickOffset",e,t)},y?(f=x||($?ev(b,v,'"left"','"right"','"center"'):"center"),l=k||(h===ey?"bottom":"top"),c=!x):(f=x||(h===ry?"left":"right"),l=k||($?ev(b,v,'"top"','"bottom"','"middle"'):"middle"),c=!k),c=c&&$&&O?ev(b,v,"-"+O,O,0):null,Ky(a={enter:o={opacity:_,x:y?u:s,y:y?s:u},update:{opacity:{value:1},text:{field:uy},x:o.x,y:o.y},exit:{opacity:_,x:o.x,y:o.y}},y?"dx":"dy",c),Ky(a,"align",f),Ky(a,"baseline",l),Ky(a,"angle",nb("labelAngle",e,t)),Ky(a,"fill",nb("labelColor",e,t)),Ky(a,"font",nb("labelFont",e,t)),Ky(a,"fontSize",nb("labelFontSize",e,t)),Ky(a,"fontWeight",nb("labelFontWeight",e,t)),Ky(a,"fontStyle",nb("labelFontStyle",e,t)),Ky(a,"limit",nb("labelLimit",e,t)),Ky(a,"fillOpacity",nb("labelOpacity",e,t)),d=nb("labelBound",e,t),p=nb("labelOverlap",e,t),m=nb("labelSeparation",e,t),e=rb(pb,Ty,my,py,n,a,r),(p||d)&&(e.overlap={separation:m,method:p,order:"datum.index",bound:d?{scale:b,orient:h,tolerance:d}:null}),e}(e,u,f.labels,i,a))),r.domain&&s.push(function(e,t,r,n){var i,a,o,s,u,f,l=e.orient,c={value:0};return Ky(i={enter:a={opacity:c},update:o={opacity:{value:1}},exit:{opacity:c}},"stroke",nb("domainColor",e,t)),Ky(i,"strokeWidth",nb("domainWidth",e,t)),Ky(i,"strokeOpacity",nb("domainOpacity",e,t)),l===ey||l===ny?(s="x",f="y"):(s="y",f="x"),u=s+"2",a[f]=c,o[s]=a[s]=Qb(e,0),o[u]=a[u]=Qb(e,1),rb(cb,zy,null,null,n,i,r)}(e,u,f.domain,n)),r.title&&s.push(function(e,t,r,n){var i,a,o,s,u=e.orient,f=u===ty||u===ey?-1:1,l=u===ey||u===ny,c={value:0};return i={enter:a={opacity:c},update:o={opacity:{value:1},text:Yy(e.title)},exit:{opacity:c}},s={scale:e.scale,range:.5},l?(o.x=s,a.angle={value:0},a.baseline={value:u===ey?"bottom":"top"}):(o.y=s,a.angle={value:90*f},a.baseline={value:"bottom"}),Ky(i,"align",nb("titleAlign",e,t)),Ky(i,"angle",nb("titleAngle",e,t)),Ky(i,"baseline",nb("titleBaseline",e,t)),Ky(i,"fill",nb("titleColor",e,t)),Ky(i,"font",nb("titleFont",e,t)),Ky(i,"fontSize",nb("titleFontSize",e,t)),Ky(i,"fontStyle",nb("titleFontStyle",e,t)),Ky(i,"fontWeight",nb("titleFontWeight",e,t)),Ky(i,"limit",nb("titleLimit",e,t)),Ky(i,"fillOpacity",nb("titleOpacity",e,t)),!Ky(i,"x",nb("titleX",e,t),"update")&&l&&!tb("x",r)&&(i.enter.auto={value:!0}),!Ky(i,"y",nb("titleY",e,t),"update")&&!l&&!tb("y",r)&&(i.enter.auto={value:!0}),rb(pb,Vy,hy,null,n,i,r)}(e,u,f.title,n)),o=vb(Py,p,c,n,d,l,s),e.zindex&&(o.zindex=e.zindex),Lb(o,t)}function rv(e,t,r){var n=fe(e.signals),i=fe(e.scales);return r||n.forEach(function(e){Dh(e,t)}),fe(e.projections).forEach(function(e){!function(e,t){var r={};for(var n in e)"name"!==n&&(r[n]=Zg(e[n],n,t));t.addProjection(e.name,r)}(e,t)}),i.forEach(function(e){Gg(e,t)}),fe(e.data).forEach(function(e){Jb(e,t)}),i.forEach(function(e){Hg(e,t)}),n.forEach(function(e){!function(e,t){var r=t.getSignal(e.name),n=e.update;e.init&&(n?k("Signals can not include both init and update expressions."):(n=e.init,r.initonly=!0)),n&&(n=Ch(n,t),r.update=n.$expr,r.params=n.$params),e.on&&e.on.forEach(function(e){hg(e,t,r.id)})}(e,t)}),fe(e.axes).forEach(function(e){tv(e,t)}),fe(e.marks).forEach(function(e){Lb(e,t)}),fe(e.legends).forEach(function(e){Nb(e,t)}),e.title&&Xb(e.title,t),t.parseLambdas(),t}var nv=Pe(["width","height","padding","autosize"]);function iv(e,t){var r,n,i,a,o,s=t.config;return t.background=e.background||s.background,t.eventConfig=s.events,o=Mh(t.root=t.add(jh())),t.addSignal("width",e.width||0),t.addSignal("height",e.height||0),t.addSignal("padding",function(e,t){return w(e=e||t.padding)?{top:_h(e.top),bottom:_h(e.bottom),left:_h(e.left),right:_h(e.right)}:{top:r=_h(e),bottom:r,left:r,right:r};var r}(e.padding,s)),t.addSignal("autosize",function(e,t){return w(e=e||t.autosize)?e:{type:e=e||"pad"}}(e.autosize,s)),fe(e.signals).forEach(function(e){nv[e.name]||Dh(e,t)}),n=t.add(Og()),i=Qy({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e.encode),i=t.add(kg(Zy(i,fb,qy,e.style,t,{pulse:Mh(n)}))),a=t.add(Ng({layout:t.objectProperty(e.layout),legendMargin:s.legendMargin,autosize:t.signalRef("autosize"),mark:o,pulse:Mh(i)})),t.operators.pop(),t.pushState(Mh(i),Mh(a),null),rv(e,t,!0),t.operators.push(a),r=t.add(vg({mark:o,pulse:Mh(a)})),r=t.add(Tg({pulse:Mh(r)})),r=t.add(Vg({pulse:Mh(r)})),t.addData("root",new Pb(t,n,n,r)),t}function av(e){this.config=e,this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.background=null,this.eventConfig=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ov(e){this.config=e.config,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}var sv=av.prototype=ov.prototype;function uv(e){return(A(e)?function(e){for(var t,r="[",n=0,i=e.length;n<i;++n)t=e[n],r+=(n>0?",":"")+(w(t)?t.signal||uv(t):D(t));return r+"]"}:function(e){var t,r,n="{",i=0;for(t in e)r=e[t],n+=(++i>1?",":"")+D(t)+":"+(w(r)?r.signal||uv(r):D(r));return n+"}"})(e)}function fv(e){var t={padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:pv},area:{fill:pv},image:null,line:{stroke:pv,strokeWidth:dv},path:{stroke:pv},rect:{fill:pv},rule:{stroke:mv},shape:{stroke:pv},symbol:{fill:pv,size:64},text:{fill:mv,font:lv,fontSize:11},style:{"guide-label":{fill:mv,font:lv,fontSize:10},"guide-title":{fill:mv,font:lv,fontSize:11,fontWeight:"bold"},"group-title":{fill:mv,font:lv,fontSize:13,fontWeight:"bold"},point:{size:cv,strokeWidth:dv,shape:"circle"},circle:{size:cv,strokeWidth:dv},square:{size:cv,strokeWidth:dv,shape:"square"},cell:{fill:"transparent",stroke:gv}},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:hv,grid:!1,gridWidth:1,gridColor:gv,labels:!0,labelAngle:0,labelLimit:180,labelPadding:2,ticks:!0,tickColor:hv,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titleAlign:"center",titlePadding:4},axisBand:{tickOffset:-1},legend:{orient:"right",offset:18,padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:gv,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:hv,titleAlign:"left",titleBaseline:"top",titleLimit:180,titlePadding:5},title:{orient:"top",anchor:"middle",offset:4},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}};return(e||[]).forEach(function(e){var r,n,i;if(e)for(r in e)if("style"===r)for(r in i=t.style||(t.style={}),e.style)i[r]=he(i[r]||{},e.style[r]);else n=e[r],t[r]=w(n)&&!A(n)?he(w(t[r])?t[r]:{},n):n}),t}sv.fork=function(){return new ov(this)},sv.isSubscope=function(){return this._subid>0},sv.toRuntime=function(){return this.finish(),{background:this.background,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig}},sv.id=function(){return(this._subid?this._subid+":":0)+this._id++},sv.add=function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach(function(t){t.$ref=e.id}),e.refs=null),e},sv.proxy=function(e){var t=e instanceof Eh?Mh(e):e;return this.add(zg({value:t}))},sv.addStream=function(e){return this.streams.push(e),e.id=this.id(),e},sv.addUpdate=function(e){return this.updates.push(e),e},sv.finish=function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function r(e,t,r){var n;e&&((n=e.data||(e.data={}))[t]||(n[t]=[])).push(r)}for(e in this.data)for(var n in r((t=this.data[e]).input,e,"input"),r(t.output,e,"output"),r(t.values,e,"values"),t.index)r(t.index[n],e,"index:"+n);return this},sv.pushState=function(e,t,r){this._encode.push(Mh(this.add(Vg({pulse:e})))),this._parent.push(t),this._lookup.push(r?Mh(this.proxy(r)):null),this._markpath.push(-1)},sv.popState=function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},sv.parent=function(){return U(this._parent)},sv.encode=function(){return U(this._encode)},sv.lookup=function(){return U(this._lookup)},sv.markpath=function(){var e=this._markpath;return++e[e.length-1]},sv.fieldRef=function(e,t){if(F(e))return Bh(e,t);e.signal||k("Unsupported field reference: "+D(e));var r,n=e.signal,i=this.field[n];return i||(r={name:this.signalRef(n)},t&&(r.as=t),this.field[n]=i=Mh(this.add(wg(r)))),i},sv.compareRef=function(e,t){function r(e){return Lh(e)?(i=!0,n.signalRef(e.signal)):e}var n=this,i=!1,a=fe(e.field).map(r),o=fe(e.order).map(r);return t&&a.push(qh),i?Mh(this.add($g({fields:a,orders:o}))):zh(a,o)},sv.keyRef=function(e,t){var r=this.signals,n=!1;return e=fe(e).map(function(e){return Lh(e)?(n=!0,Mh(r[e.signal])):e}),n?Mh(this.add(Fg({fields:e,flat:t}))):function(e,t){var r={$key:e};return t&&(r.$flat=!0),r}(e,t)},sv.sortRef=function(e){if(!e)return e;var t=[Th(e.op,e.field),qh],r=e.order||"ascending";return r.signal?Mh(this.add($g({fields:t,orders:[r=this.signalRef(r.signal),r]}))):zh(t,[r,r])},sv.event=function(e,t){var r=e+":"+t;if(!this.events[r]){var n=this.id();this.streams.push({id:n,source:e,type:t}),this.events[r]=n}return this.events[r]},sv.addSignal=function(e,t){this.signals.hasOwnProperty(e)&&k("Duplicate signal name: "+D(e));var r=t instanceof Eh?t:this.add(jh(t));return this.signals[e]=r},sv.getSignal=function(e){return this.signals[e]||k("Unrecognized signal name: "+D(e)),this.signals[e]},sv.signalRef=function(e){return this.signals[e]?Mh(this.signals[e]):(this.lambdas.hasOwnProperty(e)||(this.lambdas[e]=this.add(jh(null))),Mh(this.lambdas[e]))},sv.parseLambdas=function(){for(var e=Object.keys(this.lambdas),t=0,r=e.length;t<r;++t){var n=e[t],i=Ch(n,this),a=this.lambdas[n];a.params=i.$params,a.update=i.$expr}},sv.property=function(e){return e&&e.signal?this.signalRef(e.signal):e},sv.objectProperty=function(e){return e&&w(e)?this.signalRef(e.signal||uv(e)):e},sv.exprRef=function(e,t){var r={expr:Ch(e,this)};return t&&(r.expr.$name=t),Mh(this.add(_g(r)))},sv.addBinding=function(e,t){this.bindings||k("Nested signals do not support binding: "+D(e)),this.bindings.push(he({signal:e},t))},sv.addScaleProj=function(e,t){this.scales.hasOwnProperty(e)&&k("Duplicate scale or projection name: "+D(e)),this.scales[e]=this.add(t)},sv.addScale=function(e,t){this.addScaleProj(e,Ig(t))},sv.addProjection=function(e,t){this.addScaleProj(e,Pg(t))},sv.getScale=function(e){return this.scales[e]||k("Unrecognized scale name: "+D(e)),this.scales[e]},sv.projectionRef=sv.scaleRef=function(e){return Mh(this.getScale(e))},sv.projectionType=sv.scaleType=function(e){return this.getScale(e).params.type},sv.addData=function(e,t){return this.data.hasOwnProperty(e)&&k("Duplicate data set name: "+D(e)),this.data[e]=t},sv.getData=function(e){return this.data[e]||k("Undefined data set name: "+D(e)),this.data[e]},sv.addDataPipeline=function(e,t){return this.data.hasOwnProperty(e)&&k("Duplicate data set name: "+D(e)),this.addData(e,Pb.fromEntries(this,t))};var lv="sans-serif",cv=30,dv=2,pv="#4c78a8",mv="#000",hv="#888",gv="#ddd";function yv(e,t){return w(e)||k("Input Vega specification must be an object."),iv(e,new av(fv([t,e.config]))).toRuntime()}he(rr,Ln,Su,sl,Al,zl,oc,lc,_c,jc)}.call(this,r(221).Buffer)},212:function(e,t,r){"use strict";var n="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const i="vg-tooltip-element",a={offsetX:10,offsetY:10,id:i,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};var o=r(135),s=function(e,t,r){return e.fields=t||[],e.fname=r,e};var u=function(e){throw Error(e)},f=function(e){var t,r,n,i=[],a=null,o=0,s=e.length,f="";function l(){i.push(f+e.substring(t,r)),f="",t=r+1}for(e+="",t=r=0;r<s;++r)if("\\"===(n=e[r]))f+=e.substring(t,r),t=++r;else if(n===a)l(),a=null,o=-1;else{if(a)continue;t===o&&'"'===n?(t=r+1,a=n):t===o&&"'"===n?(t=r+1,a=n):"."!==n||o?"["===n?(r>t&&l(),o=t=r+1):"]"===n&&(o||u("Access path missing open bracket: "+e),o>0&&l(),o=0,t=r+1):r>t?l():t=r+1}return o&&u("Access path missing closing bracket: "+e),a&&u("Access path missing closing quote: "+e),r>t&&(r++,l()),i},l=Array.isArray,c=function(e){return e===Object(e)},d=function(e){return"string"==typeof e};function p(e){return l(e)?"["+e.map(p)+"]":c(e)||d(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}var m,h,g,y,b=[];g=f(m="id"),y="return _["+g.map(p).join("][")+"];",s(Function("_",y),[m=1===g.length?g[0]:m],h||m),s(function(e){return e},b,"identity"),s(function(){return 0},b,"zero"),s(function(){return 1},b,"one"),s(function(){return!0},b,"true"),s(function(){return!1},b,"false");function v(e,t,r){if(l(e))return`[${e.map(e=>t(d(e)?e:O(e,r))).join(", ")}]`;if(c(e)){let n="";const i=e,{title:a}=i,s=o.b(i,["title"]);a&&(n+=`<h2>${t(a)}</h2>`);const u=Object.keys(s);if(u.length>0){n+="<table>";for(const e of u){let i=s[e];c(i)&&(i=O(i,r)),n+=`<tr><td class="key">${t(e)}:</td><td class="value">${t(i)}</td></tr>`}n+="</table>"}return n||"{}"}return t(e)}function O(e,t){return JSON.stringify(e,function(e){const t=[];return function(r,n){if("object"!=typeof n||null===n)return n;const i=t.indexOf(this)+1;return t.length=i,t.length>e?"[Object]":t.indexOf(n)>=0?"[Circular]":(t.push(n),n)}}(t))}class ${constructor(e){this.options=Object.assign({},a,e);const t=this.options.id;if(this.call=this.tooltip_handler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const e=document.createElement("style");e.setAttribute("id",this.options.styleId),e.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return n.toString().replace(i,e)}(t);const r=document.head;r.childNodes.length>0?r.insertBefore(e,r.childNodes[0]):r.appendChild(e)}this.el=document.getElementById(t),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",t),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el))}tooltip_handler(e,t,r,n){if(null==n||""===n)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=v(n,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:a}=function(e,t,r,n){let i=e.clientX+r;i+t.width>window.innerWidth&&(i=+e.clientX-r-t.width);let a=e.clientY+n;return a+t.height>window.innerHeight&&(a=+e.clientY-n-t.height),{x:i,y:a}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${a}px; left: ${i}px`)}}r.d(t,"b",function(){return v});t.a=function(e,t){const r=new $(t);return e.tooltip(r.call).run(),r}},243:function(e){e.exports={$schema:"http://json-schema.org/draft-06/schema#",title:"Vega Visualization Specification Language",defs:{autosize:{oneOf:[{enum:["pad","fit","fit-x","fit-y","none"],default:"pad"},{type:"object",properties:{type:{enum:["pad","fit","fit-x","fit-y","none"],default:"pad"},resize:{type:"boolean"},contains:{enum:["content","padding"]}},required:["type"],additionalProperties:!1}]},axis:{type:"object",properties:{orient:{enum:["top","bottom","left","right"]},scale:{type:"string"},format:{$ref:"#/refs/stringOrSignal"},minExtent:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},maxExtent:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},offset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},position:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},bandPosition:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},values:{$ref:"#/refs/arrayOrSignal"},zindex:{type:"number"},title:{$ref:"#/refs/stringOrSignal"},titlePadding:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleAlign:{oneOf:[{enum:["left","right","center"]},{$ref:"#/refs/alignValue"}]},titleAngle:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleX:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleY:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleBaseline:{oneOf:[{enum:["top","middle","bottom","alphabetic"]},{$ref:"#/refs/baselineValue"}]},titleColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},titleFont:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},titleFontSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleFontStyle:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},titleFontWeight:{oneOf:[{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]},{$ref:"#/refs/fontWeightValue"}]},titleLimit:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},domain:{type:"boolean"},domainColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},domainOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},domainWidth:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},ticks:{type:"boolean"},tickColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},tickOffset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},tickOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},tickRound:{oneOf:[{type:"boolean"},{$ref:"#/refs/booleanValue"}]},tickSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},tickWidth:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},tickCount:{$ref:"#/refs/tickCount"},tickExtra:{$ref:"#/refs/booleanOrSignal"},tickMinStep:{$ref:"#/refs/numberOrSignal"},grid:{type:"boolean"},gridScale:{type:"string"},gridColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},gridDash:{oneOf:[{type:"array",items:{type:"number"}},{$ref:"#/refs/arrayValue"}]},gridOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},gridWidth:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labels:{type:"boolean"},labelAlign:{oneOf:[{enum:["left","right","center"]},{$ref:"#/refs/alignValue"}]},labelBaseline:{oneOf:[{enum:["top","middle","bottom","alphabetic"]},{$ref:"#/refs/baselineValue"}]},labelBound:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},labelFlush:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},labelFlushOffset:{$ref:"#/refs/numberOrSignal"},labelOverlap:{$ref:"#/refs/labelOverlap"},labelAngle:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},labelFont:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},labelFontSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelFontWeight:{oneOf:[{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]},{$ref:"#/refs/fontWeightValue"}]},labelFontStyle:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},labelLimit:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelPadding:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelSeparation:{$ref:"#/refs/numberOrSignal"},encode:{type:"object",properties:{axis:{$ref:"#/defs/guideEncode"},ticks:{$ref:"#/defs/guideEncode"},labels:{$ref:"#/defs/guideEncode"},title:{$ref:"#/defs/guideEncode"},grid:{$ref:"#/defs/guideEncode"},domain:{$ref:"#/defs/guideEncode"}},additionalProperties:!1}},required:["orient","scale"],additionalProperties:!1},background:{type:"string"},bind:{oneOf:[{type:"object",properties:{input:{enum:["checkbox"]},element:{$ref:"#/refs/element"},debounce:{type:"number"},name:{type:"string"}},required:["input"],additionalProperties:!1},{type:"object",properties:{input:{enum:["radio","select"]},element:{$ref:"#/refs/element"},options:{type:"array"},debounce:{type:"number"},name:{type:"string"}},required:["input","options"],additionalProperties:!1},{type:"object",properties:{input:{enum:["range"]},element:{$ref:"#/refs/element"},min:{type:"number"},max:{type:"number"},step:{type:"number"},debounce:{type:"number"},name:{type:"string"}},required:["input"],additionalProperties:!1},{type:"object",properties:{input:{not:{enum:["checkbox","radio","range","select"]}},element:{$ref:"#/refs/element"},debounce:{type:"number"},name:{type:"string"}},required:["input"],additionalProperties:!0}]},data:{oneOf:[{type:"object",properties:{name:{type:"string"},transform:{type:"array",items:{$ref:"#/defs/transform"}},on:{$ref:"#/defs/onTrigger"}},required:["name"],additionalProperties:!1},{type:"object",properties:{source:{oneOf:[{type:"string"},{type:"array",items:{type:"string"},minItems:1}]},name:{type:"string"},transform:{type:"array",items:{$ref:"#/defs/transform"}},on:{$ref:"#/defs/onTrigger"}},required:["source","name"],additionalProperties:!1},{type:"object",properties:{url:{$ref:"#/refs/stringOrSignal"},format:{oneOf:[{anyOf:[{type:"object",properties:{type:{$ref:"#/refs/stringOrSignal"},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}}},{type:"object",properties:{type:{enum:["json"]},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]},property:{$ref:"#/refs/stringOrSignal"},copy:{$ref:"#/refs/booleanOrSignal"}},additionalProperties:!1},{type:"object",properties:{type:{enum:["csv","tsv"]},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}},required:["type"],additionalProperties:!1},{type:"object",properties:{type:{enum:["dsv"]},delimiter:{type:"string"},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}},required:["type","delimiter"],additionalProperties:!1},{oneOf:[{type:"object",properties:{type:{enum:["topojson"]},feature:{$ref:"#/refs/stringOrSignal"},property:{$ref:"#/refs/stringOrSignal"}},required:["type","feature"],additionalProperties:!1},{type:"object",properties:{type:{enum:["topojson"]},mesh:{$ref:"#/refs/stringOrSignal"},property:{$ref:"#/refs/stringOrSignal"}},required:["type","mesh"],additionalProperties:!1}]}]},{$ref:"#/refs/signal"}]},name:{type:"string"},transform:{type:"array",items:{$ref:"#/defs/transform"}},on:{$ref:"#/defs/onTrigger"}},required:["url","name"],additionalProperties:!1},{type:"object",properties:{values:{oneOf:[{},{$ref:"#/refs/signal"}]},format:{oneOf:[{anyOf:[{type:"object",properties:{type:{$ref:"#/refs/stringOrSignal"},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}}},{type:"object",properties:{type:{enum:["json"]},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]},property:{$ref:"#/refs/stringOrSignal"},copy:{$ref:"#/refs/booleanOrSignal"}},additionalProperties:!1},{type:"object",properties:{type:{enum:["csv","tsv"]},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}},required:["type"],additionalProperties:!1},{type:"object",properties:{type:{enum:["dsv"]},delimiter:{type:"string"},parse:{oneOf:[{enum:["auto"]},{type:"object",properties:{},additionalProperties:{oneOf:[{enum:["boolean","number","date","string"]},{type:"string",pattern:"^(date|utc):.*$"}]}},{$ref:"#/refs/signal"}]}},required:["type","delimiter"],additionalProperties:!1},{oneOf:[{type:"object",properties:{type:{enum:["topojson"]},feature:{$ref:"#/refs/stringOrSignal"},property:{$ref:"#/refs/stringOrSignal"}},required:["type","feature"],additionalProperties:!1},{type:"object",properties:{type:{enum:["topojson"]},mesh:{$ref:"#/refs/stringOrSignal"},property:{$ref:"#/refs/stringOrSignal"}},required:["type","mesh"],additionalProperties:!1}]}]},{$ref:"#/refs/signal"}]},name:{type:"string"},transform:{type:"array",items:{$ref:"#/defs/transform"}},on:{$ref:"#/defs/onTrigger"}},required:["values","name"],additionalProperties:!1}]},rule:{type:"object",properties:{test:{type:"string"}}},encodeEntry:{type:"object",properties:{x:{$ref:"#/refs/numberValue"},x2:{$ref:"#/refs/numberValue"},xc:{$ref:"#/refs/numberValue"},width:{$ref:"#/refs/numberValue"},y:{$ref:"#/refs/numberValue"},y2:{$ref:"#/refs/numberValue"},yc:{$ref:"#/refs/numberValue"},height:{$ref:"#/refs/numberValue"},opacity:{$ref:"#/refs/numberValue"},fill:{$ref:"#/refs/colorValue"},fillOpacity:{$ref:"#/refs/numberValue"},stroke:{$ref:"#/refs/colorValue"},strokeOpacity:{$ref:"#/refs/numberValue"},strokeWidth:{$ref:"#/refs/numberValue"},strokeCap:{$ref:"#/refs/strokeCapValue"},strokeDash:{$ref:"#/refs/arrayValue"},strokeDashOffset:{$ref:"#/refs/numberValue"},strokeJoin:{$ref:"#/refs/strokeJoinValue"},strokeMiterLimit:{$ref:"#/refs/numberValue"},cursor:{$ref:"#/refs/stringValue"},tooltip:{$ref:"#/refs/anyValue"},zindex:{$ref:"#/refs/numberValue"},clip:{$ref:"#/refs/booleanValue"},angle:{$ref:"#/refs/numberValue"},size:{$ref:"#/refs/numberValue"},shape:{$ref:"#/refs/stringValue"},path:{$ref:"#/refs/stringValue"},innerRadius:{$ref:"#/refs/numberValue"},outerRadius:{$ref:"#/refs/numberValue"},startAngle:{$ref:"#/refs/numberValue"},endAngle:{$ref:"#/refs/numberValue"},interpolate:{$ref:"#/refs/stringValue"},tension:{$ref:"#/refs/numberValue"},orient:{$ref:"#/refs/orientValue"},url:{$ref:"#/refs/stringValue"},align:{$ref:"#/refs/alignValue"},baseline:{$ref:"#/refs/baselineValue"},text:{$ref:"#/refs/stringValue"},dir:{$ref:"#/refs/stringValue"},ellipsis:{$ref:"#/refs/stringValue"},limit:{$ref:"#/refs/numberValue"},dx:{$ref:"#/refs/numberValue"},dy:{$ref:"#/refs/numberValue"},radius:{$ref:"#/refs/numberValue"},theta:{$ref:"#/refs/numberValue"},font:{$ref:"#/refs/stringValue"},fontSize:{$ref:"#/refs/numberValue"},fontWeight:{$ref:"#/refs/fontWeightValue"},fontStyle:{$ref:"#/refs/stringValue"}},additionalProperties:!0},encode:{type:"object",additionalProperties:!1,patternProperties:{"^.+$":{$ref:"#/defs/encodeEntry"}}},layout:{oneOf:[{type:"object",properties:{align:{oneOf:[{oneOf:[{enum:["all","each","none"]},{$ref:"#/refs/signal"}]},{type:"object",properties:{row:{oneOf:[{enum:["all","each","none"]},{$ref:"#/refs/signal"}]},column:{oneOf:[{enum:["all","each","none"]},{$ref:"#/refs/signal"}]}},additionalProperties:!1}]},bounds:{oneOf:[{enum:["full","flush"]},{$ref:"#/refs/signal"}]},center:{oneOf:[{type:"boolean"},{$ref:"#/refs/signal"},{type:"object",properties:{row:{$ref:"#/refs/booleanOrSignal"},column:{$ref:"#/refs/booleanOrSignal"}},additionalProperties:!1}]},columns:{$ref:"#/refs/numberOrSignal"},padding:{oneOf:[{type:"number"},{$ref:"#/refs/signal"},{type:"object",properties:{row:{$ref:"#/refs/numberOrSignal"},column:{$ref:"#/refs/numberOrSignal"}},additionalProperties:!1}]},offset:{oneOf:[{type:"number"},{$ref:"#/refs/signal"},{type:"object",properties:{rowHeader:{$ref:"#/refs/numberOrSignal"},rowFooter:{$ref:"#/refs/numberOrSignal"},rowTitle:{$ref:"#/refs/numberOrSignal"},columnHeader:{$ref:"#/refs/numberOrSignal"},columnFooter:{$ref:"#/refs/numberOrSignal"},columnTitle:{$ref:"#/refs/numberOrSignal"}},additionalProperties:!1}]},headerBand:{oneOf:[{$ref:"#/refs/numberOrSignal"},{type:"null"},{type:"object",properties:{row:{$ref:"#/refs/numberOrSignal"},column:{$ref:"#/refs/numberOrSignal"}},additionalProperties:!1}]},footerBand:{oneOf:[{$ref:"#/refs/numberOrSignal"},{type:"null"},{type:"object",properties:{row:{$ref:"#/refs/numberOrSignal"},column:{$ref:"#/refs/numberOrSignal"}},additionalProperties:!1}]},titleBand:{oneOf:[{$ref:"#/refs/numberOrSignal"},{type:"null"},{type:"object",properties:{row:{$ref:"#/refs/numberOrSignal"},column:{$ref:"#/refs/numberOrSignal"}},additionalProperties:!1}]}},additionalProperties:!1},{$ref:"#/refs/signal"}]},guideEncode:{type:"object",properties:{name:{type:"string"},interactive:{type:"boolean",default:!1},style:{$ref:"#/refs/style"}},additionalProperties:!1,patternProperties:{"^(?!interactive|name|style).+$":{$ref:"#/defs/encodeEntry"}}},legend:{allOf:[{type:"object",properties:{size:{type:"string"},shape:{type:"string"},fill:{type:"string"},stroke:{type:"string"},opacity:{type:"string"},strokeDash:{type:"string"},strokeWidth:{type:"string"},type:{enum:["gradient","symbol"]},direction:{enum:["vertical","horizontal"]},orient:{enum:["none","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"right"},format:{$ref:"#/refs/stringOrSignal"},title:{$ref:"#/refs/stringOrSignal"},tickCount:{$ref:"#/refs/tickCount"},tickMinStep:{$ref:"#/refs/numberOrSignal"},values:{$ref:"#/refs/arrayOrSignal"},zindex:{type:"number"},cornerRadius:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},fillColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},offset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},padding:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},strokeColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},titleAlign:{oneOf:[{enum:["left","right","center"]},{$ref:"#/refs/alignValue"}]},titleBaseline:{oneOf:[{enum:["top","middle","bottom","alphabetic"]},{$ref:"#/refs/baselineValue"}]},titleColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},titleFont:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},titleFontSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleFontStyle:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},titleFontWeight:{oneOf:[{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]},{$ref:"#/refs/fontWeightValue"}]},titleLimit:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titleOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},titlePadding:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},gradientLength:{$ref:"#/refs/numberOrSignal"},gradientOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},gradientStrokeColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},gradientStrokeWidth:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},gradientThickness:{$ref:"#/refs/numberOrSignal"},clipHeight:{$ref:"#/refs/numberOrSignal"},columns:{$ref:"#/refs/numberOrSignal"},columnPadding:{$ref:"#/refs/numberOrSignal"},rowPadding:{$ref:"#/refs/numberOrSignal"},gridAlign:{oneOf:[{enum:["all","each","none"]},{$ref:"#/refs/signal"}]},symbolFillColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},symbolOffset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},symbolOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},symbolSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},symbolStrokeColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},symbolStrokeWidth:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},symbolType:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},labelAlign:{oneOf:[{enum:["left","right","center"]},{$ref:"#/refs/alignValue"}]},labelBaseline:{oneOf:[{enum:["top","middle","bottom","alphabetic"]},{$ref:"#/refs/baselineValue"}]},labelColor:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},labelFont:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},labelFontSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelFontStyle:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},labelFontWeight:{oneOf:[{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]},{$ref:"#/refs/fontWeightValue"}]},labelLimit:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelOffset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelOpacity:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},labelOverlap:{$ref:"#/refs/labelOverlap"},labelSeparation:{$ref:"#/refs/numberOrSignal"},encode:{type:"object",properties:{title:{$ref:"#/defs/guideEncode"},labels:{$ref:"#/defs/guideEncode"},legend:{$ref:"#/defs/guideEncode"},entries:{$ref:"#/defs/guideEncode"},symbols:{$ref:"#/defs/guideEncode"},gradient:{$ref:"#/defs/guideEncode"}},additionalProperties:!1}},additionalProperties:!1},{anyOf:[{type:"object",required:["size"]},{type:"object",required:["shape"]},{type:"object",required:["fill"]},{type:"object",required:["stroke"]},{type:"object",required:["opacity"]},{type:"object",required:["strokeDash"]}]}]},mark:{type:"object",properties:{type:{$ref:"#/refs/marktype"},role:{type:"string"},name:{type:"string"},style:{$ref:"#/refs/style"},key:{type:"string"},clip:{$ref:"#/refs/markclip"},sort:{$ref:"#/refs/compare"},interactive:{$ref:"#/refs/booleanOrSignal"},encode:{$ref:"#/defs/encode"},transform:{type:"array",items:{$ref:"#/defs/transformMark"}},on:{$ref:"#/defs/onMarkTrigger"}},required:["type"]},markGroup:{allOf:[{type:"object",properties:{type:{enum:["group"]},from:{oneOf:[{$ref:"#/refs/from"},{$ref:"#/refs/facet"}]}},required:["type"]},{$ref:"#/defs/mark"},{$ref:"#/defs/scope"}]},markVisual:{allOf:[{type:"object",properties:{type:{not:{enum:["group"]}},from:{$ref:"#/refs/from"}}},{$ref:"#/defs/mark"}]},listener:{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{scale:{type:"string"}},required:["scale"]},{$ref:"#/defs/stream"}]},onEvents:{type:"array",items:{allOf:[{type:"object",properties:{events:{oneOf:[{$ref:"#/refs/selector"},{$ref:"#/defs/listener"},{type:"array",items:{$ref:"#/defs/listener"},minItems:1}]},force:{type:"boolean"}},required:["events"]},{oneOf:[{type:"object",properties:{encode:{type:"string"}},required:["encode"]},{type:"object",properties:{update:{oneOf:[{$ref:"#/refs/exprString"},{$ref:"#/refs/expr"},{$ref:"#/refs/signal"},{type:"object",properties:{value:{}},required:["value"]}]}},required:["update"]}]}]}},onTrigger:{type:"array",items:{type:"object",properties:{trigger:{$ref:"#/refs/exprString"},insert:{$ref:"#/refs/exprString"},remove:{oneOf:[{type:"boolean"},{$ref:"#/refs/exprString"}]},toggle:{$ref:"#/refs/exprString"},modify:{$ref:"#/refs/exprString"},values:{$ref:"#/refs/exprString"}},required:["trigger"],additionalProperties:!1}},onMarkTrigger:{type:"array",items:{type:"object",properties:{trigger:{$ref:"#/refs/exprString"},modify:{$ref:"#/refs/exprString"},values:{$ref:"#/refs/exprString"}},required:["trigger"],additionalProperties:!1}},padding:{oneOf:[{type:"number"},{type:"object",properties:{top:{type:"number"},bottom:{type:"number"},left:{type:"number"},right:{type:"number"}},additionalProperties:!1}]},projection:{type:"object",properties:{name:{type:"string"},type:{$ref:"#/refs/stringOrSignal"},clipAngle:{$ref:"#/refs/numberOrSignal"},clipExtent:{oneOf:[{type:"array",items:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},scale:{$ref:"#/refs/numberOrSignal"},translate:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},center:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},rotate:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:3},{$ref:"#/refs/signal"}]},parallels:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},precision:{$ref:"#/refs/numberOrSignal"},pointRadius:{$ref:"#/refs/numberOrSignal"},fit:{oneOf:[{type:"object"},{type:"array"}]},extent:{oneOf:[{type:"array",items:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]},size:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},minItems:2,maxItems:2},{$ref:"#/refs/signal"}]}},required:["name"],additionalProperties:!0},scale:{oneOf:[{type:"object",properties:{type:{enum:["identity"]},nice:{$ref:"#/refs/booleanOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["ordinal"]},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{oneOf:[{type:"object",properties:{data:{type:"string"},field:{$ref:"#/refs/stringOrSignal"},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{field:{$ref:"#/refs/stringOrSignal"},op:{$ref:"#/refs/stringOrSignal"},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["data","field"],additionalProperties:!1},{type:"object",properties:{data:{type:"string"},fields:{type:"array",items:{$ref:"#/refs/stringOrSignal"},minItems:1},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{op:{enum:["count"]},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["data","fields"],additionalProperties:!1},{type:"object",properties:{fields:{type:"array",items:{oneOf:[{type:"object",properties:{data:{type:"string"},field:{$ref:"#/refs/stringOrSignal"}},required:["data","field"],additionalProperties:!1},{type:"array",items:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"}]}},{$ref:"#/refs/signal"}]},minItems:1},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{op:{enum:["count"]},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["fields"],additionalProperties:!1}]},{$ref:"#/refs/signal"}]},interpolate:{$ref:"#/refs/scaleInterpolate"},domainImplicit:{$ref:"#/refs/booleanOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["band"]},paddingInner:{$ref:"#/refs/numberOrSignal"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{step:{$ref:"#/refs/numberOrSignal"}},required:["step"],additionalProperties:!1},{$ref:"#/refs/signal"}]},padding:{$ref:"#/refs/numberOrSignal"},paddingOuter:{$ref:"#/refs/numberOrSignal"},align:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["point"]},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{step:{$ref:"#/refs/numberOrSignal"}},required:["step"],additionalProperties:!1},{$ref:"#/refs/signal"}]},padding:{$ref:"#/refs/numberOrSignal"},paddingOuter:{$ref:"#/refs/numberOrSignal"},align:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["quantize","threshold"]},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},interpolate:{$ref:"#/refs/scaleInterpolate"},nice:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},zero:{$ref:"#/refs/booleanOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["quantile"]},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},interpolate:{$ref:"#/refs/scaleInterpolate"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["bin-ordinal"]},bins:{$ref:"#/refs/scaleBins"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},interpolate:{$ref:"#/refs/scaleInterpolate"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["time","utc"]},nice:{oneOf:[{type:"boolean"},{enum:["millisecond","second","minute","hour","day","week","month","year"]},{type:"object",properties:{interval:{oneOf:[{enum:["millisecond","second","minute","hour","day","week","month","year"]},{$ref:"#/refs/signal"}]},step:{$ref:"#/refs/numberOrSignal"}},required:["interval"],additionalProperties:!1}]},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},bins:{$ref:"#/refs/scaleBins"},interpolate:{$ref:"#/refs/scaleInterpolate"},clamp:{$ref:"#/refs/booleanOrSignal"},padding:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["linear","sqrt","sequential"]},nice:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},zero:{$ref:"#/refs/booleanOrSignal"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},bins:{$ref:"#/refs/scaleBins"},interpolate:{$ref:"#/refs/scaleInterpolate"},clamp:{$ref:"#/refs/booleanOrSignal"},padding:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["log"]},base:{$ref:"#/refs/numberOrSignal"},nice:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},zero:{$ref:"#/refs/booleanOrSignal"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},bins:{$ref:"#/refs/scaleBins"},interpolate:{$ref:"#/refs/scaleInterpolate"},clamp:{$ref:"#/refs/booleanOrSignal"},padding:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["pow"]},exponent:{$ref:"#/refs/numberOrSignal"},nice:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},zero:{$ref:"#/refs/booleanOrSignal"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},bins:{$ref:"#/refs/scaleBins"},interpolate:{$ref:"#/refs/scaleInterpolate"},clamp:{$ref:"#/refs/booleanOrSignal"},padding:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1},{type:"object",properties:{type:{enum:["symlog"]},constant:{$ref:"#/refs/numberOrSignal"},nice:{oneOf:[{type:"boolean"},{type:"number"},{$ref:"#/refs/signal"}]},zero:{$ref:"#/refs/booleanOrSignal"},range:{oneOf:[{enum:["width","height","symbol","category","ordinal","ramp","diverging","heatmap"]},{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{type:"object",properties:{scheme:{oneOf:[{type:"string"},{type:"array",items:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},count:{$ref:"#/refs/numberOrSignal"},extent:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"},numItems:2},{$ref:"#/refs/signal"}]}},required:["scheme"],additionalProperties:!1},{$ref:"#/refs/signal"}]},bins:{$ref:"#/refs/scaleBins"},interpolate:{$ref:"#/refs/scaleInterpolate"},clamp:{$ref:"#/refs/booleanOrSignal"},padding:{$ref:"#/refs/numberOrSignal"},name:{type:"string"},domain:{oneOf:[{type:"array",items:{oneOf:[{type:"null"},{type:"boolean"},{type:"string"},{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/scaleData"},{$ref:"#/refs/signal"}]},domainMin:{$ref:"#/refs/numberOrSignal"},domainMax:{$ref:"#/refs/numberOrSignal"},domainMid:{$ref:"#/refs/numberOrSignal"},domainRaw:{oneOf:[{type:"null"},{type:"array"},{$ref:"#/refs/signal"}]},reverse:{$ref:"#/refs/booleanOrSignal"},round:{$ref:"#/refs/booleanOrSignal"}},required:["type","name"],additionalProperties:!1}]},scope:{type:"object",properties:{encode:{$ref:"#/defs/encode"},layout:{$ref:"#/defs/layout"},signals:{type:"array",items:{$ref:"#/defs/signal"}},data:{type:"array",items:{$ref:"#/defs/data"}},scales:{type:"array",items:{$ref:"#/defs/scale"}},projections:{type:"array",items:{$ref:"#/defs/projection"}},axes:{type:"array",items:{$ref:"#/defs/axis"}},legends:{type:"array",items:{$ref:"#/defs/legend"}},title:{$ref:"#/defs/title"},marks:{type:"array",items:{oneOf:[{$ref:"#/defs/markGroup"},{$ref:"#/defs/markVisual"}]}}}},signalName:{type:"string",not:{enum:["parent","datum","event","item"]}},signal:{oneOf:[{type:"object",properties:{name:{$ref:"#/defs/signalName"},description:{type:"string"},push:{enum:["outer"]},on:{$ref:"#/defs/onEvents"}},required:["name","push"],additionalProperties:!1},{type:"object",properties:{name:{$ref:"#/defs/signalName"},description:{type:"string"},value:{},react:{type:"boolean",default:!0},update:{$ref:"#/refs/exprString"},on:{$ref:"#/defs/onEvents"},bind:{$ref:"#/defs/bind"}},required:["name"],additionalProperties:!1},{type:"object",properties:{name:{$ref:"#/defs/signalName"},description:{type:"string"},value:{},init:{$ref:"#/refs/exprString"},on:{$ref:"#/defs/onEvents"},bind:{$ref:"#/defs/bind"}},required:["name","init"],additionalProperties:!1}]},stream:{allOf:[{type:"object",properties:{between:{type:"array",items:{$ref:"#/defs/stream"},minItems:2,maxItems:2},marktype:{type:"string"},markname:{type:"string"},filter:{oneOf:[{$ref:"#/refs/exprString"},{type:"array",items:{$ref:"#/refs/exprString"},minItems:1}]},throttle:{type:"number"},debounce:{type:"number"},consume:{type:"boolean"}}},{oneOf:[{type:"object",properties:{type:{type:"string"},source:{type:"string"}},required:["type"]},{type:"object",properties:{stream:{$ref:"#/defs/stream"}},required:["stream"]},{type:"object",properties:{merge:{type:"array",items:{$ref:"#/defs/stream"},minItems:1}},required:["merge"]}]}]},title:{oneOf:[{type:"string"},{type:"object",properties:{name:{type:"string"},orient:{enum:["none","left","right","top","bottom"],default:"top"},anchor:{oneOf:[{enum:["start","middle","end"]},{$ref:"#/refs/anchorValue"}]},frame:{oneOf:[{enum:["group","bounds"]},{$ref:"#/refs/stringValue"}]},offset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},style:{$ref:"#/refs/style"},text:{$ref:"#/refs/stringOrSignal"},zindex:{type:"number"},interactive:{type:"boolean"},align:{oneOf:[{enum:["left","right","center"]},{$ref:"#/refs/alignValue"}]},angle:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},baseline:{oneOf:[{enum:["top","middle","bottom","alphabetic"]},{$ref:"#/refs/baselineValue"}]},color:{oneOf:[{type:"null"},{type:"string"},{$ref:"#/refs/colorValue"}]},font:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},fontSize:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},fontStyle:{oneOf:[{type:"string"},{$ref:"#/refs/stringValue"}]},fontWeight:{oneOf:[{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]},{$ref:"#/refs/fontWeightValue"}]},limit:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},encode:{type:"object",additionalProperties:!1,patternProperties:{"^(?!interactive|name|style).+$":{$ref:"#/defs/encodeEntry"}}}},additionalProperties:!1}]},transform:{oneOf:[{$ref:"#/defs/crossfilterTransform"},{$ref:"#/defs/resolvefilterTransform"},{$ref:"#/defs/linkpathTransform"},{$ref:"#/defs/pieTransform"},{$ref:"#/defs/stackTransform"},{$ref:"#/defs/forceTransform"},{$ref:"#/defs/contourTransform"},{$ref:"#/defs/geojsonTransform"},{$ref:"#/defs/geopathTransform"},{$ref:"#/defs/geopointTransform"},{$ref:"#/defs/geoshapeTransform"},{$ref:"#/defs/graticuleTransform"},{$ref:"#/defs/nestTransform"},{$ref:"#/defs/packTransform"},{$ref:"#/defs/partitionTransform"},{$ref:"#/defs/stratifyTransform"},{$ref:"#/defs/treeTransform"},{$ref:"#/defs/treelinksTransform"},{$ref:"#/defs/treemapTransform"},{$ref:"#/defs/aggregateTransform"},{$ref:"#/defs/binTransform"},{$ref:"#/defs/collectTransform"},{$ref:"#/defs/countpatternTransform"},{$ref:"#/defs/crossTransform"},{$ref:"#/defs/densityTransform"},{$ref:"#/defs/extentTransform"},{$ref:"#/defs/filterTransform"},{$ref:"#/defs/flattenTransform"},{$ref:"#/defs/foldTransform"},{$ref:"#/defs/formulaTransform"},{$ref:"#/defs/imputeTransform"},{$ref:"#/defs/joinaggregateTransform"},{$ref:"#/defs/lookupTransform"},{$ref:"#/defs/pivotTransform"},{$ref:"#/defs/projectTransform"},{$ref:"#/defs/sampleTransform"},{$ref:"#/defs/sequenceTransform"},{$ref:"#/defs/windowTransform"},{$ref:"#/defs/identifierTransform"},{$ref:"#/defs/voronoiTransform"},{$ref:"#/defs/wordcloudTransform"}]},transformMark:{oneOf:[{$ref:"#/defs/crossfilterTransform"},{$ref:"#/defs/resolvefilterTransform"},{$ref:"#/defs/linkpathTransform"},{$ref:"#/defs/pieTransform"},{$ref:"#/defs/stackTransform"},{$ref:"#/defs/forceTransform"},{$ref:"#/defs/geojsonTransform"},{$ref:"#/defs/geopathTransform"},{$ref:"#/defs/geopointTransform"},{$ref:"#/defs/geoshapeTransform"},{$ref:"#/defs/packTransform"},{$ref:"#/defs/partitionTransform"},{$ref:"#/defs/stratifyTransform"},{$ref:"#/defs/treeTransform"},{$ref:"#/defs/treemapTransform"},{$ref:"#/defs/binTransform"},{$ref:"#/defs/collectTransform"},{$ref:"#/defs/extentTransform"},{$ref:"#/defs/formulaTransform"},{$ref:"#/defs/joinaggregateTransform"},{$ref:"#/defs/lookupTransform"},{$ref:"#/defs/sampleTransform"},{$ref:"#/defs/windowTransform"},{$ref:"#/defs/identifierTransform"},{$ref:"#/defs/voronoiTransform"},{$ref:"#/defs/wordcloudTransform"}]},crossfilterTransform:{type:"object",properties:{type:{enum:["crossfilter"]},signal:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},query:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}]}},required:["type","fields","query"],additionalProperties:!1},resolvefilterTransform:{type:"object",properties:{type:{enum:["resolvefilter"]},signal:{type:"string"},ignore:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},filter:{}},required:["type","ignore","filter"],additionalProperties:!1},linkpathTransform:{type:"object",properties:{type:{enum:["linkpath"]},signal:{type:"string"},sourceX:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}],default:"source.x"},sourceY:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}],default:"source.y"},targetX:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}],default:"target.x"},targetY:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}],default:"target.y"},orient:{anyOf:[{enum:["horizontal","vertical","radial"]},{$ref:"#/refs/signal"}],default:"vertical"},shape:{anyOf:[{enum:["line","arc","curve","diagonal","orthogonal"]},{$ref:"#/refs/signal"}],default:"line"},require:{$ref:"#/refs/signal"},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"path"}},required:["type"],additionalProperties:!1},pieTransform:{type:"object",properties:{type:{enum:["pie"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},startAngle:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},endAngle:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:6.283185307179586},sort:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["startAngle","endAngle"]}},required:["type"],additionalProperties:!1},stackTransform:{type:"object",properties:{type:{enum:["stack"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},sort:{$ref:"#/refs/compare"},offset:{anyOf:[{enum:["zero","center","normalize"]},{$ref:"#/refs/signal"}],default:"zero"},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["y0","y1"]}},required:["type"],additionalProperties:!1},forceTransform:{type:"object",properties:{type:{enum:["force"]},signal:{type:"string"},static:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},restart:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},iterations:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:300},alpha:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1},alphaMin:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.001},alphaTarget:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},velocityDecay:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.4},forces:{type:"array",items:{oneOf:[{type:"object",properties:{force:{enum:["center"]},x:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},y:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},required:["force"],additionalProperties:!1},{type:"object",properties:{force:{enum:["collide"]},radius:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},strength:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.7},iterations:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1}},required:["force"],additionalProperties:!1},{type:"object",properties:{force:{enum:["nbody"]},strength:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:-30},theta:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.9},distanceMin:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1},distanceMax:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},required:["force"],additionalProperties:!1},{type:"object",properties:{force:{enum:["link"]},links:{type:"string"},id:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},distance:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}],default:30},strength:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},iterations:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1}},required:["force"],additionalProperties:!1},{type:"object",properties:{force:{enum:["x"]},strength:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.1},x:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["force"],additionalProperties:!1},{type:"object",properties:{force:{enum:["y"]},strength:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:.1},y:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["force"],additionalProperties:!1}]}},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],default:["x","y","vx","vy"]}},required:["type"],additionalProperties:!1},contourTransform:{type:"object",properties:{type:{enum:["contour"]},signal:{type:"string"},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},values:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},x:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},y:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},weight:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},cellSize:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},bandwidth:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},count:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},smooth:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},nice:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},thresholds:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]}},required:["type","size"],additionalProperties:!1},geojsonTransform:{type:"object",properties:{type:{enum:["geojson"]},signal:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},geojson:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type"],additionalProperties:!1},geopathTransform:{type:"object",properties:{type:{enum:["geopath"]},signal:{type:"string"},projection:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},pointRadius:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"path"}},required:["type"],additionalProperties:!1},geopointTransform:{type:"object",properties:{type:{enum:["geopoint"]},signal:{type:"string"},projection:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["x","y"]}},required:["type","projection","fields"],additionalProperties:!1},geoshapeTransform:{type:"object",properties:{type:{enum:["geoshape"]},signal:{type:"string"},projection:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}],default:"datum"},pointRadius:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"shape"}},required:["type"],additionalProperties:!1},graticuleTransform:{type:"object",properties:{type:{enum:["graticule"]},signal:{type:"string"},extent:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},extentMajor:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},extentMinor:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},step:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},stepMajor:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:[90,360]},stepMinor:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:[10,10]},precision:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:2.5}},required:["type"],additionalProperties:!1},nestTransform:{type:"object",properties:{type:{enum:["nest"]},signal:{type:"string"},keys:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},generate:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]}},required:["type"],additionalProperties:!1},packTransform:{type:"object",properties:{type:{enum:["pack"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},sort:{$ref:"#/refs/compare"},padding:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},radius:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:5,minItems:5,default:["x","y","r","depth","children"]}},required:["type"],additionalProperties:!1},partitionTransform:{type:"object",properties:{type:{enum:["partition"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},sort:{$ref:"#/refs/compare"},padding:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},round:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:6,minItems:6,default:["x0","y0","x1","y1","depth","children"]}},required:["type"],additionalProperties:!1},stratifyTransform:{type:"object",properties:{type:{enum:["stratify"]},signal:{type:"string"},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},parentKey:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type","key","parentKey"],additionalProperties:!1},treeTransform:{type:"object",properties:{type:{enum:["tree"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},sort:{$ref:"#/refs/compare"},method:{anyOf:[{enum:["tidy","cluster"]},{$ref:"#/refs/signal"}],default:"tidy"},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},nodeSize:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},separation:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}],default:!0},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:4,minItems:4,default:["x","y","depth","children"]}},required:["type"],additionalProperties:!1},treelinksTransform:{type:"object",properties:{type:{enum:["treelinks"]},signal:{type:"string"}},required:["type"],additionalProperties:!1},treemapTransform:{type:"object",properties:{type:{enum:["treemap"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},sort:{$ref:"#/refs/compare"},method:{anyOf:[{enum:["squarify","resquarify","binary","dice","slice","slicedice"]},{$ref:"#/refs/signal"}],default:"squarify"},padding:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingInner:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingOuter:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingTop:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingRight:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingBottom:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},paddingLeft:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},ratio:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1.618033988749895},round:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:6,minItems:6,default:["x0","y0","x1","y1","depth","children"]}},required:["type"],additionalProperties:!1},aggregateTransform:{type:"object",properties:{type:{enum:["aggregate"]},signal:{type:"string"},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},ops:{oneOf:[{type:"array",items:{anyOf:[{enum:["values","count","__count__","missing","valid","sum","mean","average","variance","variancep","stdev","stdevp","stderr","distinct","ci0","ci1","median","q1","q3","argmin","argmax","min","max"]},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"},{type:"null"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}]},drop:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}],default:!0},cross:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type"],additionalProperties:!1},binTransform:{type:"object",properties:{type:{enum:["bin"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},anchor:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},maxbins:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:20},base:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:10},divide:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],default:[5,2]},extent:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},step:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},steps:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},minstep:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},nice:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}],default:!0},name:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["bin0","bin1"]}},required:["type","field","extent"],additionalProperties:!1},collectTransform:{type:"object",properties:{type:{enum:["collect"]},signal:{type:"string"},sort:{$ref:"#/refs/compare"}},required:["type"],additionalProperties:!1},countpatternTransform:{type:"object",properties:{type:{enum:["countpattern"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},case:{anyOf:[{enum:["upper","lower","mixed"]},{$ref:"#/refs/signal"}],default:"mixed"},pattern:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:'[\\w"]+'},stopwords:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["text","count"]}},required:["type","field"],additionalProperties:!1},crossTransform:{type:"object",properties:{type:{enum:["cross"]},signal:{type:"string"},filter:{$ref:"#/refs/exprString"},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["a","b"]}},required:["type"],additionalProperties:!1},densityTransform:{type:"object",properties:{type:{enum:["density"]},signal:{type:"string"},extent:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},steps:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:100},method:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"pdf"},distribution:{oneOf:[{type:"object",properties:{function:{enum:["normal"]},mean:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},stdev:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1}},required:["function"],additionalProperties:!1},{type:"object",properties:{function:{enum:["uniform"]},min:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},max:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1}},required:["function"],additionalProperties:!1},{type:"object",properties:{function:{enum:["kde"]},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},from:{type:"string"},bandwidth:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},required:["function","field"],additionalProperties:!1},{type:"object",properties:{function:{enum:["mixture"]},distributions:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}]},weights:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]}},required:["function"],additionalProperties:!1}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],default:["value","density"]}},required:["type"],additionalProperties:!1},extentTransform:{type:"object",properties:{type:{enum:["extent"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type","field"],additionalProperties:!1},filterTransform:{type:"object",properties:{type:{enum:["filter"]},signal:{type:"string"},expr:{$ref:"#/refs/exprString"}},required:["type","expr"],additionalProperties:!1},flattenTransform:{type:"object",properties:{type:{enum:["flatten"]},signal:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]}},required:["type","fields"],additionalProperties:!1},foldTransform:{type:"object",properties:{type:{enum:["fold"]},signal:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:["key","value"]}},required:["type","fields"],additionalProperties:!1},formulaTransform:{type:"object",properties:{type:{enum:["formula"]},signal:{type:"string"},expr:{$ref:"#/refs/exprString"},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]},initonly:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]}},required:["type","expr","as"],additionalProperties:!1},imputeTransform:{type:"object",properties:{type:{enum:["impute"]},signal:{type:"string"},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},keyvals:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}]},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},method:{anyOf:[{enum:["value","mean","median","max","min"]},{$ref:"#/refs/signal"}],default:"value"},value:{}},required:["type","field","key"],additionalProperties:!1},joinaggregateTransform:{type:"object",properties:{type:{enum:["joinaggregate"]},signal:{type:"string"},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"},{type:"null"}]}},{$ref:"#/refs/signal"}]},ops:{oneOf:[{type:"array",items:{anyOf:[{enum:["values","count","__count__","missing","valid","sum","mean","average","variance","variancep","stdev","stdevp","stderr","distinct","ci0","ci1","median","q1","q3","argmin","argmax","min","max"]},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}]},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type"],additionalProperties:!1},lookupTransform:{type:"object",properties:{type:{enum:["lookup"]},signal:{type:"string"},from:{type:"string"},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},values:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},default:{}},required:["type","from","key","fields"],additionalProperties:!1},pivotTransform:{type:"object",properties:{type:{enum:["pivot"]},signal:{type:"string"},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},field:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},value:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},op:{anyOf:[{enum:["values","count","__count__","missing","valid","sum","mean","average","variance","variancep","stdev","stdevp","stderr","distinct","ci0","ci1","median","q1","q3","argmin","argmax","min","max"]},{$ref:"#/refs/signal"}],default:"sum"},limit:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},key:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},required:["type","field","value"],additionalProperties:!1},projectTransform:{type:"object",properties:{type:{enum:["project"]},signal:{type:"string"},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}]}},required:["type"],additionalProperties:!1},sampleTransform:{type:"object",properties:{type:{enum:["sample"]},signal:{type:"string"},size:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1e3}},required:["type"],additionalProperties:!1},sequenceTransform:{type:"object",properties:{type:{enum:["sequence"]},signal:{type:"string"},start:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},stop:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]},step:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}],default:1},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"data"}},required:["type","start","stop"],additionalProperties:!1},windowTransform:{type:"object",properties:{type:{enum:["window"]},signal:{type:"string"},sort:{$ref:"#/refs/compare"},groupby:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]}},{$ref:"#/refs/signal"}]},ops:{oneOf:[{type:"array",items:{anyOf:[{enum:["row_number","rank","dense_rank","percent_rank","cume_dist","ntile","lag","lead","first_value","last_value","nth_value","values","count","__count__","missing","valid","sum","mean","average","variance","variancep","stdev","stdevp","stderr","distinct","ci0","ci1","median","q1","q3","argmin","argmax","min","max"]},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}]},params:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}]},fields:{oneOf:[{type:"array",items:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"},{type:"null"}]}},{$ref:"#/refs/signal"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}]},frame:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{type:"null"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:[null,0]},ignorePeers:{anyOf:[{type:"boolean"},{$ref:"#/refs/signal"}]}},required:["type"],additionalProperties:!1},identifierTransform:{type:"object",properties:{type:{enum:["identifier"]},signal:{type:"string"},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},required:["type","as"],additionalProperties:!1},voronoiTransform:{type:"object",properties:{type:{enum:["voronoi"]},signal:{type:"string"},x:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},y:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},extent:{oneOf:[{type:"array",items:{}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2,default:[[-1e5,-1e5],[1e5,1e5]]},as:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}],default:"path"}},required:["type","x","y"],additionalProperties:!1},wordcloudTransform:{type:"object",properties:{type:{enum:["wordcloud"]},signal:{type:"string"},size:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:2,minItems:2},font:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}],default:"sans-serif"},fontStyle:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}],default:"normal"},fontWeight:{anyOf:[{type:"string"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}],default:"normal"},fontSize:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}],default:14},fontSizeRange:{oneOf:[{type:"array",items:{anyOf:[{type:"number"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"},{type:"null"}],default:[10,50]},rotate:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},text:{oneOf:[{$ref:"#/refs/scaleField"},{$ref:"#/refs/paramField"},{$ref:"#/refs/expr"}]},spiral:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]},padding:{anyOf:[{type:"number"},{$ref:"#/refs/signal"},{$ref:"#/refs/expr"},{$ref:"#/refs/paramField"}]},as:{oneOf:[{type:"array",items:{anyOf:[{type:"string"},{$ref:"#/refs/signal"}]}},{$ref:"#/refs/signal"}],maxItems:7,minItems:7,default:["x","y","font","fontSize","fontStyle","fontWeight","angle"]}},required:["type"],additionalProperties:!1}},refs:{labelOverlap:{oneOf:[{type:"boolean"},{enum:["parity","greedy"]},{$ref:"#/refs/signal"}]},tickCount:{oneOf:[{type:"number"},{enum:["millisecond","second","minute","hour","day","week","month","year"]},{type:"object",properties:{interval:{oneOf:[{enum:["millisecond","second","minute","hour","day","week","month","year"]},{$ref:"#/refs/signal"}]},step:{$ref:"#/refs/numberOrSignal"}},required:["interval"],additionalProperties:!1},{$ref:"#/refs/signal"}]},element:{type:"string"},paramField:{type:"object",properties:{field:{type:"string"},as:{type:"string"}},required:["field"],additionalProperties:!1},field:{oneOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"object",properties:{datum:{$ref:"#/refs/field"}},required:["datum"],additionalProperties:!1},{type:"object",properties:{group:{$ref:"#/refs/field"},level:{type:"number"}},required:["group"],additionalProperties:!1},{type:"object",properties:{parent:{$ref:"#/refs/field"},level:{type:"number"}},required:["parent"],additionalProperties:!1}]},scale:{$ref:"#/refs/field"},stringModifiers:{type:"object",properties:{scale:{$ref:"#/refs/scale"}}},numberModifiers:{type:"object",properties:{exponent:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},mult:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},offset:{oneOf:[{type:"number"},{$ref:"#/refs/numberValue"}]},round:{type:"boolean",default:!1},scale:{$ref:"#/refs/scale"},band:{oneOf:[{type:"number"},{type:"boolean"}]},extra:{type:"boolean"}}},anyValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},numberValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/numberModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"number"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/numberModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"number"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},stringValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"string"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"string"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},booleanValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"boolean"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"boolean"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},arrayValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"array"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{type:"array"}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},nullableStringValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{oneOf:[{type:"string"},{type:"null"}]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{oneOf:[{type:"string"},{type:"null"}]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},fontWeightValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:[null,"normal","bold","lighter","bolder","100","200","300","400","500","600","700","800","900",100,200,300,400,500,600,700,800,900]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},anchorValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["start","middle","end"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["start","middle","end"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},alignValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["left","right","center"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["left","right","center"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},baselineValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["top","middle","bottom","alphabetic"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["top","middle","bottom","alphabetic"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},orientValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["horizontal","vertical"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["horizontal","vertical"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},strokeCapValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["butt","round","square"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["butt","round","square"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},strokeJoinValue:{oneOf:[{type:"array",items:{allOf:[{$ref:"#/defs/rule"},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["miter","round","bevel"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]}},{allOf:[{$ref:"#/refs/stringModifiers"},{anyOf:[{oneOf:[{$ref:"#/refs/signal"},{type:"object",properties:{value:{enum:["miter","round","bevel"]}},required:["value"]},{type:"object",properties:{field:{$ref:"#/refs/field"}},required:["field"]},{type:"object",properties:{range:{oneOf:[{type:"number"},{type:"boolean"}]}},required:["range"]}]},{type:"object",required:["scale","value"]},{type:"object",required:["scale","band"]},{type:"object",required:["offset"]}]}]}]},colorRGB:{type:"object",properties:{r:{$ref:"#/refs/numberValue"},g:{$ref:"#/refs/numberValue"},b:{$ref:"#/refs/numberValue"}},required:["r","g","b"]},colorHSL:{type:"object",properties:{h:{$ref:"#/refs/numberValue"},s:{$ref:"#/refs/numberValue"},l:{$ref:"#/refs/numberValue"}},required:["h","s","l"]},colorLAB:{type:"object",properties:{l:{$ref:"#/refs/numberValue"},a:{$ref:"#/refs/numberValue"},b:{$ref:"#/refs/numberValue"}},required:["l","a","b"]},colorHCL:{type:"object",properties:{h:{$ref:"#/refs/numberValue"},c:{$ref:"#/refs/numberValue"},l:{$ref:"#/refs/numberValue"}},required:["h","c","l"]},colorValue:{oneOf:[{$ref:"#/refs/nullableStringValue"},{type:"object",properties:{gradient:{$ref:"#/refs/scale"}},required:["gradient"],additionalProperties:!1},{type:"object",properties:{color:{oneOf:[{$ref:"#/refs/colorRGB"},{$ref:"#/refs/colorHSL"},{$ref:"#/refs/colorLAB"},{$ref:"#/refs/colorHCL"}]}},required:["color"],additionalProperties:!1}]},expr:{type:"object",properties:{expr:{type:"string"},as:{type:"string"}},required:["expr"]},exprString:{type:"string"},compare:{oneOf:[{type:"object",properties:{field:{$ref:"#/refs/stringOrSignal"},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1},{type:"object",properties:{field:{type:"array",items:{$ref:"#/refs/stringOrSignal"}},order:{type:"array",items:{$ref:"#/refs/sortOrder"}}},additionalProperties:!1}]},from:{type:"object",properties:{data:{type:"string"}},additionalProperties:!1},facet:{type:"object",properties:{data:{type:"string"},facet:{oneOf:[{type:"object",properties:{name:{type:"string"},data:{type:"string"},field:{type:"string"}},required:["name","data","field"],additionalProperties:!1},{type:"object",properties:{name:{type:"string"},data:{type:"string"},groupby:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},aggregate:{type:"object",properties:{cross:{type:"boolean"},fields:{type:"array",items:{type:"string"}},ops:{type:"array",items:{type:"string"}},as:{type:"array",items:{type:"string"}}},additionalProperties:!1}},required:["name","data","groupby"],additionalProperties:!1}]}},required:["facet"],additionalProperties:!1},markclip:{oneOf:[{$ref:"#/refs/booleanOrSignal"},{type:"object",properties:{path:{$ref:"#/refs/stringOrSignal"}},required:["path"],additionalProperties:!1},{type:"object",properties:{sphere:{$ref:"#/refs/stringOrSignal"}},required:["sphere"],additionalProperties:!1}]},style:{oneOf:[{type:"string"},{type:"array",items:{type:"string"}}]},marktype:{type:"string"},scaleField:{$ref:"#/refs/stringOrSignal"},sortOrder:{oneOf:[{enum:["ascending","descending"]},{$ref:"#/refs/signal"}]},scaleBins:{oneOf:[{type:"array",items:{$ref:"#/refs/numberOrSignal"}},{type:"object",properties:{step:{$ref:"#/refs/numberOrSignal"},start:{$ref:"#/refs/numberOrSignal"},stop:{$ref:"#/refs/numberOrSignal"}},required:["step"],additionalProperties:!1},{$ref:"#/refs/signal"}]},scaleInterpolate:{oneOf:[{type:"string"},{$ref:"#/refs/signal"},{type:"object",properties:{type:{$ref:"#/refs/stringOrSignal"},gamma:{$ref:"#/refs/numberOrSignal"}},required:["type"],additionalProperties:!1}]},scaleData:{oneOf:[{type:"object",properties:{data:{type:"string"},field:{$ref:"#/refs/stringOrSignal"},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{field:{$ref:"#/refs/stringOrSignal"},op:{$ref:"#/refs/stringOrSignal"},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["data","field"],additionalProperties:!1},{type:"object",properties:{data:{type:"string"},fields:{type:"array",items:{$ref:"#/refs/stringOrSignal"},minItems:1},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{op:{enum:["count"]},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["data","fields"],additionalProperties:!1},{type:"object",properties:{fields:{type:"array",items:{oneOf:[{type:"object",properties:{data:{type:"string"},field:{$ref:"#/refs/stringOrSignal"}},required:["data","field"],additionalProperties:!1},{type:"array",items:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"}]}},{$ref:"#/refs/signal"}]},minItems:1},sort:{oneOf:[{type:"boolean"},{type:"object",properties:{op:{enum:["count"]},order:{$ref:"#/refs/sortOrder"}},additionalProperties:!1}]}},required:["fields"],additionalProperties:!1}]},selector:{type:"string"},signal:{type:"object",properties:{signal:{type:"string"}},required:["signal"]},arrayOrSignal:{oneOf:[{type:"array"},{$ref:"#/refs/signal"}]},booleanOrSignal:{oneOf:[{type:"boolean"},{$ref:"#/refs/signal"}]},numberOrSignal:{oneOf:[{type:"number"},{$ref:"#/refs/signal"}]},stringOrSignal:{oneOf:[{type:"string"},{$ref:"#/refs/signal"}]}},type:"object",allOf:[{$ref:"#/defs/scope"},{properties:{$schema:{type:"string",format:"uri"},usermeta:{type:"object"},config:{type:"object"},description:{type:"string"},width:{type:"number"},height:{type:"number"},padding:{$ref:"#/defs/padding"},autosize:{$ref:"#/defs/autosize"},background:{$ref:"#/defs/background"}}}]}},263:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=/\/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3);return{library:t[0],version:t[1]}}},291:function(e){e.exports={"Bar Charts":[{name:"bar-chart"},{name:"stacked-bar-chart"},{name:"grouped-bar-chart"},{name:"nested-bar-chart"},{name:"population-pyramid"}],"Line & Area Charts":[{name:"line-chart"},{name:"area-chart"},{name:"stacked-area-chart"},{name:"horizon-graph"},{name:"job-voyager"}],"Circular Charts":[{name:"pie-chart"},{name:"donut-chart"},{name:"radial-plot"}],"Dot & Scatter Plots":[{name:"scatter-plot"},{name:"scatter-plot-null-values"},{name:"connected-scatter-plot"},{name:"error-bars"},{name:"barley-trellis-plot"}],Distributions:[{name:"histogram"},{name:"histogram-null-values"},{name:"probability-density"},{name:"box-plot"},{name:"violin-plot"},{name:"top-k-plot"},{name:"top-k-plot-with-others"},{name:"binned-scatter-plot"},{name:"contour-plot"},{name:"wheat-plot"},{name:"hypothetical-outcome-plots"}],"Geographic Maps":[{name:"county-unemployment"},{name:"dorling-cartogram"},{name:"world-map"},{name:"earthquakes"},{name:"projections"},{name:"zoomable-world-map"},{name:"distortion-comparison"},{name:"volcano-contours"},{name:"wind-vectors"}],"Tree Diagrams":[{name:"tree-layout"},{name:"radial-tree-layout"},{name:"treemap"},{name:"circle-packing"},{name:"sunburst"}],"Network Diagrams":[{name:"edge-bundling"},{name:"force-directed-layout"},{name:"reorderable-matrix"},{name:"arc-diagram"},{name:"airport-connections"}],"Other Chart Types":[{name:"heatmap"},{name:"parallel-coordinates"},{name:"word-cloud"},{name:"timelines"},{name:"beeswarm-plot"}],"Custom Visual Designs":[{name:"budget-forecasts"},{name:"wheat-and-wages"},{name:"falkensee-population"},{name:"annual-temperature"},{name:"weekly-temperature"},{name:"u-district-cuisine"}],"Interaction Techniques":[{name:"crossfilter-flights"},{name:"overview-plus-detail"},{name:"brushing-scatter-plots"},{name:"zoomable-scatter-plot"},{name:"global-development"},{name:"interactive-legend"},{name:"stock-index-chart"},{name:"pi-monte-carlo"}]}}}]);
//# sourceMappingURL=vega.js.map